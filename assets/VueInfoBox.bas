B4J=true
Group=Default Group
ModulesStructureVersion=1
Type=Class
Version=8.9
@EndOfDesignText@
#IgnoreWarnings:12
#Event: Click (e As BANanoEvent)
#DesignerProperty: Key: ParentID, DisplayName: ParentID, FieldType: String, DefaultValue: , Description: The id of the element to place this into
#DesignerProperty: Key: AutoID, DisplayName: Auto ID/Name, FieldType: Boolean, DefaultValue: False, Description: Overrides the ID/Name with a random string.
#DesignerProperty: Key: Hidden, DisplayName: Hidden, FieldType: Boolean, DefaultValue: False, Description: Hidden
#DesignerProperty: Key: Caption, DisplayName: Caption, FieldType: String, DefaultValue: , Description: Caption
#DesignerProperty: Key: InfoType, DisplayName: Type, FieldType: String, DefaultValue: info-box, Description: Info Type, List: info-box|info-box-2|info-box-3|info-box-4
#DesignerProperty: Key: Icon, DisplayName: Icon, FieldType: String, DefaultValue: , Description: Icon
#DesignerProperty: Key: IconColor, DisplayName: Icon Color, FieldType: String, DefaultValue:  , Description: Icon Color , List: amber|black|blue|blue-grey|brown|cyan|deep-orange|deep-purple|green|grey|indigo|light-blue|light-green|lime|orange|pink|purple|red|teal|transparent|white|yellow|primary|secondary|accent|error|info|success|warning|none
#DesignerProperty: Key: IconBackgroundColor, DisplayName: IconBackgroundColor, FieldType: String, DefaultValue:  , Description: Icon Color , List: amber|black|blue|blue-grey|brown|cyan|deep-orange|deep-purple|green|grey|indigo|light-blue|light-green|lime|orange|pink|purple|red|teal|transparent|white|yellow|primary|secondary|accent|error|info|success|warning|none
#DesignerProperty: Key: Color, DisplayName: Color, FieldType: String, DefaultValue:  , Description: Color , List: amber|black|blue|blue-grey|brown|cyan|deep-orange|deep-purple|green|grey|indigo|light-blue|light-green|lime|orange|pink|purple|red|teal|transparent|white|yellow|primary|secondary|accent|error|info|success|warning|none
#DesignerProperty: Key: HoverZoomEffect, DisplayName: Hover Zoom Effect, FieldType: Boolean, DefaultValue: False, Description: HoverZoomEffect
#DesignerProperty: Key: HoverExpandEffect, DisplayName: Hover Expand Effect, FieldType: Boolean, DefaultValue: False, Description: HoverExpandEffect
#DesignerProperty: Key: StartValue, DisplayName: Start Value, FieldType: String, DefaultValue: 0, Description: Start Value
#DesignerProperty: Key: Value, DisplayName: End Value, FieldType: String, DefaultValue: 1973, Description: End Value
#DesignerProperty: Key: Duration, DisplayName: Duration, FieldType: String, DefaultValue: 3000, Description: Duration
#DesignerProperty: Key: AutoPlay, DisplayName: AutoPlay, FieldType: Boolean, DefaultValue: True, Description: AutoPlay
#DesignerProperty: Key: UseEasing, DisplayName: UseEasing, FieldType: Boolean, DefaultValue: True, Description: UseEasing
#DesignerProperty: Key: Decimals, DisplayName: Decimals, FieldType: String, DefaultValue: 0, Description: Decimals
#DesignerProperty: Key: Decimal, DisplayName: Decimal, FieldType: String, DefaultValue: ., Description: Decimal
#DesignerProperty: Key: Separator, DisplayName: Separator, FieldType: String, DefaultValue: , Description: Separator
#DesignerProperty: Key: Prefix, DisplayName: Prefix, FieldType: String, DefaultValue: , Description: Separator
#DesignerProperty: Key: Suffix, DisplayName: Suffix, FieldType: String, DefaultValue: , Description: Suffix
#DesignerProperty: Key: OnClick, DisplayName: On Click, FieldType: String, DefaultValue: , Description: Event arguments to be passed to the attribute.
#DesignerProperty: Key: GradientActive, DisplayName: GradientActive, FieldType: Boolean, DefaultValue: false, Description: Gradient should be set
#DesignerProperty: Key: Gradient, DisplayName: Gradient, FieldType: String, DefaultValue: , Description: Gradient, List: top_bottom|right_left|bottom_top|left_right|tl_br|bl_tr|tr_bl|br_tl
#DesignerProperty: Key: GradientColor1, DisplayName: GradientColor1, FieldType: Color, DefaultValue: 0xFFCFDCDC, Gradient Color 1.
#DesignerProperty: Key: GradientColor2, DisplayName: GradientColor2, FieldType: Color, DefaultValue: 0xFFCFDCDC, Gradient Color 2.
#DesignerProperty: Key: States, DisplayName: States, FieldType: String, DefaultValue: , Description: Initial Binding States. Must be a json String.
#DesignerProperty: Key: Disabled, DisplayName: Disabled, FieldType: Boolean, DefaultValue: False, Description: Disabled
#DesignerProperty: Key: Absolute, DisplayName: Absolute, FieldType: Boolean, DefaultValue: False, Description: Absolute
#DesignerProperty: Key: Hover, DisplayName: Hover, FieldType: Boolean, DefaultValue: false, Description: Hover
#DesignerProperty: Key: MarginAXYTBLR, DisplayName: Margins AXYTBLR, FieldType: String, DefaultValue: a=?; x=?; y=?; t=?; b=?; l=?; r=? , Description: Margins A-X-Y-S-M-L-X
#DesignerProperty: Key: PaddingAXYTBLR, DisplayName: Paddings AXYTBLR, FieldType: String, DefaultValue: a=?; x=?; y=?; t=?; b=?; l=?; r=? , Description: Padding A-X-Y-S-M-L-X
#DesignerProperty: Key: Attributes, DisplayName: Attributes, FieldType: String, DefaultValue: , Description: Attributes added to the HTML tag. Must be a json String, use =
#DesignerProperty: Key: Classes, DisplayName: Classes, FieldType: String, DefaultValue: , Description: Classes added to the HTML tag.
#DesignerProperty: Key: Styles, DisplayName: Styles (=), FieldType: String, DefaultValue: , Description: Styles added to the HTML tag. Must be a json String, use =
#DesignerProperty: Key: Transition, DisplayName: Transition, FieldType: String, DefaultValue: , Description: Transition, List: none|fab-transition|fade-transition|expand-transition|scale-transition|scroll-x-transition|scroll-x-reverse-transition|scroll-y-transition|scroll-y-reverse-transition|slide-x-transition|slide-x-reverse-transition|slide-y-transition|slide-y-reverse-transition
#DesignerProperty: Key: Elevation, DisplayName: Elevation, FieldType: String, DefaultValue: , Description: Elevation
#DesignerProperty: Key: Height, DisplayName: Height, FieldType: String, DefaultValue: , Description: Height
#DesignerProperty: Key: MinHeight, DisplayName: MinHeight, FieldType: String, DefaultValue: , Description: MinHeight
#DesignerProperty: Key: MaxHeight, DisplayName: MaxHeight, FieldType: String, DefaultValue: , Description: MaxHeight
#DesignerProperty: Key: Width, DisplayName: Width, FieldType: String, DefaultValue: , Description: Width
#DesignerProperty: Key: MinWidth, DisplayName: MinWidth, FieldType: String, DefaultValue: , Description: MinWidth
#DesignerProperty: Key: MaxWidth, DisplayName: MaxWidth, FieldType: String, DefaultValue: , Description: MaxWidth
#DesignerProperty: Key: Rounded, DisplayName: Rounded, FieldType: String, DefaultValue: none, Description: Rounded, List: none|rounded-0|rounded|rounded-sm|rounded-lg|rounded-xl|rounded-t-xl|rounded-r-xl|rounded-b-xl|rounded-l-xl|rounded-tl-xl|rounded-tr-xl|rounded-br-xl|rounded-bl-xl|rounded-pill|rounded-circle
#DesignerProperty: Key: Tile, DisplayName: Tile, FieldType: Boolean, DefaultValue: False, Description: Tile
#DesignerProperty: Key: Shrink, DisplayName: Shrink, FieldType: Boolean, DefaultValue: False, Description: Shrink
#DesignerProperty: Key: Grow, DisplayName: Grow, FieldType: Boolean, DefaultValue: false, Description: Grow
#DesignerProperty: Key: Flat, DisplayName: Flat, FieldType: Boolean, DefaultValue: False, Description: Flat
#DesignerProperty: Key: Dense, DisplayName: Dense, FieldType: Boolean, DefaultValue: False, Description: Dense
'Definition of variables used in this VueInfoBox component.
Sub Class_Globals
Private mCallBack As Object
Private mEvent As String    'ignore
Public methods As Map
Private BANano As BANano  'ignore
Private mName As String
Public bindings As Map
Private mElement As BANanoElement
Private mTarget As BANanoElement 'ignore
Private mCaption As String
Private iconID As String
Private textID As String
Private contentID As String
Private iconDiv As String
Private mIcon As String
Private mIconColor As String
Private mHoverZoomEffect As Boolean
Private mStartValue As String
Private mEndValue As String
Private numberID As String
Private mHoverExpandEffect As Boolean
Private mColor As String
Private mInfoType As String
Private mIconBackgroundColor As String
Private mOnClick As String
Private mDuration As String
Private mAutoPlay As Boolean
Private mUseEasing As Boolean
Private mDecimals As String
Private mDecimal As String
Private mSeparator As String
Private mPrefix As String
Private mSuffix As String
Private startID As String
Private endID As String
Private VC As VueComponent					'ignore
Private sVShow As String
Private bHidden As Boolean
Public VElement As VueElement
Private bGradientActive As String
Private sGradient As String
Private sGradientColor1 As String
Private sGradientColor2 As String
Private sParentID As String
Private sStates As String
Private bDisabled As Boolean
Private sDisabled As String
Private bAbsolute As Boolean
Private bHover As Boolean
Private sMarginAXYTBLR As String
Private sPaddingAXYTBLR As String
Private mAttributes As String = ""
Private mClasses As String = ""
Private mStyles As String = ""
Private sTransition As String
Private sElevation As String
Private sHeight As String
Private sMinHeight As String
Private sMaxHeight As String
Private sWidth As String
Private sMinWidth As String
Private sMaxWidth As String
Private sRounded As String
Private bTile As Boolean
Private bShrink As Boolean
Private bGrow As Boolean
Private bFlat As Boolean
Private bDense As Boolean
End Sub
'initialize to the component you want to load to
Sub Initialize(Module As Object, Name As String, eventName As String)
mCallBack = Module
mName = Name.tolowercase
mEvent = eventName.tolowercase
methods.Initialize
bindings.Initialize
'
iconID = $"${mName}icon"$
contentID = $"${mName}content"$
textID = $"${mName}text"$
iconDiv = $"${mName}icondiv"$
numberID = $"${mName}number"$
startID = $"${mName}start"$
endID = $"${mName}end"$
SetData(startID, 0)
SetData(endID, 1973)
sVShow = $"${mName}show"$
'
If mName <> "" Then
Dim fKey As String = $"#${mName}"$
If BANano.Exists(fKey) Then
mElement = BANano.GetElement(fKey)
End If
End If
'sDisabled = $"${mName}disabled"$
End Sub
' this is the place where you create the view in html and run initialize javascript
'This builds the HTML tree based on defined properties for VueInfoBox
Sub DesignerCreateView (Target As BANanoElement, Props As Map)
mTarget = Target
If Props <> Null Then
mCaption = Props.Get("Caption")
mIcon = Props.Get("Icon")
mIconColor = Props.Get("IconColor")
mHoverZoomEffect = Props.Get("HoverZoomEffect")
mEndValue = Props.Get("Value")
mHoverExpandEffect = Props.Get("HoverExpandEffect")
mColor = Props.Get("Color")
mInfoType = Props.Get("InfoType")
mIconBackgroundColor = Props.Get("IconBackgroundColor")
mOnClick = Props.Get("OnClick")
mStartValue = Props.Get("StartValue")
mDuration = Props.Get("Duration")
mAutoPlay = Props.Get("AutoPlay")
mUseEasing = Props.Get("UseEasing")
mDecimals = Props.Get("Decimals")
mDecimal = Props.Get("Decimal")
mSeparator = Props.Get("Separator")
mPrefix = Props.Get("Prefix")
mSuffix = Props.Get("Suffix")
bHidden = Props.GetDefault("Hidden", False)
bHidden = BANanoShared.parseBool(bHidden)
bGradientActive = Props.GetDefault("GradientActive", False)
bGradientActive = BANanoShared.parseBool(bGradientActive)
sGradient = Props.GetDefault("Gradient", "")
sGradientColor1 = Props.GetDefault("GradientColor1", "")
sGradientColor2 = Props.GetDefault("GradientColor2", "")
sParentID = Props.GetDefault("ParentID", "")
sParentID = BANanoShared.parseNull(sParentID)
sStates = BANanoShared.GetProp(Props, "States", "")
bDisabled = Props.GetDefault("Disabled",False)
bDisabled = BANanoShared.parseBool(bDisabled)
bAbsolute = Props.GetDefault("Absolute", False)
bHover = Props.GetDefault("Hover", False)
sMarginAXYTBLR = BANanoShared.GetProp(Props, "MarginAXYTBLR","a=?; x=?; y=?; t=?; b=?; l=?; r=?")
sPaddingAXYTBLR = BANanoShared.GetProp(Props, "PaddingAXYTBLR","a=?; x=?; y=?; t=?; b=?; l=?; r=?")
mAttributes = Props.GetDefault("Attributes", "")
mClasses = Props.GetDefault("Classes", "")
mStyles = Props.GetDefault("Styles", "")
sTransition = Props.GetDefault("Transition", "")
sElevation = Props.GetDefault("Elevation", "")
sHeight = Props.GetDefault("Height", "")
sMinHeight = Props.GetDefault("MinHeight", "")
sMaxHeight = Props.GetDefault("MaxHeight", "")
sWidth = Props.GetDefault("Width", "")
sMinWidth = Props.GetDefault("MinWidth", "")
sMaxWidth = Props.GetDefault("MaxWidth", "")
sRounded = Props.GetDefault("Rounded", "")
bTile = Props.GetDefault("Tile", False)
bTile = BANanoShared.parseBool(bTile)
bShrink = Props.GetDefault("Shrink", False)
bShrink = BANanoShared.parseBool(bShrink)
bGrow = Props.GetDefault("Grow", False)
bGrow = BANanoShared.parseBool(bGrow)
bFlat = Props.GetDefault("Flat", False)
bFlat = BANanoShared.parseBool(bFlat)
bDense = Props.GetDefault("Dense", False)
bDense = BANanoShared.parseBool(bDense)
End If
'
mHoverZoomEffect = BANanoShared.parseBool(mHoverZoomEffect)
mHoverExpandEffect = BANanoShared.parseBool(mHoverExpandEffect)
mAutoPlay = BANanoShared.parseBool(mAutoPlay)
mUseEasing = BANanoShared.parseBool(mUseEasing)
'build and get the element
Dim strHTML As String = $"<div ref="${mName}" id="${mName}">
<div id="${iconDiv}" class="icon">
<i id="${iconID}" class="material-icons mdi"></i>
</div>
<div id="${contentID}" class="content">
<div id="${textID}" class="text"></div>
<count-to id="${numberID}" ref="${numberID}" class="number"></count-to>
</div>
</div>"$
If sParentID <> "" Then
sParentID = sParentID.ToLowerCase
mTarget.Initialize($"#${sParentID}"$)
End If
If BANano.Exists($"#${mName}"$) Then
mElement = BANano.GetElement($"#${mName}"$)
Else
mElement = mTarget.Append(strHTML).Get("#" & mName)
End If
VElement.Initialize(mCallBack, mName, mName)
setInfoType(mInfoType)
setCaption(mCaption)
setIcon(mIcon)
setIconColor(mIconColor)
setHoverZoomEffect(mHoverZoomEffect)
setEndValue(mEndValue)
setHoverExpandEffect(mHoverExpandEffect)
setColor(mColor)
setIconBackgroundColor(mIconBackgroundColor)
setOnClick(mOnClick)
setStartValue(mStartValue)
setDuration(mDuration)
setAutoPlay(mAutoPlay)
setUseEasing(mUseEasing)
setDecimals(mDecimals)
setDecimal(mDecimal)
setSeparator(mSeparator)
setPrefix(mPrefix)
setSuffix(mSuffix)
If bHidden Then
mElement.SetAttr("v-show", sVShow)
SetData(sVShow, Not(bHidden))
End If
If bGradientActive Then
Dim agradient As String = VElement.GetActualGradient(sGradient)
VElement.setLinearGradient(agradient, sGradientColor1, sGradientColor2)
End If
VElement.States = sStates
VElement.Disabled = sDisabled
VElement.SetData(sDisabled, bDisabled)
VElement.Absolute = bAbsolute
VElement.Hover = bHover
VElement.setMarginAXYTBLR(sMarginAXYTBLR)
VElement.setPaddingAXYTBLR(sPaddingAXYTBLR)
VElement.Attributes = mAttributes
VElement.Classes = mClasses
VElement.Styles = mStyles
VElement.Transition = sTransition
VElement.Elevation = sElevation
VElement.Height = sHeight
VElement.MinHeight = sMinHeight
VElement.MaxHeight = sMaxHeight
VElement.Width = sWidth
VElement.MinWidth = sMinWidth
VElement.MaxWidth = sMaxWidth
VElement.AddClass(sRounded)
VElement.Tile = bTile
VElement.AddClassOnCondition("shrink", bShrink, True)
VElement.AddAttr(":grow", bGrow)
VElement.AddAttr(":flat", bFlat)
VElement.AddAttr(":dense", bDense)
VElement.BindAllEvents
End Sub
'set the suffix
Sub setSuffix(s As Boolean)
If BANano.IsNull(s) Or BANano.IsUndefined(s) Then Return
If s = "" Then Return
Dim elx As BANanoElement
elx.Initialize($"#${numberID}"$)
elx.SetAttr("suffix", s)
mSuffix = s
End Sub
'set the prefix
Sub setPrefix(s As Boolean)
If BANano.IsNull(s) Or BANano.IsUndefined(s) Then Return
If s = "" Then Return
Dim elx As BANanoElement
elx.Initialize($"#${numberID}"$)
elx.SetAttr("prefix", s)
mPrefix = s
End Sub
'set the separator
Sub setSeparator(s As Boolean)
If BANano.IsNull(s) Or BANano.IsUndefined(s) Then Return
If s = "" Then Return
Dim elx As BANanoElement
elx.Initialize($"#${numberID}"$)
elx.SetAttr("separator", s)
mSeparator = s
End Sub
'set decimal
Sub setDecimal(s As Boolean)
If BANano.IsNull(s) Or BANano.IsUndefined(s) Then Return
If s = "" Then Return
Dim elx As BANanoElement
elx.Initialize($"#${numberID}"$)
elx.SetAttr("decimal", s)
mDecimal = s
End Sub
'set decimals
Sub setDecimals(s As Boolean)
If BANano.IsNull(s) Or BANano.IsUndefined(s) Then Return
If s = "" Then Return
Dim elx As BANanoElement
elx.Initialize($"#${numberID}"$)
elx.SetAttr("decimals", s)
mDecimals = s
End Sub
'set easing
Sub setUseEasing(s As Boolean)
If BANano.IsNull(s) Or BANano.IsUndefined(s) Then Return
If s = "" Then Return
Dim elx As BANanoElement
elx.Initialize($"#${numberID}"$)
elx.SetAttr(":use-easing", s)
mUseEasing = s
End Sub
'set auto play
Sub setAutoPlay(s As Boolean)
If BANano.IsNull(s) Or BANano.IsUndefined(s) Then Return
If s = "" Then Return
Dim elx As BANanoElement
elx.Initialize($"#${numberID}"$)
elx.SetAttr(":autoplay", s)
mAutoPlay = s
End Sub
'set duration
Sub setDuration(s As String)
If BANano.IsNull(s) Or BANano.IsUndefined(s) Then Return
If s = "" Then Return
Dim elx As BANanoElement
elx.Initialize($"#${numberID}"$)
elx.SetAttr("duration", s)
mDuration = s
End Sub
'set start value
Sub setStartValue(s As String)
If BANano.IsNull(s) Or BANano.IsUndefined(s) Then
s = "0"
Return
End If
mStartValue = s
Dim elx As BANanoElement
elx.Initialize($"#${numberID}"$)
elx.SetAttr(":start-val", startID)
mStartValue = BANano.parseFloat(mStartValue)
SetData(startID, mStartValue)
End Sub
'set end value
Sub setEndValue(v As String)
If BANano.IsUndefined(v) Or BANano.IsNull(v) Then
v = "0"
End If
mEndValue = v
Dim elx As BANanoElement
elx.Initialize($"#${numberID}"$)
elx.SetAttr(":end-val", endID)
mEndValue = BANano.parseFloat(mEndValue)
SetData(endID, mEndValue)
End Sub
'set on click
Sub setOnClick(s As String)
Dim methodName As String = $"${mName}_click"$
If SubExists(mCallBack, methodName) = False Then Return
If BANano.IsUndefined(s) Or BANano.IsNull(s) Then s = ""
Dim scode As String
If s = "" Then
scode = methodName
Else
scode = $"${methodName}(${s})"$
End If
mElement.SetAttr($"v-on:click"$, scode)
'arguments for the event
Dim e As Object 'ignore
Dim cb As BANanoObject = BANano.CallBack(mCallBack, methodName, Array(e))
methods.Put(methodName, cb)'
AddStyle("cursor", "pointer")
End Sub
'add a style
Sub AddStyle(varProp As String, varStyle As String)
If BANano.IsUndefined(varStyle) Or BANano.IsNull(varStyle) Then Return
If BANano.IsNumber(varStyle) Then varStyle = BANanoShared.CStr(varStyle)
If mElement <> Null Then
Dim aStyle As Map = CreateMap()
aStyle.put(varProp, varStyle)
Dim sStyle As String = BANano.ToJSON(aStyle)
mElement.SetStyle(sStyle)
End If
End Sub
'set info type
Sub setInfoType(s As String)
mInfoType = s
If BANano.IsNull(s) Or BANano.IsUndefined(s) Then
mInfoType = "info-box"
End If
Dim elx As BANanoElement
elx.Initialize($"#${mName}"$)
elx.AddClass(mInfoType)
End Sub
'set hover expand
Sub setHoverExpandEffect(b As Boolean)
mHoverExpandEffect = b
If BANano.IsNull(b) Or BANano.IsUndefined(b) Then Return
If mHoverExpandEffect = False Then Return
Dim elx As BANanoElement
elx.Initialize($"#${mName}"$)
elx.AddClass("hover-expand-effect")
End Sub
'set hover zoom
Sub setHoverZoomEffect(b As Boolean)
mHoverZoomEffect = b
If BANano.IsNull(b) Or BANano.IsUndefined(b) Then Return
If mHoverZoomEffect = False Then Return
Dim elx As BANanoElement
elx.Initialize($"#${mName}"$)
elx.AddClass("hover-zoom-effect")
End Sub
'set caption
Sub setCaption(s As String)
If BANano.IsNull(s) Or BANano.IsUndefined(s) Then Return
Dim elx As BANanoElement
elx.Initialize($"#${textID}"$)
elx.SetText(s)
mCaption = s
End Sub
'set icon
Sub setIcon(s As String)
If BANano.IsNull(s) Or BANano.IsUndefined(s) Then Return
If s = "" Then Return
Dim elx As BANanoElement
elx.Initialize($"#${iconID}"$)
elx.AddClass(s)
mIcon = s
End Sub
'set icon background
Sub setIconBackgroundColor(s As String)
If BANano.IsNull(s) Or BANano.IsUndefined(s) Then Return
If s = "none" Or s = "" Then Return
Dim iconKey As String = $"bg-${s}"$
Dim elx As BANanoElement
elx.Initialize($"#${iconDiv}"$)
elx.AddClass(iconKey)
mIconBackgroundColor = s
End Sub
'set icon color
Sub setIconColor(s As String)
If BANano.IsNull(s) Or BANano.IsUndefined(s) Then Return
If s = "none" Or s = "" Then Return
Dim iconKey As String = $"col-${s}"$
Dim elx As BANanoElement
elx.Initialize($"#${iconID}"$)
elx.AddClass(iconKey)
mIconColor = s
End Sub
'set background color
Sub setColor(s As String)
If BANano.IsNull(s) Or BANano.IsUndefined(s) Then Return
If s = "none" Or s = "" Then Return
Dim iconKey As String = $"bg-${s}"$
Dim elx As BANanoElement
elx.Initialize($"#${mName}"$)
elx.AddClass(iconKey)
mColor = s
End Sub
'returns the BANanoElement
Sub getElement() As BANanoElement
Return mElement
End Sub
'sets the BANanoElement
Sub setElement(varElement As BANanoElement)
mElement = varElement
End Sub
'returns the tag id
Sub getID() As String
Return mName
End Sub
'add the element to the parent
'Add this component to a parent component. You need to execute this after BANano.LoadLayout on Initialize
Sub AddToParent(targetID As String)
targetID = targetID.tolowercase
targetID = targetID.Replace("#","")
mTarget = BANano.GetElement($"#${targetID}"$)
DesignerCreateView(mTarget, Null)
End Sub
'return html of the element
Sub getHTML As String
If mElement <> Null Then
Return mElement.GetHTML
Else
Return ""
End If
End Sub
'update start value at run time
Sub UpdateStartValue(C As VueComponent, s As String)
C.SetData(startID, s)
End Sub
Sub UpdateStartValueOnApp(C As VuetifyApp, s As String)
C.SetData(startID, s)
End Sub
'update end value at run time
Sub UpdateEndValue(C As VueComponent, s As String)
C.SetData(endID, s)
End Sub
Sub UpdateEndValueOnApp(C As VuetifyApp, s As String)
C.SetData(endID, s)
End Sub
'start the count
Sub start(C As VueComponent)
Dim refs As BANanoObject = C.refs
refs.GetField(numberID).RunMethod("start", Null)
End Sub
Sub startOnApp(C As VuetifyApp)
Dim refs As BANanoObject = C.refs
refs.GetField(numberID).RunMethod("start", Null)
End Sub
'pause the count
Sub pause(C As VueComponent)
Dim refs As BANanoObject = C.refs
refs.GetField(numberID).RunMethod("pause", Null)
End Sub
Sub pauseOnApp(C As VuetifyApp)
Dim refs As BANanoObject = C.refs
refs.GetField(numberID).RunMethod("pause", Null)
End Sub
'pause the count
Sub pauseResume(C As VueComponent)
Dim refs As BANanoObject = C.refs
refs.GetField(numberID).RunMethod("pauseResume", Null)
End Sub
Sub pauseResumeOnApp(C As VuetifyApp)
Dim refs As BANanoObject = C.refs
refs.GetField(numberID).RunMethod("pauseResume", Null)
End Sub
'reset the count
Sub reset(C As VueComponent)
Dim refs As BANanoObject = C.refs
refs.GetField(numberID).RunMethod("reset", Null)
End Sub
Sub resetOnApp(C As VuetifyApp)
Dim refs As BANanoObject = C.refs
refs.GetField(numberID).RunMethod("reset", Null)
End Sub
'Clear the value on component
'Clear the contents bound by by v-model, needs BindState
Sub Clear
reset(VC)
UpdateStartValue(VC, 0)
End Sub
'remove component
'Remove the component, this is a design time call on Initialize
Sub Remove()
mElement.Remove
BANano.SetMeToNull
End Sub
'update the state
Sub SetData(prop As String, value As Object)
If BANano.IsNull(prop) Or BANano.IsUndefined(prop) Then
prop = ""
End If
If prop = "" Then Return
prop = prop.tolowercase
bindings.put(prop, value)
End Sub
'add a class
Sub AddClass(varClass As String)
If BANano.IsUndefined(varClass) Or BANano.IsNull(varClass) Then Return
If BANano.IsNumber(varClass) Then varClass = CStr(varClass)
varClass = varClass.trim
If varClass = "" Then Return
If mElement <> Null Then
mElement.AddClass(varClass)
End If
End Sub
private Sub CStr(o As Object) As String
Return "" & o
End Sub
private Sub CleanID(v As String) As String
v = v.Replace("#","")
v = $"#${v}"$
v = v.tolowercase
Return v
End Sub
'Hidden on xtra small devices only. You need to execute this after BANano.LoadLayout on Initialize ONLY
Sub HiddenXSOnly
AddClass("hidden-xs-only")
End Sub
'Hidden on small devices only. You need to execute this after BANano.LoadLayout on Initialize ONLY
Sub HiddenSMOnly
AddClass("d-sm-none d-md-flex")
End Sub
'Hidden on medium devices only. You need to execute this after BANano.LoadLayout on Initialize ONLY
Sub HiddenMDOnly
AddClass("d-md-none d-lg-flex")
End Sub
'Hidden on large devices only. You need to execute this after BANano.LoadLayout on Initialize ONLY
Sub HiddenLGOnly
AddClass("d-lg-none d-xl-flex")
End Sub
'Hidden on xtra large devices only. You need to execute this after BANano.LoadLayout on Initialize ONLY
Sub HiddenXLOnly
AddClass("d-xl-none")
End Sub
'
'Sub HiddenXSAndDown
'End Sub
'Hidden on small and down devices. You need to execute this after BANano.LoadLayout on Initialize ONLY
Sub HiddenSMAndDown
AddClass("hidden-sm-and-down")
End Sub
'Hidden on medium and down devices. You need to execute this after BANano.LoadLayout on Initialize ONLY
Sub HiddenMDAndDown
AddClass("hidden-md-and-down")
End Sub
'Hidden on large and down devices. You need to execute this after BANano.LoadLayout on Initialize ONLY
Sub HiddenLGAndDown
AddClass("hidden-lg-and-down")
End Sub
'Sub HiddenXLAndDown
'End Sub
'
'Sub HiddenXSAndUp
'End Sub
'Hidden on small and up devices. You need to execute this after BANano.LoadLayout on Initialize ONLY
Sub HiddenSMAndUp
AddClass("hidden-sm-and-up")
End Sub
'Hidden on medium and up devices. You need to execute this after BANano.LoadLayout on Initialize ONLY
Sub HiddenMDAndUp
AddClass("hidden-md-and-up")
End Sub
'Hidden on large and up devices. You need to execute this after BANano.LoadLayout on Initialize ONLY
Sub HiddenLGAndUp
AddClass("hidden-lg-and-up")
End Sub
'Sub HiddenXLAndUp
'End Sub
'Hidden on all devics. You need to execute this after BANano.LoadLayout on Initialize ONLY
Sub HiddenOnAll
AddClass("d-none")
End Sub
'Hide only on xtra small devices. You need to execute this after BANano.LoadLayout on Initialize ONLY
Sub HideOnlyOnXS
AddClass("hidden-xs-only")
End Sub
'Hide only on small devices. You need to execute this after BANano.LoadLayout on Initialize ONLY
Sub HideOnlyOnSM
AddClass("d-sm-none d-md-flex")
End Sub
'Hide only on medium devices. You need to execute this after BANano.LoadLayout on Initialize ONLY
Sub HideOnlyOnMD
AddClass("d-md-none d-lg-flex")
End Sub
'Hide only on large devices. You need to execute this after BANano.LoadLayout on Initialize ONLY
Sub HideOnlyOnLG
AddClass("d-lg-none d-xl-flex")
End Sub
'Hide only on xtra large devices. You need to execute this after BANano.LoadLayout on Initialize ONLY
Sub HideOnlyOnXL
AddClass("d-xl-none")
End Sub
'Visible on all devices. You need to execute this after BANano.LoadLayout on Initialize ONLY
Sub VisibleOnAll
AddClass("d-flex")
End Sub
'Visible only on xtra small devices. You need to execute this after BANano.LoadLayout on Initialize ONLY
Sub VisibleOnlyOnXS
AddClass("d-flex d-sm-none")
End Sub
'Visible only on small devices. You need to execute this after BANano.LoadLayout on Initialize ONLY
Sub VisibleOnlyOnSM
AddClass("d-none d-sm-flex d-md-none")
End Sub
'Visible only on medium devices. You need to execute this after BANano.LoadLayout on Initialize ONLY
Sub VisibleOnlyOnMD
AddClass("d-none d-md-flex d-lg-none")
End Sub
'Visible only on xtra large devices. You need to execute this after BANano.LoadLayout on Initialize ONLY
Sub VisibleOnlyOnLG
AddClass("d-none d-lg-flex d-xl-none")
End Sub
'Visible only on xtra large devices. You need to execute this after BANano.LoadLayout on Initialize ONLY
Sub VisibleOnlyOnXL
AddClass("d-none d-xl-flex")
End Sub
Sub RemoveCodeBindings(b As List)
For Each k As String In b
If k <> "" Then
bindings.Remove(k)
End If
Next
End Sub
'COMPULSORY: This should be executed after BANano.Loadlayout when used on a route page component
Sub BindState(c As VueComponent)
VC = c
Dim mbindings As Map = bindings
Dim mmethods As Map = methods
'apply the binding for the control
For Each k As String In mbindings.Keys
Dim v As Object = mbindings.Get(k)
Select Case k
Case "key"
Case Else
C.SetData(k, v)
End Select
Next
'apply the events
For Each k As String In mmethods.Keys
Dim cb As BANanoObject = mmethods.Get(k)
C.SetCallBack(k, cb)
Next
End Sub
'COMPUSORY: This should be executed after BANano.Loadlayout when used on pgIndex
Sub BindStateOnApp(c As VuetifyApp)
Dim mbindings As Map = bindings
Dim mmethods As Map = methods
'apply the binding for the control
For Each k As String In mbindings.Keys
Dim v As Object = mbindings.Get(k)
Select Case k
Case "key"
Case Else
C.SetData(k, v)
End Select
Next
'apply the events
For Each k As String In mmethods.Keys
Dim cb As BANanoObject = mmethods.Get(k)
C.SetCallBack(k, cb)
Next
End Sub
Sub AddAttr(p As String, v As Object)
VElement.SetAttr(p, v)
End Sub
Sub RemoveAttr(p As String)
VElement.RemoveAttr(p)
End Sub
'Returns the name of the component with # infront for use with BANano.LoadLayout
Sub getHere As String
Return $"#${mName}"$
End Sub
Sub UpdateTextDecoration(s As String)
VElement.UpdateTextDecoration(VC, s)
End Sub
Sub UpdateTextDecorationOnApp(A As VuetifyApp, s As String)
VElement.UpdateTextDecorationOnApp(A, s)
End Sub
Sub UpdateTruncate(b As Boolean)
Dim eClass As List = VC.GetData(VElement.bindClass)
Select Case b
Case True
eClass = VElement.ListAddDistinctItem(eClass, "d-inline-block")
eClass = VElement.ListAddDistinctItem(eClass, "text-truncate")
Case False
eClass = VElement.ListRemoveItem(eClass, "d-inline-block")
eClass = VElement.ListRemoveItem(eClass, "text-truncate")
End Select
VC.SetData(VElement.bindClass, eClass)
End Sub
Sub UpdateTruncateOnApp(A As VuetifyApp, b As Boolean)
Dim eClass As List = A.GetData(VElement.bindClass)
Select Case b
Case True
eClass = VElement.ListAddDistinctItem(eClass, "d-inline-block")
eClass = VElement.ListAddDistinctItem(eClass, "text-truncate")
Case False
eClass = VElement.ListRemoveItem(eClass, "d-inline-block")
eClass = VElement.ListRemoveItem(eClass, "text-truncate")
End Select
A.SetData(VElement.bindClass, eClass)
End Sub
Sub UpdateLineThrough(b As Boolean)
Dim eClass As List = VC.GetData(VElement.bindClass)
Select Case b
Case True
eClass = VElement.ListAddDistinctItem(eClass, "text-decoration-line-through")
Case False
eClass = VElement.ListRemoveItem(eClass, "text-decoration-line-through")
End Select
VC.SetData(VElement.bindClass, eClass)
End Sub
Sub UpdateLineThroughOnApp(A As VuetifyApp, b As Boolean)
Dim eClass As List = A.GetData(VElement.bindClass)
Select Case b
Case True
eClass = VElement.ListAddDistinctItem(eClass, "text-decoration-line-through")
Case False
eClass = VElement.ListRemoveItem(eClass, "text-decoration-line-through")
End Select
A.SetData(VElement.bindClass, eClass)
End Sub
Sub UpdateFontThin(b As Boolean)
Dim eClass As List = VC.GetData(VElement.bindClass)
Select Case b
Case True
eClass = VElement.ListAddDistinctItem(eClass, "font-weight-thin")
Case False
eClass = VElement.ListRemoveItem(eClass, "font-weight-thin")
End Select
VC.SetData(VElement.bindClass, eClass)
End Sub
Sub UpdateFontThinOnApp(A As VuetifyApp, b As Boolean)
Dim eClass As List = A.GetData(VElement.bindClass)
Select Case b
Case True
eClass = VElement.ListAddDistinctItem(eClass, "font-weight-thin")
Case False
eClass = VElement.ListRemoveItem(eClass, "font-weight-thin")
End Select
A.SetData(VElement.bindClass, eClass)
End Sub
Sub UpdateFontLight(b As Boolean)
Dim eClass As List = VC.GetData(VElement.bindClass)
Select Case b
Case True
eClass = VElement.ListAddDistinctItem(eClass, "font-weight-light")
Case False
eClass = VElement.ListRemoveItem(eClass, "font-weight-light")
End Select
VC.SetData(VElement.bindClass, eClass)
End Sub
Sub UpdateFontLightOnApp(A As VuetifyApp, b As Boolean)
Dim eClass As List = A.GetData(VElement.bindClass)
Select Case b
Case True
eClass = VElement.ListAddDistinctItem(eClass, "font-weight-light")
Case False
eClass = VElement.ListRemoveItem(eClass, "font-weight-light")
End Select
A.SetData(VElement.bindClass, eClass)
End Sub
Sub UpdateUnderLine(b As Boolean)
'get the current list of bound classes
Dim eClass As List = VC.GetData(VElement.bindClass)
Select Case b
Case True
'add the class
eClass = VElement.ListAddDistinctItem(eClass, "text-decoration-underline")
Case False
'remove the class
eClass = VElement.ListRemoveItem(eClass, "text-decoration-underline")
End Select
VC.SetData(VElement.bindClass, eClass)
End Sub
Sub UpdateUnderLineOnApp(A As VuetifyApp, b As Boolean)
'get the current list of bound classes
Dim eClass As List = A.GetData(VElement.bindClass)
Select Case b
Case True
'add the class
eClass = VElement.ListAddDistinctItem(eClass, "text-decoration-underline")
Case False
'remove the class
eClass = VElement.ListRemoveItem(eClass, "text-decoration-underline")
End Select
a.SetData(VElement.bindClass, eClass)
End Sub
Sub UpdateOverline(b As Boolean)
'get the current list of bound classes
Dim eClass As List = VC.GetData(VElement.bindClass)
Select Case b
Case True
'add the class
eClass = VElement.ListAddDistinctItem(eClass, "text-decoration-overline")
Case False
'remove the class
eClass = VElement.ListRemoveItem(eClass, "text-decoration-overline")
End Select
VC.SetData(VElement.bindClass, eClass)
End Sub
Sub UpdateOverlineOnApp(C As VuetifyApp, b As Boolean)
'get the current list of bound classes
Dim eClass As List = C.GetData(VElement.bindClass)
Select Case b
Case True
'add the class
eClass = VElement.ListAddDistinctItem(eClass, "text-decoration-overline")
Case False
'remove the class
eClass = VElement.ListRemoveItem(eClass, "text-decoration-overline")
End Select
C.SetData(VElement.bindClass, eClass)
End Sub
Sub UpdateBold(b As Boolean)
'get the current list of bound classes
Dim eClass As List = VC.GetData(VElement.bindClass)
Select Case b
Case True
'add the class
eClass = VElement.ListAddDistinctItem(eClass, "font-weight-bold")
Case False
'remove the class
eClass = VElement.ListRemoveItem(eClass, "font-weight-bold")
End Select
VC.SetData(VElement.bindClass, eClass)
End Sub
Sub UpdateBoldOnApp(C As VuetifyApp, b As Boolean)
'get the current list of bound classes
Dim eClass As List = C.GetData(VElement.bindClass)
Select Case b
Case True
'add the class
eClass = VElement.ListAddDistinctItem(eClass, "font-weight-bold")
Case False
'remove the class
eClass = VElement.ListRemoveItem(eClass, "font-weight-bold")
End Select
C.SetData(VElement.bindClass, eClass)
End Sub
Sub UpdateFontWeightBlack(b As Boolean)
'get the current list of bound classes
Dim eClass As List = VC.GetData(VElement.bindClass)
Select Case b
Case True
'add the class
eClass = VElement.ListAddDistinctItem(eClass, "font-weight-black")
Case False
'remove the class
eClass = VElement.ListRemoveItem(eClass, "font-weight-black")
End Select
VC.SetData(VElement.bindClass, eClass)
End Sub
Sub UpdateFontWeightBlackOnApp(C As VuetifyApp, b As Boolean)
'get the current list of bound classes
Dim eClass As List = C.GetData(VElement.bindClass)
Select Case b
Case True
'add the class
eClass = VElement.ListAddDistinctItem(eClass, "font-weight-black")
Case False
'remove the class
eClass = VElement.ListRemoveItem(eClass, "font-weight-black")
End Select
C.SetData(VElement.bindClass, eClass)
End Sub
Sub UpdateItalic(b As Boolean)
'get the current list of bound classes
Dim eClass As List = VC.GetData(VElement.bindClass)
Select Case b
Case True
'add the class
eClass = VElement.ListAddDistinctItem(eClass, "font-italic")
Case False
'remove the class
eClass = VElement.ListRemoveItem(eClass, "font-italic")
End Select
VC.SetData(VElement.bindClass, eClass)
End Sub
Sub UpdateItalicOnApp(C As VuetifyApp, b As Boolean)
'get the current list of bound classes
Dim eClass As List = C.GetData(VElement.bindClass)
Select Case b
Case True
'add the class
eClass = VElement.ListAddDistinctItem(eClass, "font-italic")
Case False
'remove the class
eClass = VElement.ListRemoveItem(eClass, "font-italic")
End Select
C.SetData(VElement.bindClass, eClass)
End Sub
Sub UpdateTextColor(xColor As String, xIntensity As String)
VElement.UpdateTextColor(VC, xColor, xIntensity)
End Sub
Sub UpdateTextColorOnApp(C As VuetifyApp, xColor As String, xIntensity As String)
VElement.UpdateTextColorOnApp(c, xColor, xIntensity)
End Sub
Sub UpdateColor(xColor As String, xIntensity As String)
VElement.UpdateColor(VC, xColor, xIntensity)
End Sub
Sub UpdateColorOnApp(C As VuetifyApp, xColor As String, xIntensity As String)
VElement.UpdateColorOnApp(c, xColor, xIntensity)
End Sub
Sub UpdateTextAlign(talign As String)
VElement.UpdateTextAlign(VC, talign)
End Sub
Sub UpdateTextAlignOnApp(C As VuetifyApp, talign As String)
VElement.UpdateTextAlignOnApp(C, talign)
End Sub
'Toggle a class at runtime, needs BindState
Sub ToggleClass(sClass As String)
VElement.ToggleClassRuntime(VC, sClass)
End Sub
'Toggle a clas at runtime, neeeds BindState
Sub ToggleClassOnApp(A As VuetifyApp, sClass As String)
VElement.ToggleClassOnApp(A, sClass)
End Sub
'Add a class at runtime, needs BindState
Sub AddClassRT(sClass As String)
VElement.AddClassRuntime(VC, sClass)
End Sub
'Add a class at runtime, needs BindState
Sub AddClassOnApp(A As VuetifyApp, sClass As String)
VElement.AddClassRuntimeOnAPp(A, sClass)
End Sub
'Removes a class at runtime, needs BindState
Sub RemoveClassRT(sClass As String)
VElement.RemoveClassRuntime(VC, sClass)
End Sub
'Removes a class, You need to execute this after BANano.LoadLayout on Initialize ONLY
Sub RemoveClass(sClass As String)
VElement.RemoveClass(sClass)
End Sub
'Removes a class at runtime, needs BindState
Sub RemoveClassOnApp(A As VuetifyApp, sClass As String)
VElement.RemoveClassRuntimeOnApp(A, sClass)
End Sub
'Add style at runtime, needs BindState
Sub AddStyleRT(prop As String, value As String)
VElement.AddStyleRunTime(VC , prop, value)
End Sub
'Removes a style at runtime, needs BindState
Sub RemoveStyleRT(prop As String)
VElement.RemoveStyleRunTime(VC , prop)
End Sub
'Add a style at runtime. Use CamelCase, needs BindState
Sub AddStyleOnApp(A As VuetifyApp, prop As String, value As String)
VElement.AddStyleOnAPp(A , prop, value)
End Sub
'Removes a style at runtime. Use CamelCase, needs BindState
Sub RemoveStyleOnApp(A As VuetifyApp, prop As String)
VElement.RemoveStyleOnApp(A , prop)
End Sub
'Bind this attribute to this state name and specify a default value, needs BindState
Sub BindDefault(prop As String, varName As String, def As Object)
VElement.Bind(prop, varName)
VElement.SetData(varName, def)
End Sub
'Bind this attribute to this state name, needs BindState
Sub Bind(prop As String, varName As String)
VElement.Bind(prop, varName)
VElement.SetData(varName, Null)
End Sub