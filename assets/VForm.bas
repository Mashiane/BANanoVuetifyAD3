B4J=true
Group=Default Group
ModulesStructureVersion=1
Type=Class
Version=7
@EndOfDesignText@
#IgnoreWarnings:12

#Event: Input (B As Boolean)
#Event: Submit (e As BANanoEvent)
#Event: SubmitPrevent (e As BANanoEvent)

#DesignerProperty: Key: ParentID, DisplayName: ParentID, FieldType: String, DefaultValue: , Description: The id of the element to place this into
#DesignerProperty: Key: Hidden, DisplayName: Hidden, FieldType: Boolean, DefaultValue: False, Description: Form is Hidden
#DesignerProperty: Key: Guide, DisplayName: Provide Guide, FieldType: Boolean, DefaultValue: False, Description: Show Guidance notes in console
#DesignerProperty: Key: ShowLogs, DisplayName: Show Logs, FieldType: Boolean, DefaultValue: False, Description: Log each event
#DesignerProperty: Key: AutoComplete, DisplayName: Auto Complete, FieldType: Boolean, DefaultValue: False, Description: Auto Complete
#DesignerProperty: Key: LazyValidation, DisplayName: LazyValidation, FieldType: Boolean, DefaultValue: True, Description: Lazy Validation
#DesignerProperty: Key: TableName, DisplayName: TableName*, FieldType: String, DefaultValue: , Description: Database Table Name
#DesignerProperty: Key: RecordSource, DisplayName: Record Source*, FieldType: String, DefaultValue: , Description: Record Source/Table Name
#DesignerProperty: Key: Singular, DisplayName: Singular*, FieldType: String, DefaultValue: , Description: Singular Name of Record
#DesignerProperty: Key: Plural, DisplayName: Plural*, FieldType: String, DefaultValue: , Description: Plural Name of Records
#DesignerProperty: Key: PrimaryKey, DisplayName: Primary Key*, FieldType: String, DefaultValue: , Description: Primary Key Field Name
#DesignerProperty: Key: AutoIncrement, DisplayName: Auto Increment, FieldType: String, DefaultValue: , Description: Auto Increment Field Name
#DesignerProperty: Key: DisplayField, DisplayName: Delete Display Field*, FieldType: String, DefaultValue: , Description: Field name to use for deletes
#DesignerProperty: Key: FocusOn, DisplayName: FocusOn, FieldType: String, DefaultValue: , Description: Focus On Element When Opened

#DesignerProperty: Key: Clearable, DisplayName: Elements Clearable, FieldType: Boolean, DefaultValue: False, Description: Controls should be clearable
#DesignerProperty: Key: Dense, DisplayName: Elements Dense, FieldType: Boolean, DefaultValue: False, Description: Controls should be dense
#DesignerProperty: Key: HideDetails, DisplayName: Elements Hide Details, FieldType: Boolean, DefaultValue: False, Description: Controls should hide details
#DesignerProperty: Key: Filled, DisplayName: Elements Filled, FieldType: Boolean, DefaultValue: False, Description: Controls should be filled
#DesignerProperty: Key: Outlined, DisplayName: Elements Outlined, FieldType: Boolean, DefaultValue: False, Description: Controls should be outlined
#DesignerProperty: Key: Rounded, DisplayName: Elements Rounded, FieldType: Boolean, DefaultValue: False, Description: Controls should be rounded
#DesignerProperty: Key: Shaped, DisplayName: Elements Shaped, FieldType: Boolean, DefaultValue: False, Description: Controls should be shaped

#DesignerProperty: Key: Disabled, DisplayName: Disabled, FieldType: Boolean, DefaultValue: False, Description: Form is Disabled
#DesignerProperty: Key: Readonly, DisplayName: Readonly, FieldType: Boolean, DefaultValue: False, Description: Form is Readonly
#DesignerProperty: Key: ShowGridDesign, DisplayName: ShowGridDesign, FieldType: Boolean, DefaultValue: True, Description: Show Grid Design Border
'
#DesignerProperty: Key: OwnTag, DisplayName: OwnTag, FieldType: String, DefaultValue: , Description: Specify Own Tag e.g v-container
#DesignerProperty: Key: Align, DisplayName: Vertical Align, FieldType: String, DefaultValue: normal, Description: Align, List: normal|start|center|end|baseline|stretch
#DesignerProperty: Key: Justify, DisplayName: Horizontal Align, FieldType: String, DefaultValue: normal, Description: Justify, List: normal|start|center|end|space-between|space-around
#DesignerProperty: Key: Fluid, DisplayName: Fluid, FieldType: Boolean, DefaultValue: false, Description: Fluid
#DesignerProperty: Key: DFlex, DisplayName: DFlex, FieldType: Boolean, DefaultValue: false, Description: DFlex
#DesignerProperty: Key: TextCenter, DisplayName: TextCenter, FieldType: Boolean, DefaultValue: false, Description: Text Center
#DesignerProperty: Key: FillHeight, DisplayName: FillHeight, FieldType: Boolean, DefaultValue: false, Description: Fill Height
#DesignerProperty: Key: BackgroundImage, DisplayName: BackgroundImage, FieldType: String, DefaultValue:  , Description: Background Image
#DesignerProperty: Key: FitScreen, DisplayName: Fit Screen VH, FieldType: Boolean, DefaultValue: False, Description: Fit Screen Vertical Horizontal
#DesignerProperty: Key: Color, DisplayName: Color, FieldType: String, DefaultValue:  , Description: Background Color, List: amber|black|blue|blue-grey|brown|cyan|deep-orange|deep-purple|green|grey|indigo|light-blue|light-green|lime|orange|pink|purple|red|teal|transparent|white|yellow|primary|secondary|accent|error|info|success|warning|none
#DesignerProperty: Key: ColorIntensity, DisplayName: Color Intensity, FieldType: String, DefaultValue:  normal, Description: Background Color Intensity, List: normal|lighten-5|lighten-4|lighten-3|lighten-2|lighten-1|darken-1|darken-2|darken-3|darken-4|accent-1|accent-2|accent-3|accent-4

#DesignerProperty: Key: NoGutters, DisplayName: NoGutters, FieldType: Boolean, DefaultValue: False, Description: No Gutters
#DesignerProperty: Key: Border, DisplayName: Border, FieldType: String, DefaultValue:  , Description: Complete Border
#DesignerProperty: Key: BorderColor, DisplayName: BorderColor, FieldType: String, DefaultValue:  , Description: Border Color, List: amber|black|blue|blue-grey|brown|cyan|deep-orange|deep-purple|green|grey|indigo|light-blue|light-green|lime|orange|pink|purple|red|teal|transparent|white|yellow|primary|secondary|accent|error|info|success|warning|none
#DesignerProperty: Key: BorderRadius, DisplayName: Border Radius, FieldType: String, DefaultValue:  , Description: Border Radius
#DesignerProperty: Key: BorderStyle, DisplayName: Border Style, FieldType: String, DefaultValue:  , Description: Border Style, List: none|hidden|dotted|dashed|solid|double|groove|ridge|inset|outset|initial|inherit|remove
#DesignerProperty: Key: BorderWidth, DisplayName: Border Width, FieldType: String, DefaultValue:  , Description: Border Width

#DesignerProperty: Key: VBind, DisplayName: VBind, FieldType: String, DefaultValue: , Description: VBind
#DesignerProperty: Key: VIf, DisplayName: VIf, FieldType: String, DefaultValue: , Description: VIf
#DesignerProperty: Key: VOn, DisplayName: VOn, FieldType: String, DefaultValue: , Description: VOn
#DesignerProperty: Key: Classes, DisplayName: Classes, FieldType: String, DefaultValue: , Description: Classes added to the HTML tag. 
#DesignerProperty: Key: Styles, DisplayName: Styles, FieldType: String, DefaultValue: , Description: Styles added to the HTML tag. Must be a json String, use = 
#DesignerProperty: Key: Attributes, DisplayName: Attributes, FieldType: String, DefaultValue: , Description: Attributes added to the HTML tag. Must be a json String, use =

Sub Class_Globals 
    Private BANano As BANano 'ignore 
	Private mName As String 'ignore 
	Private mEventName As String 'ignore 
	Private mCallBack As Object 'ignore 
	Private mTarget As BANanoElement 'ignore 
	Private mElement As BANanoElement 'ignore 
	Private mClasses As String = "" 
	Private mStyles As String = "" 
	Private mAttributes As String = "" 
	Public VElement As VueElement 
	Private sDisabled As String
	Private bLazyValidation As Boolean
	Private sReadonly As String
	Private sVBind As String
	Private sVFor As String
	Private sVIf As String
	Private sVModel As String
	Private sVOn As String
	Private sVShow As String
 	Private bDisabled As Boolean
	Private bReadonly As Boolean
	Private sRecordSource As String
	Private bAutoComplete As Boolean
	Private sAutoIncrement As String
	Private bClearable As Boolean
	Private bDense As Boolean
	Private sDisplayField As String
	Private bFilled As Boolean
	Private sFocusOn As String
	Private bHideDetails As Boolean
	Private bOutlined As Boolean
	Private sPlural As String
	Private sPrimaryKey As String
	Private bRounded As Boolean
	Private bShaped As Boolean
	Private sSingular As String
	Private bHidden As Boolean
	'
	Public Integers As List
	Public Strings As List
	Public Doubles As List
	Public Blobs As List
	Public Defaults As Map
	Public Filterable As List
	Public Sortable As List
	Public Fields As List
	Public DBSort As List
	Public OnPDF As List
	Public OnXLS As List
	Public OnTable As List
	'
	Private DTNormal As List
	Private DTTextArea As List
	Private DTTextField As List
	Private DTIcon As List
	Private DTChip As List
	Private DTSwitch As List
	Private DTAction As List
	Private DTImage As List
	Private DTCheckBox As List
	Private DTTime As List
	Private DTMoney As List
	Private DTAvatar As List
	Private DTRating As List
	Private DTProgressCircular As List
	Private DTProgressLinear As List
	Private DTDate As List
	Private DTDateTime As List
	Private DTNumber As List
	Private DTButton As List
	Private DTLink As List
	Private DTEmail As List
	Private DTComboBox As List
	Private DTAutoComplete As List
	Private DTSelect As List
	Private DTColumnPositions As Map
	Private DTAvatarText As List
	Private DTAvatarIcon As List
	Private DTTotals As List
	Private DTTitles As List
	Private DTFileSize As List
	Private DTWidths As List
	Private DTPreDisplay As List
	Private DTConditionalClass As List
	Private DTConditionalStyle As List
	Private DTConditionalColor As List
		'
	Private formmatrix As List
	Private matrixMap As Map
	Private bShowGridDesign As Boolean
	Private sParentID As String
	Public IsCreated As Boolean
	Private sTableName As String
	Private formrules As Map
	Private bGuide As Boolean
	Private help As StringBuilder
	Public Relationships As List
	Public DataSources As List
	Private computations As Map
	Private bShowLogs As Boolean
	Private sOwnTag As String
	Private sAlign As String
	Private sJustify As String
	Private bFluid As Boolean
	Private bDFlex As Boolean
	Private bTextCenter As Boolean
	Private bFillHeight As Boolean
	Private sBackgroundImage As String
	Private bFitScreen As Boolean
	Private sColor As String
	Private sColorIntensity As String
	Private bNoGutters As Boolean
	Private sBorder As String
	Private sBorderColor As String
	Private sBorderRadius As String
	Private sBorderStyle As String
	Private sBorderWidth As String
End Sub

Sub Initialize (CallBack As Object, Name As String, EventName As String) 
	mName = Name.tolowercase 
	mEventName = EventName.ToLowerCase 
	mCallBack = CallBack	 
	mName = mName.Replace("#","") 
	mEventName = mEventName.Replace("#","") 
	If mName <> "" Then 
		Dim fKey As String = $"#${mName}"$ 
		If BANano.Exists(fKey) Then  
			mElement = BANano.GetElement(fKey) 
		End If 
	End If 
	sDisabled = $"${mName}disabled"$
	sReadonly = $"${mName}readonly"$
	sVModel = $"${mName}vmodel"$
	sVShow = $"${mName}show"$
	IsCreated = False
	formrules.Initialize 
	help.Initialize 
	Relationships.Initialize 
	DataSources.Initialize 
	computations.Initialize 
End Sub

Sub DesignerCreateView (Target As BANanoElement, Props As Map) 
	mTarget = Target 
	If Props <> Null Then 
		bGuide = Props.GetDefault("Guide",False)
		bGuide = BANanoShared.parseBool(bGuide)
		sTableName = Props.GetDefault("TableName", "")
		bDisabled = Props.GetDefault("Disabled",False)
		bReadonly = Props.GetDefault("Readonly",False)
		mClasses = Props.Get("Classes") 
		mStyles = Props.Get("Styles") 
		mAttributes = Props.Get("Attributes") 
		bLazyValidation = Props.GetDefault("LazyValidation", False)
		sVBind = Props.Get("VBind")
		sVIf = Props.Get("VIf")
		sVOn = Props.Get("VOn") 
		sRecordSource = Props.GetDefault("RecordSource", "")
		bAutoComplete = Props.GetDefault("AutoComplete", False)
		bAutoComplete = BANanoShared.parseBool(bAutoComplete)
		bHidden = Props.GetDefault("Hidden", False)
		bHidden = BANanoShared.parseBool(bHidden)
		sAutoIncrement = Props.GetDefault("AutoIncrement", "")
		bClearable = Props.GetDefault("Clearable", False)
		bClearable = BANanoShared.parseBool(bClearable)
		bDense = Props.GetDefault("Dense", False)
		bDense = BANanoShared.parseBool(bDense)
		sDisplayField = Props.GetDefault("DisplayField", "")
		bFilled = Props.GetDefault("Filled", False)
		bFilled = BANanoShared.parseBool(bFilled)
		sFocusOn = Props.GetDefault("FocusOn", "")
		bHideDetails = Props.GetDefault("HideDetails", False)
		bHideDetails = BANanoShared.parseBool(bHideDetails)
		bOutlined = Props.GetDefault("Outlined", False)
		bOutlined = BANanoShared.parseBool(bOutlined)
		sPlural = Props.GetDefault("Plural", "")
		sPrimaryKey = Props.GetDefault("PrimaryKey", "")
		bRounded = Props.GetDefault("Rounded", False)
		bRounded = BANanoShared.parseBool(bRounded)
		bShaped = Props.GetDefault("Shaped", False)
		bShaped = BANanoShared.parseBool(bShaped)
		sSingular = Props.GetDefault("Singular", "")
		bShowGridDesign = Props.GetDefault("ShowGridDesign", False)
		bShowGridDesign = BANanoShared.parseBool(bShowGridDesign)
		sParentID = Props.GetDefault("ParentID", "")
		sParentID = BANanoShared.parseNull(sParentID)
		bShowLogs = Props.GetDefault("ShowLogs", False)
		bShowLogs = BANanoShared.parseBool(bShowLogs)
		sOwnTag = Props.GetDefault("OwnTag", "")
		sOwnTag = BANanoShared.parseNull(sOwnTag)
		sAlign = Props.GetDefault("Align", "normal")
		sJustify = Props.GetDefault("Justify", "normal")
		bFluid = Props.GetDefault("Fluid", False)
		bFluid = BANanoShared.parseBool(bFluid)
		bDFlex = Props.GetDefault("DFlex", False)
		bDFlex = BANanoShared.parseBool(bDFlex)
		bTextCenter = Props.GetDefault("TextCenter", False)
		bTextCenter = BANanoShared.parseBool(bTextCenter)
		bFillHeight = Props.GetDefault("FillHeight", False)
		bFillHeight = BANanoShared.parseBool(bFillHeight)
		sBackgroundImage = Props.GetDefault("BackgroundImage", "")
		bFitScreen = Props.GetDefault("FitScreen", False)
		bFitScreen = BANanoShared.parseBool(bFitScreen)
		sColor = Props.GetDefault("Color", "")
		sColorIntensity = Props.GetDefault("ColorIntensity", "normal")
		bNoGutters = Props.GetDefault("NoGutters", False)
		bNoGutters = BANanoShared.parseBool(bNoGutters)
		sBorder = Props.GetDefault("Border", "")
		sBorderColor = Props.GetDefault("BorderColor", "")
		sBorderRadius = Props.GetDefault("BorderRadius", "")
		sBorderStyle = Props.GetDefault("BorderStyle", "")
		sBorderWidth = Props.GetDefault("BorderWidth", "")
	End If 
	'the parent has been specified
	If sParentID <> "" Then
		sParentID = sParentID.tolowercase
		mTarget.Initialize($"#${sParentID}"$)
	End If
	 
	'build and get the element 
	If BANano.Exists($"#${mName}"$) Then 
		mElement = BANano.GetElement($"#${mName}"$) 
	Else
		If sOwnTag <> "" Then
			mElement = mTarget.Append($"<${sOwnTag} ref="${mName}" id="${mName}"></${sOwnTag}>"$).Get("#" & mName) 
		Else		 
			mElement = mTarget.Append($"<v-form ref="${mName}" id="${mName}"></v-form>"$).Get("#" & mName) 
		End If
	End If 
	' 
	VElement.Initialize(mCallBack, mName, mName) 
	VElement.TagName = "v-form"
	If sOwnTag <> "" Then
		VElement.TagName = "v-form"
		VElement.AddAttr(":lazy-validation", bLazyValidation)
	End If
	VElement.Classes = mClasses 
	VElement.Styles = mStyles 
	VElement.Attributes = mAttributes 
	VElement.AddAttr(":disabled", sDisabled)
	VElement.SetData(sDisabled, bDisabled)
	
	VElement.AddAttr(":readonly", sReadonly)
	VElement.SetData(sReadonly, bReadonly)

	VElement.AddAttr("v-bind", sVBind)
	VElement.AddAttr("v-for", sVFor)
	VElement.AddAttr("v-on", sVOn)	
	VElement.AddAttr("v-model", sVModel)
	VElement.AddAttr("v-if", sVIf) 
	If bAutoComplete Then
		VElement.AddAttr("autocomplete", "on")
	Else
		VElement.AddAttr("autocomplete", "off")
	End If
	If bHidden Then
	VElement.AddAttr("v-show", sVShow)
	VElement.SetData(sVShow, Not(bHidden))
	End If
	VElement.SetData(sVModel, False)
	
	If bFluid Then 
		VElement.Bind("fluid", bFluid)
	End If
	VElement.Color = VElement.BuildColor(sColor, sColorIntensity)
	VElement.setAlign(sAlign)	
	VElement.setJustify(sJustify)
	VElement.SetAttrOnTrue(":fill-height", bFillHeight, True)
	VElement.CoverImage = sBackgroundImage
	VElement.FitScreen = bFitScreen
	VElement.Border = sBorder
	VElement.BorderColor = sBorderColor
	VElement.BorderRadius = sBorderRadius
	VElement.BorderStyle = sBorderStyle
	VElement.BorderWidth = sBorderWidth
	VElement.AddClassOnCondition("dflex", bDFlex, True)
	VElement.SetAttrOnTrue(":no-gutters", bNoGutters, True)
	VElement.AddClassOnCondition("text-center", bTextCenter, True)
	VElement.BindAllEvents
End Sub

'create the form
Sub CreateForm
	If bShowLogs Then
		Log($"${mName}.CreateForm"$)
	End If
	IsCreated = True
	'build the from from child fields
	Dim be As BANanoElement
	be.Initialize($"#${mName}"$)
	Integers.Initialize 
	Strings.Initialize 
	Doubles.Initialize 
	Blobs.Initialize 
	Filterable.Initialize 
	Sortable.Initialize 
	Fields.Initialize 
	formmatrix.Initialize
	matrixMap.Initialize 
	DBSort.Initialize 
	OnPDF.Initialize 
	OnXLS.Initialize 
	OnTable.Initialize
	DTTotals.Initialize 
	DTTitles.Initialize 
	DTFileSize.initialize
	DTWidths.Initialize 
	DTPreDisplay.Initialize 
	DTConditionalClass.Initialize 
	DTConditionalStyle.Initialize 
	DTConditionalColor.Initialize
	computations.Initialize 
	'
	DTNormal.Initialize
	DTTextArea.Initialize
	DTTextField.Initialize
	DTIcon.Initialize
	DTChip.Initialize
	DTSwitch.Initialize
	DTAction.Initialize
	DTImage.Initialize
	DTCheckBox.Initialize
	DTTime.Initialize
	DTMoney.Initialize
	DTAvatar.Initialize
	DTAvatarIcon.Initialize
	DTAvatarText.Initialize 
	DTRating.Initialize
	DTProgressCircular.Initialize
	DTProgressLinear.Initialize
	DTDate.Initialize
	DTDateTime.Initialize
	DTNumber.Initialize
	DTButton.Initialize
	DTLink.Initialize
	DTEmail.Initialize 
	DTComboBox.Initialize
	DTAutoComplete.Initialize
	DTSelect.Initialize
	DTColumnPositions.Initialize 
	
	'loop through each child, build then grid definition
	Dim children() As BANanoElement = be.Children("")
	Dim pgTot As Int = children.Length - 1
	Dim pgCnt As Int
	For pgCnt = 0 To pgTot
		'get the banano element
		Dim child As BANanoElement = children(pgCnt)
		'get the data-type
		Dim edt As String = child.GetData("type")
		
		'validate the element
		If BANano.IsNull(edt) Then edt = ""
		
		'process only vfields
		If edt <> "vfield" Then Continue
		'
		BEForGrid(child)
	Next
	'build the grid
	BuildFormGrid
	'build the actual form
	Dim children() As BANanoElement = be.Children("")
	Dim pgTot As Int = children.Length - 1
	Dim pgCnt As Int
	For pgCnt = 0 To pgTot
		'get the banano element
		Dim child As BANanoElement = children(pgCnt)
		'get the data-type
		Dim edt As String = child.GetData("type")
		'validate the element
		If BANano.IsNull(edt) Then edt = ""
		
		'process only vfields
		If edt <> "vfield" Then Continue
		'
		BEToVueElement(child)
	Next
	If bGuide Then
		Log(help.ToString)
	End If
End Sub

'link form after CreateForm
Sub LinkDataSource(ds As BananoDataSource)
	If IsCreated = False Then
		BANano.Throw($"${mName}.LinkDataSource - the form needs to be created first. Call .CreateForm first."$)
		Return
	End If
	If bShowLogs Then
		Log($"${mName}.LinkDataSource(${ds.ID})"$)
	End If
	ds.SchemaReset	
	ds.setTableName(sTableName)
	ds.setRecordSource(sRecordSource)
	ds.setPrimaryKey(sPrimaryKey)
	ds.setAutoIncrement(sAutoIncrement)
	ds.setSingular(sSingular)
	ds.setPlural(sPlural)
	ds.setDisplayField(sDisplayField)
	'only fields marked as OnDB are used
	ds.SchemaSetFields(Fields)
	ds.SchemaSetIntegers(Integers)
	ds.SchemaSetDoubles(Doubles)
	ds.SchemaSetBlobs(Blobs)
	ds.SchemaSetSelectFields(Fields)
	ds.SchemaSetDefaults(Defaults)
	ds.SchemaSetOrderBy(DBSort)
End Sub

'add a rule
'<code>
'Sub AddRule(v As String) As Object	'ignoredeadcode
'If v = "" Then
'return "This is required!"
'Else
'Return True
'End If
'End Sub
'</code>
Sub AddRule(fieldName As String, methodName As String)
	If bShowLogs Then
		Log($"${mName}.AddRule(${fieldName}, ${methodName})"$)
	End If
	fieldName = fieldName.ToLowerCase
	methodName = methodName.tolowercase
	Dim fldRules As Map = CreateMap()
	If formrules.ContainsKey(fieldName) Then
		fldRules = formrules.Get(fieldName)
	End If	
	fldRules.Put(methodName, methodName)
	formrules.Put(fieldName, fldRules)
End Sub

'link to the data table
Sub LinkDataTable(dt As VueTable)
	If IsCreated = False Then
		BANano.Throw($"${mName}.LinkDataTable - the form needs to be created first. Call .CreateForm first."$)
		Return
	End If
	'the form should be manual
	Dim bManual As Boolean = dt.Manual
	If bManual = False Then
		BANano.Throw($"LinkDataTable.${mName} - the data-table '${dt.ID}' to link to should should be set to 'Manual'."$)
		Return
	End If
	If bShowLogs Then
		Log($"${mName}.LinkDataTable(${dt.ID})"$)
	End If
	dt.PrimaryKey = sPrimaryKey
	dt.setTitle(sPlural)
	
	dt.ColumnTextareaProp = BANanoShared.Join(";", DTTextArea)
	dt.ColumnTextfieldProp = BANanoShared.Join(";", DTTextField)
	dt.ColumnChipProp = BANanoShared.Join(";", DTChip)
	dt.ColumnSwitchProp = BANanoShared.Join(";", DTSwitch)
	dt.ColumnCheckboxProp = BANanoShared.Join(";", DTCheckBox)
	dt.ColumnTimeProp = BANanoShared.Join(";", DTTime)
	dt.ColumnMoneyProp = BANanoShared.Join(";", DTMoney)
	dt.ColumnAvatarProp = BANanoShared.Join(";", DTAvatar)
	dt.ColumnImageProp = BANanoShared.Join(";", DTImage)
	dt.ColumnRatingProp = BANanoShared.Join(";", DTRating)
	dt.ColumnCircularProgressProp = BANanoShared.Join(";", DTProgressCircular)
	dt.ColumnLinearProgressProp = BANanoShared.Join(";", DTProgressLinear)
	dt.ColumnDateProp = BANanoShared.Join(";", DTDate)
	dt.ColumnDateTimeProp = BANanoShared.Join(";", DTDateTime)
	dt.ColumnButtonProp = BANanoShared.Join(";", DTButton)
	dt.ColumnComboboxProp = BANanoShared.Join(";", DTComboBox)
	dt.ColumnAutoCompleteProp = BANanoShared.Join(";", DTAutoComplete)
	dt.ColumnLinkProp = BANanoShared.Join(";", DTLink)
	dt.ColumnEmailProp = BANanoShared.Join(";", DTEmail)
	dt.ColumnSelectProp = BANanoShared.Join(";", DTSelect)
	dt.ColumnAvatarTextProp = BANanoShared.Join(";", DTAvatarText)
	dt.ColumnAvatarIconProp = BANanoShared.Join(";", DTAvatarIcon)
	dt.ColumnFieldsProp = BANanoShared.Join(";", OnTable)
	dt.ColumIconsProp = BANanoShared.Join(";", DTIcon)
	dt.ColumnSortableProp = BANanoShared.Join(";", Sortable)
	dt.ColumnFilterableProp = BANanoShared.join(";", Filterable)
	dt.ColumnTotalsProp = BANanoShared.Join(";", DTTotals)
	dt.ColumnTitlesProp = BANanoShared.Join(";", DTTitles)
	dt.ColumnFileSizeProp = BANanoShared.Join(";", DTFileSize)
	dt.ColumnWidthsProp = BANanoShared.Join(";", DTWidths)
	dt.ColumnPreDisplayProp = BANanoShared.Join(";", DTPreDisplay)
	dt.ColumnConditionalClassProp = BANanoShared.Join(";", DTConditionalClass)
	dt.ColumnConditionalColorProp = BANanoShared.Join(";", DTConditionalColor)
	dt.ColumnConditionalStyleProp = BANanoShared.Join(";", DTConditionalStyle)
	
	'build the schema of the table
	dt.BuildSchema
End Sub


private Sub BEForGrid(bc As BANanoElement)
	If bShowLogs Then
		Log($"${mName}.BEForGrid(${bc.name})"$)
	End If
	'ignore if we have parent id
	Dim ssParentID As String = bc.GetData("parentid")
	ssParentID = BANanoShared.parseNull(ssParentID)
	If ssParentID <> "" Then Return
	'
	Dim iRowPos As String = bc.GetData("rowpos")
	If BANano.IsNull(iRowPos) Then iRowPos = ""

	Dim iColPos As String = bc.GetData("colpos")
	If BANano.IsNull(iColPos) Then iColPos = ""
	'
	iRowPos = BANano.parseInt(iRowPos)
	iColPos = BANano.parseInt(iColPos)
	'
	If iRowPos >= 1 Then
		If iColPos >= 1 Then
			UpdateMatrix(iRowPos, iColPos)
		End If
	End If	
End Sub

'update the grid matrix
private Sub UpdateMatrix(row As Int, col As Int)
	Dim scol As String = BANanoShared.PadRight(col, 2, "0")
	Dim srow As String = BANanoShared.PadRight(row, 2, "0")
	Dim skey As String = $"${srow}.${scol}"$
	formmatrix.Add(skey)
End Sub

'build the grid
private Sub BuildFormGrid
	If bShowLogs Then
		Log($"${mName}.BuildGrid"$)
	End If
	'initialize the form
	Dim thisForm As VueElement
	thisForm.Initialize(mCallBack, mName, mName)
	thisForm.ShowGridDesign = bShowGridDesign
	
	matrixMap.Initialize 
	'sort the matrix
	formmatrix.Sort(True)
	
	For Each entryx As String In formmatrix
		Dim srow As String = BANanoShared.MvField(entryx, 1, ".")
		Dim scol As String = BANanoShared.MvField(entryx, 2, ".")
		'convert to integers
		srow = BANano.parseInt(srow)
		scol = BANano.parseInt(scol)
		If matrixMap.ContainsKey(srow) Then
			Dim lastCol As Int = matrixMap.Get(srow)
			lastCol = BANano.ParseInt(lastCol)
			If scol > lastCol Then
				matrixMap.Put(srow, scol)
			End If
		Else
			matrixMap.Put(srow, scol)	
		End If
	Next
	'
	For Each k As String In matrixMap.Keys
		Dim v As Int = matrixMap.Get(k)
		thisForm.AddRows1
		Select Case v
		Case 1
			'add columns12
			thisForm.AddColumns12
		Case 2
			'add columns2x6
			thisForm.AddColumns2x6
		Case 3
			'addcolumns3x4
			thisForm.AddColumns3x4
		Case 4
			'addcolumns4x3
			thisForm.AddColumns4x3
		Case 5
			thisForm.AddColumns5x2
		Case 6
			'addcolumns6x2
			thisForm.AddColumns6x2
		Case 7
			thisForm.AddColumns7x1
		Case 8
			thisForm.AddColumns8x1
		Case 9
			thisForm.AddColumns9x1
		Case 10
			thisForm.AddColumns10x1
		Case 11
			thisForm.AddColumns11x1
		Case 12
			'addcolumns12x1	
			thisForm.AddColumns12x1	
		End Select
	Next
	thisForm.BuildGrid
End Sub

private Sub HelpComment(sComment As String)
	help.Append($"***** ${sComment} "*****"$)
	help.append(CRLF)
End Sub

private Sub HelpCode(sComment As String)
	help.Append($"${sComment}"$)
	help.append(CRLF)
End Sub

Sub BEToVueElement(be As BANanoElement)
	If bShowLogs Then
		Log($"${mName}.BEToVueElement(${be.Name})"$)
	End If
	Dim fBinding As Map = CreateMap()
	Dim fData As Map = CreateMap()
	
	Dim sName As String = be.GetData("name")
	sName = BANanoShared.parseNull(sName)
	'
	HelpComment(sName)
	'
	Dim bOnTable As String = be.GetData("ontable")
	bOnTable = BANanoShared.parseBool(bOnTable)
	
	Dim sComponentType As String = be.GetData("componenttype")
	sComponentType = BANanoShared.parseNull(sComponentType)
	
	If sComponentType <> "" Then
		HelpCode($"This component type is set as '${sComponentType}'."$)
	End If
	'
	Dim ssVModel As String = be.GetData("vmodel")
	ssVModel = BANanoShared.parseNull(ssVModel)

	If ssVModel <> "" Then
		ssVModel = $"${sRecordSource}.${ssVModel}"$
		fBinding.Put("VModel", ssVModel)
		HelpCode($"The data binding for this control is '${ssVModel}'"$)
	End If
	
	'get the field name
	Dim sFieldName As String = be.GetData("fieldname")
	sFieldName = BANanoShared.parseNull(sFieldName)
	If sFieldName <> "" Then
		HelpCode($"This component is linked to a database table field named '${sFieldName}'"$)
	End If
	
		
	Dim sTitle As String = be.GetData("title")
	sTitle = BANanoShared.parseNull(sTitle)
	If sTitle <> "" Then
		fBinding.Put("Label", sTitle)
		HelpCode($"This component 'Label' / 'Caption' property (if available) is set to '${sTitle}'"$)
	End If
	
	Dim sAlt As String = be.GetData("alt")
	sAlt = BANanoShared.parseNull(sAlt)
	If sAlt <> "" Then 
		fBinding.Put("alt", sAlt)
		HelpCode($"This component 'Alt' property is set to '${sAlt}'."$)
	End If

	Dim bAutoFocus As String = be.GetData("autofocus")
	bAutoFocus = BANanoShared.parseBool(bAutoFocus)
	If bAutoFocus Then 
		fBinding.Put("Autofocus", True)
		setFocusOn(sName)
		HelpCode($"This component 'AutoFocus' property is set to 'True'."$)
	End If
		
	Dim bAutoIncrement As String = be.GetData("autoincrement")
	bAutoIncrement = BANanoShared.parseBool(bAutoIncrement)
	If bAutoIncrement Then 
		setAutoIncrement(sFieldName)
		HelpCode($"This fieldname '${sFieldName}' is the auto-increment column in the table."$)
	End If
	
	Dim ssize As String = be.GetData("size")
	ssize = BANanoShared.parseNull(ssize)
	If ssize <> "" Then
		HelpCode($"This component 'Size' property (if available) is set to '${ssize}'"$)
	End If
	
	Dim sownsize As String = be.GetData("ownsize")
	sownsize = BANanoShared.parseNull(sownsize)
	If sownsize <> "" Then
		HelpCode($"This component 'Own Size' property is set to '${sownsize}'."$)
	End If
		
	Dim iRowPos As String = be.GetData("rowpos")
	iRowPos = BANanoShared.parseNull(iRowPos)
	If iRowPos <> "" Then
		HelpCode($"This component 'Row Pos' property is set to '${iRowPos}'."$)
	End If
	
	Dim iColPos As String = be.GetData("colpos")
	iColPos = BANanoShared.parseNull(iColPos)
	If iColPos <> "" Then
		HelpCode($"This component 'Column Pos' property is set to '${iColPos}'."$)
	End If
	'
	Dim bTotals As Boolean = be.GetData("totals")
	bTotals = BANanoShared.parseBool(bTotals)
	If bTotals And sFieldName <> "" And bOnTable Then
		DTTotals.Add(sFieldName)
		HelpCode($"This component 'Totals' property is set to '${True}', the column will show totals at the bottom."$)
	End If
	'
	Dim sValueMethod As String = be.GetData("valuemethod")
	sValueMethod = BANanoShared.parseNull(sValueMethod)
	'
	Dim sClassMethod As String = be.GetData("classmethod")
	sClassMethod = BANanoShared.parsenull(sClassMethod)
	
	'
	Dim sStyleMethod As String = be.GetData("stylemethod")
	sStyleMethod = BANanoShared.parsenull(sStyleMethod)
	'
	Dim sColorMethod As String = be.GetData("colormethod")
	sColorMethod = BANanoShared.parseNull(sColorMethod)
	
	Dim sColumnType As String = be.GetData("columntype")
	sColumnType = BANanoShared.parseNull(sColumnType)
	If bOnTable And sFieldName <> "" Then
		BANanoShared.ListAddIfNotBlank(OnTable, sFieldName)
		DTTitles.Add(sTitle)

		HelpCode($"This fieldname '${sFieldName}' will be shown on the data-table."$)
	
		If sValueMethod <> "" Then 
			DTPreDisplay.Add($"${sFieldName}:${sValueMethod}"$)
		End If
		If sClassMethod <> "" Then 
			DTConditionalClass.Add($"${sFieldName}:${sClassMethod}"$)
		End If
		If sStyleMethod <> "" Then 
			DTConditionalStyle.Add($"${sFieldName}:${sStyleMethod}"$)
		End If
		If sColorMethod <> "" Then 
			DTConditionalColor.Add($"${sFieldName}:${sColorMethod}"$)
		End If
		
		If sColumnType = "Normal" Then DTNormal.Add(sFieldName)
		If sColumnType = "TextArea" Then DTTextArea.Add(sFieldName)
		If sColumnType = "TextField" Then DTTextField.Add(sFieldName)
		If sColumnType = "Icon" Then DTIcon.Add(sFieldName)
		If sColumnType = "Chip" Then DTChip.Add(sFieldName)
		If sColumnType = "Switch" Then DTSwitch.Add(sFieldName)
		If sColumnType = "Action" Then DTAction.Add(sFieldName)
		If sColumnType = "Image" Then DTImage.Add(sFieldName)
		If sColumnType = "CheckBox" Then DTCheckBox.Add(sFieldName)
		If sColumnType = "Time" Then DTTime.Add(sFieldName)
		If sColumnType = "Money" Then DTMoney.Add(sFieldName)
		If sColumnType = "Avatar" Then DTAvatar.Add(sFieldName)
		If sColumnType = "AvatarIcon" Then DTAvatarIcon.Add(sFieldName)
		If sColumnType = "AvatarText" Then DTAvatarText.Add(sFieldName)
		If sColumnType = "Rating" Then DTRating.Add(sFieldName)
		If sColumnType = "ProgressCircular" Then DTProgressCircular.Add(sFieldName)
		If sColumnType = "ProgressLinear" Then DTProgressLinear.Add(sFieldName)
		If sColumnType = "Date" Then DTDate.Add(sFieldName)
		If sColumnType = "DateTime" Then DTDateTime.Add(sFieldName)
		If sColumnType = "Number" Then DTNumber.Add(sFieldName)
		If sColumnType = "Button" Then DTButton.Add(sFieldName)
		If sColumnType = "Link" Then DTLink.Add(sFieldName)
		If sColumnType = "Email" Then DTEmail.Add(sFieldName)
		If sColumnType = "ComboBox" Then DTComboBox.Add(sFieldName)
		If sColumnType = "AutoComplete" Then DTAutoComplete.Add(sFieldName)
		If sColumnType = "Select" Then DTSelect.Add(sFieldName)
		If sColumnType <> "" Then
			HelpCode($"This fieldname '${sFieldName}' contents will be shown as '${sColumnType}' on the data-table."$)
		End If
	End If
	
	
	Dim sDataKey As String = be.GetData("datakey")
	sDataKey = BANanoShared.parseNull(sDataKey)
	
	Dim sDataSource As String = be.GetData("datasource")
	sDataSource = BANanoShared.parseNull(sDataSource)
	'If sDataSource <> "" Then 
	'	fBinding.Put("Items", sDataSource)
	'	fData.Put(sDataSource, VElement.NewList)
	'End If
	
	Dim sDataType As String = be.GetData("datatype")
	sDataType = BANanoShared.parseNull(sDataType)
	If sDataType <> "none" And sFieldName <> "" Then
		HelpCode($"This fieldname '${sFieldName}' data type will be treated as '${sDataType}' on the data-base."$)
		Select Case sDataType
		Case "integer"
			Integers.Add(sFieldName)
		Case "double"
			Doubles.Add(sFieldName)
		Case "blob"
			Blobs.Add(sFieldName)
		Case "string"
			Strings.Add(sFieldName)
		End Select
	End If

	Dim sDataValue As String = be.GetData("datavalue")
	sDataValue = BANanoShared.parseNull(sDataValue)
	'
	Dim sItemValue As String = be.getdata("itemvalue")
	sItemValue = BANanoShared.parseNull(sItemValue)
	If sItemValue <> "" Then
		fBinding.Put("ItemValue", sItemValue)	
		HelpCode($"The 'item-value' is '${sItemValue}' from the array object data source."$)
	End If
	'
	Dim sItemText As String = be.GetData("itemtext")
	sItemText = BANanoShared.parseNull(sItemText)
	If sItemText <> "" Then
		fBinding.Put("ItemText", sItemText)	
		HelpCode($"The 'item-text' is '${sItemText}' from the array object data source."$)
	End If
		
	Dim bDbSort As String = be.GetData("dbsort")
	bDbSort = BANanoShared.parseBool(bDbSort)
	If bDbSort And sFieldName <> "" Then 
		BANanoShared.ListAddIfNotBlank(DBSort, sFieldName)
		HelpCode($"This '${sFieldName}' will be used for sorting in the database when executing queries."$)
	End If
	
	Dim sDefaultValue As String = be.GetData("defaultvalue")
	sDefaultValue = BANanoShared.parseNull(sDefaultValue)
	fData.Put(sVModel, sDefaultValue)
	If sDefaultValue <> "" Then
		HelpCode($"The default value for this component is '${sDefaultValue}'."$)
	End If
		
	Dim ssDisabled As String = be.GetData("disabled")
	ssDisabled = BANanoShared.parseBool(ssDisabled)
	If ssDisabled Then
		fBinding.Put("Disabled", ssDisabled)
		HelpCode($"This component 'Disabled' property (if available) is set to '${ssDisabled}'."$)	
	End If
		
	Dim sFalseValue As String = be.GetData("falsevalue")
	sFalseValue = BANanoShared.parseNull(sFalseValue)
	If sFalseValue <> "" Then
		fBinding.Put("FalseValue", sFalseValue)
		HelpCode($"The 'False-Value' of this component is to be set as '${sFalseValue}'."$)	
	End If
	
	Dim sHeight As String = be.GetData("height")
	sHeight = BANanoShared.parseNull(sHeight)
	If sHeight <> "" Then 
		fBinding.Put("Height", sHeight)
		HelpCode($"The component 'Height' property (if applicable) is set to '${sHeight}'."$)	
	End If

	Dim bInset As String = be.GetData("inset")
	bInset = BANanoShared.parseBool(bInset)
	If bInset Then 
		fBinding.Put("Inset", True)
		HelpCode($"This component 'Inset' property (if applicable) is set to '${bInset}'"$)
	End If
	
	Dim sItemKeys As String = be.GetData("itemkeys")
	sItemKeys = BANanoShared.parseNull(sItemKeys)
	If sItemKeys <> "" Then
		HelpCode($"This component 'Item Keys' property (if applicable) is set to '${sItemKeys}'"$)
	End If

	Dim sItemValues As String = be.GetData("itemvalues")
	sItemValues = BANanoShared.parseNull(sItemValues)
	If sItemValues <> "" Then
		HelpCode($"This component 'Item Values' property (if applicable) is set to '${sItemValues}'"$)
	End If

	Dim sLazySrc As String = be.GetData("lazysrc")
	sLazySrc = BANanoShared.parseNull(sLazySrc)
	If sLazySrc <> "" Then
		HelpCode($"This component 'Lazy Src' property is set to '${sLazySrc}'"$)
	End If
	
	Dim sListItemType As String = be.GetData("listitemtype")
	sListItemType = BANanoShared.parseNull(sListItemType)
	Dim iMaxLen As String = be.GetData("maxlen")
	If BANano.IsNull(iMaxLen) Then iMaxLen = ""
	If iMaxLen <> "0" Then
		iMaxLen = BANano.parseInt(iMaxLen)
		fBinding.Put("Counter", iMaxLen)
		HelpCode($"This component 'Counter/MaxLen' property is set to '${iMaxLen}'."$)
	End If

	Dim bMultiple As String = be.GetData("multiple")
	bMultiple = BANanoShared.parseBool(bMultiple)
	If bMultiple Then
		fBinding.Put("Multiple", True)
		HelpCode($"This component has applied a 'Multiple' property, meaning multiple items can be selected."$)
	End If
	
	Dim bOnDb As String = be.GetData("ondb")
	bOnDb = BANanoShared.parseBool(bOnDb)
	If bOnDb And sFieldName <> "" Then
		BANanoShared.ListAddIfNotBlank(Fields, sFieldName)
		HelpCode($"This fieldname '${sFieldName}' will be used for CRUD functions in the database."$)
	End If
	
	Dim bOnPdf As String = be.GetData("onpdf")
	bOnPdf = BANanoShared.parseBool(bOnPdf)
	If bOnPdf And sFieldName <> "" Then
		BANanoShared.ListAddIfNotBlank(OnPDF, sFieldName)
		HelpCode($"This fieldname '${sFieldName}' will be used on the PDF report."$)
	End If
	'
	Dim sColumnPosition As String = be.GetData("columnposition")
	sColumnPosition = BANanoShared.parseNull(sColumnPosition)
	If bOnTable And sFieldName <> "" Then
		If sColumnPosition <> "" And sFieldName <> "" Then
			DTColumnPositions.Put(sFieldName, sColumnPosition)
			HelpCode($"This fieldname '${sFieldName}' will be placed on column position '${sColumnPosition}' on the data-table."$)
		End If
	End If
		
	Dim bFilterable As String = be.GetData("filterable")
	bFilterable = BANanoShared.parseBool(bFilterable)
	If bFilterable And bOnTable And sFieldName <> "" Then 
		BANanoShared.ListAddIfNotBlank(Filterable, sFieldName)
		HelpCode($"This fieldname '${sFieldName}' will be filterable on the data-table."$)
	End If	
	
	
	Dim bSortable As String = be.GetData("sortable")
	bSortable = BANanoShared.parseBool(bSortable)
	If bSortable And bOnTable And sFieldName <> "" Then
		BANanoShared.ListAddIfNotBlank(Sortable, sFieldName)
		HelpCode($"This fieldname '${sFieldName}' will be sortable on the data-table."$)
	End If
	
	Dim bOnXls As String = be.GetData("onxls")
	bOnXls = BANanoShared.parseBool(bOnXls)
	If bOnXls And sFieldName <> "" Then
		BANanoShared.ListAddIfNotBlank(OnXLS, sFieldName)
		HelpCode($"This fieldname '${sFieldName}' will be used on the XLS report."$)
	End If
	
	Dim bPrimaryKey As String = be.GetData("primarykey")
	bPrimaryKey = BANanoShared.parseBool(bPrimaryKey)
	If bPrimaryKey And sFieldName <> "" Then
		setPrimaryKey(sFieldName)
		HelpCode($"This fieldname '${sFieldName}' is the primary key of the database table."$)
	End If
	
	Dim ssReadonly As String = be.GetData("readonly")
	ssReadonly = BANanoShared.parseBool(ssReadonly)
	If ssReadonly Then
		fBinding.Put("Readonly", ssReadonly)
		HelpCode($"This component 'ReadOnly' property (if available) is set to '${ssReadonly}'"$)
	End If
	
	Dim bRequired As String = be.GetData("required")
	bRequired = BANanoShared.parseBool(bRequired)
	If bRequired Then
		fBinding.Put("Required", bRequired)
		HelpCode($"This component 'Required' property (if available) is set to '${bRequired}'"$)
		HelpCode("You might need to execute .AddRule as 'Required' is true.")
	End If
	
	Dim bReturnObject As String = be.GetData("returnobject")
	bReturnObject = BANanoShared.parseBool(bReturnObject)
	fBinding.Put("ReturnObject", bReturnObject)
	HelpCode($"This component 'Return Object' property (if available) is set to '${bReturnObject}'"$)
	
	Dim bRowDisplay As String = be.GetData("rowdisplay")
	bRowDisplay = BANanoShared.parseBool(bRowDisplay)
	If bRowDisplay Then
		fBinding.Put("Alignment", "row")
		HelpCode($"This component 'Alignment' property (if available) is set to 'row'"$)
	End If
	

	Dim sTrueValue As String = be.GetData("truevalue")
	sTrueValue = BANanoShared.parseNull(sTrueValue)
		
	If sTrueValue <> "" Then
		fBinding.Put("TrueValue", sTrueValue)
		HelpCode($"This component 'True-Value' property (if available) is set to '${sTrueValue}'"$)
	End If

	Dim bUseItems As String = be.GetData("useitems")
	bUseItems = BANanoShared.parseBool(bUseItems)
	'
	Dim sSrc As String = be.GetData("src")
	sSrc = BANanoShared.parseNull(sSrc)
	If sSrc <> "" Then
		HelpCode($"This component 'Src' property (if available) is set to '${sSrc}'"$)
	End If
	
	
	Dim sWidth As String = be.GetData("width")
	sWidth = BANanoShared.parseNull(sWidth)
	If sWidth <> "" Then
		fBinding.Put("Width", sWidth)
		HelpCode($"This component 'Width' property (if available) is set to '${sWidth}'"$)
	End If
	'
	Dim sVisible As String = be.GetData("visible")
	sVisible = BANanoShared.parseBool(sVisible)
	fBinding.Put("Hidden", Not(sVisible))
	HelpCode($"This component 'Hidden' property (if available) is set to '${sVisible}'"$)
	'
	Dim splaceholder As String = be.GetData("placeholder")
	splaceholder = BANanoShared.parseNull(splaceholder)
	If splaceholder <> "" Then
		fBinding.Put("Placeholder", splaceholder)
		HelpCode($"This component 'PlaceHolder' property (if available) is set to '${splaceholder}'"$)
	End If
	
	Dim shint As String = be.GetData("hint")
	shint = BANanoShared.parseNull(shint)
	If shint <> "" Then
		fBinding.Put("Hint", shint)
		HelpCode($"This component 'Hint' property (if available) is set to '${shint}'"$)
	End If
	'
	Dim bLoremIpsum As Boolean = be.GetData("loremipsum")
	bLoremIpsum = BANanoShared.parseBool(bLoremIpsum)
	If bLoremIpsum Then
		fBinding.put("LoremIpsum", True)
		HelpCode($"This component 'Lorem Ipsum' property (if available) is set to 'True'"$)
	End If
	'
	Dim sMaxValue As String = be.GetData("maxvalue")
	sMaxValue = BANanoShared.parseNull(sMaxValue)
	If sMaxValue <> "" Then
		HelpCode($"This component 'Max Value' property (if available) is set to '${sMaxValue}'"$)
	End If
	
	Dim sMinValue As String = be.GetData("minvalue")
	sMinValue = BANanoShared.parseNull(sMinValue)
	If sMinValue <> "" Then
		HelpCode($"This component 'Min Value' property (if available) is set to '${sMinValue}'"$)
	End If
	
	Dim bChips As Boolean = be.GetData("chips")
	If BANano.IsNull(bChips) Then bChips = False
	If bChips Then
		HelpCode($"This component 'Chips' property (if available) is set to '${bChips}'"$)
	End If
	
	'
	Dim sIconName As String = be.GetData("iconname")
	sIconName = BANanoShared.parseNull(sIconName)
	If sIconName <> "" Then
		HelpCode($"This component 'Icon Name' property (if available) is set to '${sIconName}'"$)
	End If
	'
	Dim	fColor As String = be.GetData("color")
	fColor = BANanoShared.parseNull(fColor)
	If fColor <> "" Then
		fBinding.Put("Color", fColor)
		HelpCode($"This component 'Color' property (if available) is set to '${fColor}'"$)
	End If
	'
	Dim fColorIntensity As String = be.GetData("colorintensity")
	fColor = BANanoShared.parseNull(fColor)
	If fColorIntensity <> "" Then
		fBinding.Put("ColorIntensity", fColorIntensity)
		HelpCode($"This component 'Color Intensity' property (if available) is set to '${fColorIntensity}'"$)
	End If
	
	Dim	fTextColor As String = be.GetData("textcolor")
	fTextColor = BANanoShared.parseNull(fTextColor)
	If fTextColor <> "" Then
		fBinding.Put("TextColor", fTextColor)
		HelpCode($"This component 'Text Color' property (if available) is set to '${fTextColor}'"$)
	End If
	
	Dim fTextColorIntensity As String = be.GetData("textcolorintensity")
	fTextColorIntensity = BANanoShared.parseNull(fTextColorIntensity)
	If fTextColorIntensity <> "" Then
		fBinding.Put("TextColorIntensity", fTextColorIntensity)
		HelpCode($"This component 'Text Color Intensity' property (if available) is set to '${fTextColorIntensity}'"$)
	End If
		
		
	Dim fClasses As String = be.GetData("classes") 
	fClasses = BANanoShared.parseNull(fClasses)
	If fClasses <> "" Then
		fBinding.Put("Classes", fClasses)
		HelpCode($"This component 'Classes' property (if available) is set to '${fClasses}'"$)
	End If
	
	Dim fStyles As String = be.GetData("styles") 
	fStyles = BANanoShared.parseNull(fStyles)
	If fStyles <> "" Then
		fBinding.Put("Styles", fStyles)
		HelpCode($"This component 'Styles' property (if available) is set to '${fStyles}'"$)
	End If
	
	Dim fAttributes As String = be.GetData("attributes") 
	fAttributes = BANanoShared.parseNull(fAttributes)
	If fAttributes <> "" Then
		fBinding.Put("Attributes", fAttributes)
		HelpCode($"This component 'Attributes' property (if available) is set to '${fAttributes}'"$)
	End If
	'
	Dim sButtonType As String = be.GetData("buttontype")
	sButtonType = BANanoShared.parseNull(sButtonType)
	If sButtonType <> "" Then
		HelpCode($"This component 'Button Type' property (if available) is set to '${sButtonType}'"$)
	End If
	'
	Dim sButtonPosition As String = be.GetData("buttonposition")
	sButtonPosition = BANanoShared.parseNull(sButtonPosition)
	If sButtonPosition <> "" Then
		HelpCode($"This component 'Button Position' property (if available) is set to '${sButtonPosition}'"$)
	End If
	'
	Dim sShrink As Boolean = be.GetData("shrink")
	sShrink = BANanoShared.parseBool(sShrink)
	If sShrink Then
		fBinding.Put("Shrink", sShrink)
		HelpCode($"This component 'Shrink' property (if available) is set to '${sShrink}'"$)
	End If
	'
	Dim sBackgroundColor As String = be.GetData("backgroundcolor")
	sBackgroundColor = BANanoShared.parseBool(sBackgroundColor)
	If sBackgroundColor <> "" Then
		fBinding.Put("BackgroundColor", sBackgroundColor)
		HelpCode($"This component 'Background Color' property (if available) is set to '${sBackgroundColor}'"$)
	End If
	
	Dim sBackgroundColorIntensity As String = be.GetData("backgroundcolorintensity")
	sBackgroundColorIntensity = BANanoShared.parseBool(sBackgroundColorIntensity)
	If sBackgroundColorIntensity <> "" Then
		fBinding.Put("BackgroundColorIntensity", sBackgroundColorIntensity)
		HelpCode($"This component 'Background Color Intensity' property (if available) is set to '${sBackgroundColorIntensity}'"$)
	End If
	'
	Dim bPersistentHint As Boolean = be.GetData("persistenthint")
	bPersistentHint = BANanoShared.parseBool(bPersistentHint)
	If bPersistentHint Then
		fBinding.Put("PersistentHint", True)
		HelpCode($"This component 'Persistent Hint' property (if available) is set to '${bPersistentHint}'"$)
	End If
	
	Dim bButtonRaised As Boolean = be.GetData("raised")
	bButtonRaised = BANanoShared.parseBool(bButtonRaised)
	If bButtonRaised Then
		fBinding.Put("Raised", bButtonRaised)
		HelpCode($"This component 'Raised' property (if available) is set to '${bButtonRaised}'"$)
	End If
	'
	Dim bButtonOutlined As Boolean = be.GetData("buttonoutlined")
	bButtonOutlined = BANanoShared.parseBool(bButtonOutlined)
	If bButtonOutlined Then
		HelpCode($"This component 'Button Outlined' property (if available) is set to '${bButtonOutlined}'"$)
	End If
	
	Dim bButtonAbsolute As Boolean = be.GetData("absolute")
	bButtonAbsolute = BANanoShared.parseBool(bButtonAbsolute)
	If bButtonAbsolute Then
		fBinding.Put("Absolute", bButtonAbsolute)
		HelpCode($"This component 'Absolute' property (if available) is set to '${bButtonAbsolute}'"$)
	End If
	'
	Dim bButtonApp As Boolean = be.GetData("app")
	bButtonApp = BANanoShared.parsebool(bButtonApp)
	If bButtonApp Then
		fBinding.Put("App", True)
		HelpCode($"This component 'App' property (if available) is set to '${bButtonApp}'"$)
	End If
	'
	Dim ssParentID As String = be.GetData("parentid")
	ssParentID = BANanoShared.parseNull(ssParentID)
	'
	Dim bFullWidth As Boolean = be.GetData("fullwidth")
	bFullWidth = BANanoShared.parseBool(bFullWidth)
	If bFullWidth Then
		fBinding.Put("FullWidth", bFullWidth)
		fBinding.Put("Block", bFullWidth)
		HelpCode($"This component 'FullWidth' / 'Block' property (if available) is set to '${bFullWidth}'"$)
	End If
	'
	Dim sSaveMethod As String = be.GetData("savemethod")
	sSaveMethod = BANanoShared.parseNull(sSaveMethod)
	If sSaveMethod <> "" Then
		computations.Put(sSaveMethod, sSaveMethod)
	End If
	'
	Dim bButtonRounded As Boolean = be.GetData("rounded")
	bButtonRounded = BANanoShared.parseBool(bButtonRounded)
	'
	Dim sPrependIcon As String
	sPrependIcon = be.GetData("prependicon")
	sPrependIcon = BANanoShared.parseNull(sPrependIcon)
	fBinding.put("PrependIcon", sPrependIcon)
	'
	Dim sPrependInnerIcon As String
	sPrependInnerIcon = be.GetData("prependinnericon")
	sPrependInnerIcon = BANanoShared.parseNull(sPrependInnerIcon)
	fBinding.put("PrependInnerIcon", sPrependInnerIcon)
	'
	Dim sAppendIcon As String
	sAppendIcon = be.GetData("appendicon")
	sAppendIcon = BANanoShared.parseNull(sAppendIcon)
	fBinding.put("AppendIcon", sAppendIcon)
	'
	Dim sAppendOuterIcon As String
	sAppendOuterIcon = be.GetData("appendoutericon")
	sAppendOuterIcon = BANanoShared.parseNull(sAppendOuterIcon)
	fBinding.put("AppendOuterIcon", sAppendOuterIcon)
	'
	Dim sMinHeight As String
	sMinHeight = be.GetData("minheight")
	If BANano.IsNull(sMinHeight) Then sMinHeight = ""
	fBinding.put("MinHeight", sMinHeight)
	'
	Dim sMaxHeight As String
	sMaxHeight = be.GetData("maxheight")
	If BANano.IsNull(sMaxHeight) Then sMaxHeight = ""
	fBinding.put("MaxHeight", sMaxHeight)
	'
	Dim sMinWidth As String
	sMinWidth = be.GetData("minwidth")
	If BANano.IsNull(sMinWidth) Then sMinWidth = ""
	fBinding.put("MinWidth", sMinWidth)
	'
	Dim sMaxWidth As String
	sMaxWidth = be.GetData("maxwidth")
	If BANano.IsNull(sMaxWidth) Then sMaxWidth = ""
	fBinding.put("MaxWidth", sMaxWidth)
	
	If bFilled Then
		fBinding.Put("Filled", True)
		HelpCode($"The 'Filled' property (if available) is set to '${bFilled}'"$)
	End If
	If bDense Then
		fBinding.Put("Dense", True)
		HelpCode($"The 'Dense' property (if available) is set to '${bDense}'"$)
	End If
	If bClearable Then
		fBinding.Put("Clearable", True)
		HelpCode($"The 'Clearable' property (if available) is set to '${bClearable}'"$)
	End If
	If bHideDetails Then
		fBinding.Put("HideDetails", True)
		HelpCode($"The 'Hide Details' property (if available) is set to '${bHideDetails}'"$)
	End If
	If bOutlined Then
		fBinding.Put("Outlined", True)
		HelpCode($"The 'Outlined' property (if available) is set to '${bOutlined}'"$)
	End If
	If bRounded Then
		fBinding.Put("Rounded", True)
		HelpCode($"The 'Rounded' property (if available) is set to '${bRounded}'"$)
	End If
	If bShaped Then
		fBinding.Put("Shaped", True)
		HelpCode($"The 'Shaped' property (if available) is set to '${bShaped}'"$)
	End If
	'
	'
	Dim fldRules As Map = CreateMap()
	If formrules.ContainsKey(sFieldName) Then
		fldRules = formrules.Get(sFieldName)
	End If
	'
	'define key of parent
	Dim pkey As String = $"#${mName}r${iRowPos}c${iColPos}"$
	Dim mparent As BANanoElement
	If BANano.Exists(pkey) Then
		'add on row column
		mparent.Initialize(pkey)
	Else
		'add exactly on parent
		mparent.Initialize($"#${mName}"$)
	End If
	'we have parent id
	If ssParentID <> "" Then
		If BANano.Exists($"#${ssParentID}"$) Then
			'add on row column
			mparent.Initialize($"#${ssParentID}"$)
		Else
			BANano.Throw($"The specified '${ssParentID}' does not exist!"$)
		End If
	End If
		
	'process the component type
	Select Case sComponentType
	Case "AvatarIcon"
		HelpCode($"Additional Notes...."$)
		HelpCode("The 'Own Size' property is used to set the avatar size.")
		
		fBinding.Remove("Outlined")
		fBinding.Remove("Rounded")
		fBinding.Remove("ReturnObject")
		If sownsize <> "" Then
			fBinding.Put("Size", sownsize)
		End If
		fBinding.put("AvatarType", "icon")
		fBinding.Put("Icon", sIconName)
		fBinding.Put("Position", "normal")
		Dim avt1 As VAvatar
		avt1.Initialize(mCallBack, sName, sName)
		avt1.DesignerCreateView(mparent, fBinding)
		VElement.BindVueElement(avt1.VElement)
		'
	Case "AvatarText"
		HelpCode($"Additional Notes...."$)
		HelpCode("The 'Size / Own Size' properties are used to set the icon size.")
		'
		fBinding.Remove("Outlined")
		fBinding.Remove("Rounded")
		fBinding.Remove("ReturnObject")
		If sownsize <> "" Then
			fBinding.Put("Size", sownsize)
		End If
		fBinding.put("AvatarType", "text")
		fBinding.Put("Text", sTitle)
		fBinding.Put("Position", "normal")
		Dim avt2 As VAvatar
		avt2.Initialize(mCallBack, sName, sName)
		avt2.DesignerCreateView(mparent, fBinding)
		VElement.BindVueElement(avt2.VElement)
		
		
	Case "ColorSelect"
		fBinding.Remove("ItemKeys")
		fBinding.Remove("ItemTitles")
		fBinding.Put("ColorList", True)
		fBinding.Remove("Chips")
		Dim cl As VAutoComplete
		cl.Initialize(mCallBack, sName, sName)
		cl.DesignerCreateView(mparent, fBinding)
		For Each k As String In fldRules.Keys
			Dim v As String = fldRules.Get(k)
			cl.AddRule(v)
		Next
		VElement.BindVueElement(cl.VElement)
		'
	Case "DateTimePicker"
		HelpCode($"Additional Notes...."$)
		HelpCode("The Normal Text Field properties are applied based on your options.")
		
		fBinding.Put("TypeOf", "text")
		fBinding.Remove("ReturnObject")
		fBinding.Put("AutoComplete", "off")
		fBinding.Put("DateTimePicker", True)
		Dim txtFieldc As VTextField
		txtFieldc.Initialize(mCallBack, sName, sName)
		txtFieldc.DesignerCreateView(mparent, fBinding)
		For Each k As String In fldRules.Keys
			Dim v As String = fldRules.Get(k)
			txtFieldc.AddRule(v)
		Next
		VElement.BindVueElement(txtFieldc.VElement)
		
	Case "ColorTextField"
		HelpCode($"Additional Notes...."$)
		HelpCode("The Normal Text Field properties are applied based on your options.")
		
		fBinding.Put("TypeOf", "text")
		fBinding.Remove("ReturnObject")
		fBinding.Put("AutoComplete", "off")
		fBinding.Put("ColorPicker", True)
		Dim txtFieldc As VTextField
		txtFieldc.Initialize(mCallBack, sName, sName)
		txtFieldc.DesignerCreateView(mparent, fBinding)
		For Each k As String In fldRules.Keys
			Dim v As String = fldRules.Get(k)
			txtFieldc.AddRule(v)
		Next
		VElement.BindVueElement(txtFieldc.VElement)
		
	Case "Icon"
		HelpCode($"Additional Notes...."$)
		HelpCode("The 'Size / Own Size' properties are used to set the icon size.")
		HelpCode("The 'IconName' property determines the icon to show.")
		
		fBinding.Remove("Outlined")
		fBinding.Remove("Rounded")
		fBinding.Remove("Height")
		fBinding.remove("Width")
		fBinding.Remove("ReturnObject")
		fBinding.Put("Size1", ssize)
		fBinding.Put("Position", "none")
		fBinding.Put("Caption", sIconName)
		If sownsize <> "" Then
			fBinding.Remove("Size1")
			fBinding.Put("Size", sownsize)
		End If
		Dim icn As VIcon
		icn.Initialize(mCallBack, sName, sName)
		icn.DesignerCreateView(mparent, fBinding)
		VElement.BindVueElement(icn.VElement)
	Case "Button"
		HelpCode($"Additional Notes...."$)
		HelpCode("The 'Size / Own Size' properties are used to set the button size.")
		HelpCode("The 'Icon Name' property determines the icon to show.")
		HelpCode("The 'Title' property is used as the label of the button.")
		HelpCode("The 'Button Type' property is used to determine the kind of button that will show.")
		HelpCode("The 'Button Position' property is used to determine the placement of the button.")
		HelpCode("The 'Button Raised' property when off will make the button background transparent.")
		HelpCode("The 'Button Outlined' property ensures the button is outlined.")
		
		fBinding.Remove("Outlined")
		fBinding.Remove("Rounded")
		fBinding.Remove("Height")
		fBinding.remove("Width")
		fBinding.Put("Size", ssize)
		fBinding.Put("IconName", sIconName)
		fBinding.Put("Label", sTitle)
		fBinding.Put("ItemType", sButtonType)
		If sButtonType = "fab" Then
			fBinding.Put("FAB", True)
		End If
		fBinding.Put("Position", sButtonPosition)
		fBinding.Put("Outlined", bButtonOutlined)
		If bButtonRounded Then
			fBinding.Put("Rounded", bButtonRounded)
		End If
		If bFullWidth Then
			fBinding.Put("FullWidth", True)
			
		End If
		Dim btn As VBtnIcon
		btn.Initialize(mCallBack, sName, sName)
		btn.DesignerCreateView(mparent, fBinding)
		VElement.BindVueElement(btn.VElement)
	Case "FAB"
		HelpCode($"Additional Notes...."$)
		HelpCode("The 'Size / Own Size' properties are used to set the fab size.")
		HelpCode("The 'Icon Name' property determines the icon to show.")
		HelpCode("The 'Button Position' property is used to determine the placement of the fab.")
		HelpCode("The 'Button Raised' property when off will make the button background transparent.")
		HelpCode("The 'Button Outlined' property ensured the button is outlined.")
		
		fBinding.Remove("Outlined")
		fBinding.Remove("Rounded")
		fBinding.Remove("Height")
		fBinding.remove("Width")
		fBinding.Remove("ReturnObject")
		fBinding.Put("Size", ssize)
		fBinding.Put("IconName", sIconName)
		fBinding.Put("Position", sButtonPosition)
		If sownsize <> "" Then
			fBinding.Put("Size", sownsize)
		End If
		fBinding.Put("Outlined", bButtonOutlined)
		Dim fab As VFAB
		fab.Initialize(mCallBack, sName, sName)
		fab.DesignerCreateView(mparent, fBinding)
		VElement.BindVueElement(fab.VElement)
	Case "Chip"
		HelpCode($"Additional Notes...."$)
		HelpCode("The 'Title' property will show the content of the chip label.")
		HelpCode("The 'Size / Own Size' properties are used to set the chip size.")
		HelpCode("The 'Src' properties is used to set the avatar image of the chip.")
		HelpCode("The default placement of the avatar is on the left.")
		HelpCode("By selecting 'Use Items' with 'Item Values' and 'Item Texts', you can create multiple TEXT chips.")
		
		fBinding.Remove("Outlined")
		fBinding.Remove("Rounded")
		fBinding.Remove("Label")
		fBinding.Put("Text", sTitle)
		fBinding.Put("Value", "")
		fBinding.Put("Size", ssize)
		If sownsize <> "" Then
			fBinding.Put("Size", sownsize)
		End If
		If sSrc <> "" Then
			fBinding.Put("Avatar", sSrc)
			fBinding.Put("ItemType", "avatar-left")
		End If
		'
		If bUseItems Then
			fBinding.Remove("Text")
			fBinding.Remove("Value")
			fBinding.Remove("Avatar")
			fBinding.Put("ItemType", "text")
			fBinding.Put("ItemKeys", sItemKeys)
			fBinding.Put("ItemTexts", sItemValues)
		End If
		
		Dim chp As VChip
		chp.Initialize(mCallBack, sName, sName)
		chp.DesignerCreateView(mparent, fBinding)
		VElement.BindVueElement(chp.VElement)	
	Case "P", "H6", "H1", "H2", "H3", "H4", "H5", "span", "div"
		HelpCode($"Additional Notes...."$)
		HelpCode("The 'Title' property will show the text of the element.")
		HelpCode("The 'Lorem Ipsum' property will generate random text when chosen.")
		
		fBinding.Put("Caption", sTitle)
		fBinding.Put("Size", sComponentType.tolowercase)
		fBinding.Remove("ReturnObject") 
		Dim lbl As VLabel
		lbl.Initialize(mCallBack, sName, sName)
		lbl.DesignerCreateView(mparent, fBinding)
		VElement.BindVueElement(lbl.VElement)
	Case "TextField"
		HelpCode($"Additional Notes...."$)
		HelpCode("The Normal Text Field properties are applied based on your options.")
		
		fBinding.Put("TypeOf", "text")
		fBinding.Remove("ReturnObject")
		fBinding.Put("AutoComplete", "off")
		Dim txtField As VTextField
		txtField.Initialize(mCallBack, sName, sName)
		txtField.DesignerCreateView(mparent, fBinding)
		For Each k As String In fldRules.Keys
			Dim v As String = fldRules.Get(k)
			txtField.AddRule(v)
		Next
		VElement.BindVueElement(txtField.VElement)
	Case "TextArea"
		HelpCode($"Additional Notes...."$)
		HelpCode("The Normal Text Area properties are applied based on your options.")
		HelpCode("The Text Area is set to 'AutoGrow'.")
		'
		fBinding.Put("TypeOf", "text")
		fBinding.Put("TextArea", True)
		fBinding.Put("AutoGrow", True)
		fBinding.Remove("ReturnObject")
		fBinding.Put("AutoComplete", "off")
		Dim txtFieldA As VTextField
		txtFieldA.Initialize(mCallBack, sName, sName)
		txtFieldA.DesignerCreateView(mparent, fBinding)
		For Each k As String In fldRules.Keys
			Dim v As String = fldRules.Get(k)
			txtFieldA.AddRule(v)
		Next
		VElement.BindVueElement(txtFieldA.VElement)
	Case "TimePicker"
		HelpCode($"Additional Notes...."$)
		HelpCode("The Normal Text Field properties are applied based on your options.")
		fBinding.Put("TimePicker", True)
		fBinding.Remove("ReturnObject")
		Dim txtTP As VTextField
		txtTP.Initialize(mCallBack, sName, sName)
		txtTP.DesignerCreateView(mparent, fBinding)
		For Each k As String In fldRules.Keys
			Dim v As String = fldRules.Get(k)
			txtTP.AddRule(v)
		Next
		VElement.BindVueElement(txtTP.VElement)
	Case "DatePicker"
		HelpCode($"Additional Notes...."$)
		HelpCode("The Normal Text Field properties are applied based on your options.")
		HelpCode("A 'watcher' is needed for this element to format the output date.")
		fBinding.Put("DatePicker", True)
		fBinding.Remove("ReturnObject")
		Dim txtD As VTextField
		txtD.Initialize(mCallBack, sName, sName)
		txtD.DesignerCreateView(mparent, fBinding)
		For Each k As String In fldRules.Keys
			Dim v As String = fldRules.Get(k)
			txtD.AddRule(v)
		Next
		VElement.BindVueElement(txtD.VElement)
	Case "FileInput"
		HelpCode($"Additional Notes...."$)
		HelpCode("The Normal File Input properties are applied based on your options.")
		HelpCode("A 'Change' event is needed to process the file selection.")
		HelpCode("The 'Chips' property will be applied if checked for the selected files.")
		fBinding.Remove("ReturnObject")
		fBinding.Put("TypeOf", "file")
		fBinding.Put("Chips", bChips)
		Dim fi As VFileInput
		fi.Initialize(mCallBack, sName, sName)
		fi.DesignerCreateView(mparent, fBinding)
		For Each k As String In fldRules.Keys
			Dim v As String = fldRules.Get(k)
			fi.AddRule(v)
		Next
		VElement.BindVueElement(fi.VElement)
	Case "FileInputImage"
		HelpCode($"Additional Notes...."$)
		HelpCode("A change event is needed to process the file selection.")
		fBinding.Remove("ReturnObject")
		fBinding.Put("IsGoogle", True)
		fData.Put($"${sName}filehidden"$, False)
		fBinding.Put("TypeOf", "file")
		Dim gfi As VFileInput
		gfi.Initialize(mCallBack, sName, sName)
		gfi.DesignerCreateView(mparent, fBinding)
		For Each k As String In fldRules.Keys
			Dim v As String = fldRules.Get(k)
			gfi.AddRule(v)
		Next
		VElement.BindVueElement(gfi.VElement)
	Case "Password"
		HelpCode($"Additional Notes...."$)
		HelpCode("The Normal Text Field properties are applied based on your options.")
		HelpCode("A 'ClickAppend' event is needed to toggle the password eyes.")
		'
		fBinding.Put("TypeOf", "password")
		fBinding.Put("ShowEyes", True)
		fBinding.Remove("ReturnObject")
		fBinding.Put("AutoComplete", "off")
		Dim txtP As VTextField
		txtP.Initialize(mCallBack, sName, sName)
		txtP.DesignerCreateView(mparent, fBinding)
		For Each k As String In fldRules.Keys
			Dim v As String = fldRules.Get(k)
			txtP.AddRule(v)
		Next
		VElement.BindVueElement(txtP.VElement)
	Case "ComboBox"
		HelpCode($"Additional Notes...."$)
		HelpCode("The Normal Combo Box properties are applied based on your options.")
		HelpCode("By selecting 'Use Items' with 'Item Values' and 'Item Texts', combo values are generated from those items.")
		HelpCode("The 'Chips' property will be applied if checked for the selected items.")
		HelpCode("The 'Deletable Chips' will be applied if 'Chips' is used.")
		
		If bUseItems Then
			fBinding.Put("ItemKeys", sItemKeys)
			fBinding.Put("ItemTitles", sItemValues)
		End If
		fBinding.Put("Chips", bChips)
		If bChips Then
			fBinding.Put("DeletableChips", True)
		End If
		Dim cbo As VComboBox
		cbo.Initialize(mCallBack, sName, sName)
		cbo.DesignerCreateView(mparent, fBinding)
		For Each k As String In fldRules.Keys
			Dim v As String = fldRules.Get(k)
			cbo.AddRule(v)
		Next
		VElement.BindVueElement(cbo.VElement)
	Case "AutoComplete"
		HelpCode($"Additional Notes...."$)
		HelpCode("The Normal Auto Complete properties are applied based on your options.")
		HelpCode("By selecting 'Use Items' with 'Item Values' and 'Item Texts', auto complete items are generated from those items.")
		HelpCode("The 'Chips' property will be applied if checked for the selected items.")
		HelpCode("The 'Deletable Chips' will be applied if 'Chips' is used.")
		
		If bUseItems Then
			fBinding.Put("ItemKeys", sItemKeys)
			fBinding.Put("ItemTitles", sItemValues)
		End If
		fBinding.Put("Chips", bChips)
		If bChips Then
			fBinding.Put("DeletableChips", True)
		End If
		Dim ac As VAutoComplete
		ac.Initialize(mCallBack, sName, sName)
		ac.DesignerCreateView(mparent, fBinding)
		For Each k As String In fldRules.Keys
			Dim v As String = fldRules.Get(k)
			ac.AddRule(v)
		Next
		VElement.BindVueElement(ac.VElement)
	Case "Select"
		HelpCode($"Additional Notes...."$)
		HelpCode("The Normal Select properties are applied based on your options.")
		HelpCode("By selecting 'Use Items' with 'Item Values' and 'Item Texts', select items are generated from those items.")
		HelpCode("The 'Chips' property will be applied if checked for the selected items.")
		HelpCode("The 'Deletable Chips' will be applied if 'Chips' is used.")
		
		If bUseItems Then
			fBinding.Put("ItemKeys", sItemKeys)
			fBinding.Put("ItemTitles", sItemValues)
		End If
		fBinding.Put("Chips", bChips)
		If bChips Then
			fBinding.Put("DeletableChips", True)
		End If
		Dim selx As VSelect
		selx.Initialize(mCallBack, sName, sName)
		selx.DesignerCreateView(mparent, fBinding)
		For Each k As String In fldRules.Keys
			Dim v As String = fldRules.Get(k)
			selx.AddRule(v)
		Next
		VElement.BindVueElement(selx.VElement)
	Case "Avatar"
		HelpCode($"Additional Notes...."$)
		HelpCode("The 'Own Size' property is used to set the avatar size.")
		HelpCode("The 'Src' property is used to set the avatar image.")
		HelpCode("The 'Src Bind' property is used to set the avatar image from v-model.")
		
		fBinding.Remove("Outlined")
		fBinding.Remove("Rounded")
		fBinding.Remove("ReturnObject")
		If sownsize <> "" Then
			fBinding.Put("Size", sownsize)
		End If
		fBinding.put("AvatarType", "image")
		If sSrc <> "" Then
			fBinding.Put("Image", sSrc)
		End If
		If ssVModel <> "" Then
			fBinding.Put("SrcBind", ssVModel)
		End If
		Dim avt As VAvatar
		avt.Initialize(mCallBack, sName, sName)
		avt.DesignerCreateView(mparent, fBinding)
		VElement.BindVueElement(avt.VElement)
	Case "CheckBox"
		HelpCode($"Additional Notes...."$)
		HelpCode("The Normal CheckBox properties are applied based on your options.")
		fBinding.Remove("ReturnObject")
		Dim chk As VCheckBox
		chk.Initialize(mCallBack, sName, sName)
		chk.DesignerCreateView(mparent, fBinding)
		For Each k As String In fldRules.Keys
			Dim v As String = fldRules.Get(k)
			chk.AddRule(v)
		Next
		VElement.BindVueElement(chk.VElement)
	Case "Switch"
		HelpCode("The Normal Switch properties are applied based on your options.")
		fBinding.Remove("ReturnObject")
		Dim swt As VSwitch
		swt.Initialize(mCallBack, sName, sName)
		swt.DesignerCreateView(mparent, fBinding)
		For Each k As String In fldRules.Keys
			Dim v As String = fldRules.Get(k)
			swt.AddRule(v)
		Next
		VElement.BindVueElement(swt.VElement)
	Case "RadioGroup"
		HelpCode($"Additional Notes...."$)
		HelpCode("The Normal Radio Group properties are applied based on your options.")
		HelpCode("By selecting 'Use Items' with 'Item Values' and 'Item Texts', radio items are generated from those items.")
		
		fBinding.Remove("ReturnObject")
		If bUseItems Then
			fBinding.Put("ItemKeys", sItemKeys)
			fBinding.Put("ItemTitles", sItemValues)
		End If
		Dim rg As VRadioGroup
		rg.Initialize(mCallBack, sName, sName)
		rg.DesignerCreateView(mparent, fBinding)
		For Each k As String In fldRules.Keys
			Dim v As String = fldRules.Get(k)
			rg.AddRule(v)
		Next
		VElement.BindVueElement(rg.VElement)
	Case "Image"
		HelpCode($"Additional Notes...."$)
		HelpCode("The Normal Image properties are applied based on your options.")
		HelpCode("The 'Width' property will be used to set the width of the image.")
		HelpCode("The 'Height' property will be used to set the height of the image.")
		HelpCode("The 'Min Width' property will be used to set the width of the image.")
		HelpCode("The 'Min Height' property will be used to set the height of the image.")
		HelpCode("The 'Src' property will be used to set the image.")
		HelpCode("The 'Src Bind' property will be used to set the image from the v-model")
		
		
		fBinding.Remove("Outlined")
		fBinding.Remove("Rounded")
		fBinding.Remove("ReturnObject")
		fBinding.Put("MinHeight", sHeight)
		fBinding.Put("MinWidth", sWidth)
		If sSrc <> "" Then
			fBinding.Put("Src", sSrc)
		End If
		If sLazySrc <> "" Then
			fBinding.Put("LazySrc", sLazySrc)
		End If
		If ssVModel <> "" Then
			fBinding.Put("SrcBind", ssVModel)
		End If
		Dim img As VImg
		img.Initialize(mCallBack, sName, sName)
		img.DesignerCreateView(mparent, fBinding)
		VElement.BindVueElement(img.VElement)
	Case "Telephone" , "Money", "Thousands"
		HelpCode($"Additional Notes...."$)
		HelpCode("The Normal Text Field properties are applied based on your options.")
		
		fBinding.Put("TypeOf", "tel")
		fBinding.Remove("ReturnObject")
		Dim txtT As VTextField
		txtT.Initialize(mCallBack, sName, sName)
		txtT.DesignerCreateView(mparent, fBinding)
		For Each k As String In fldRules.Keys
			Dim v As String = fldRules.Get(k)
			txtT.AddRule(v)
		Next
		VElement.BindVueElement(txtT.VElement)
	Case "Email"
		HelpCode($"Additional Notes...."$)
		HelpCode("The Normal Text Field properties are applied based on your options.")
		
		fBinding.Put("TypeOf", "email")
		fBinding.Remove("ReturnObject")
		Dim txtE As VTextField
		txtE.Initialize(mCallBack, sName, sName)
		txtE.DesignerCreateView(mparent, fBinding)
		For Each k As String In fldRules.Keys
			Dim v As String = fldRules.Get(k)
			txtE.AddRule(v)
		Next
		VElement.BindVueElement(txtE.VElement)
	Case "Slider"
		HelpCode($"Additional Notes...."$)
		HelpCode("The Normal Slider properties are applied based on your options.")
		HelpCode("The 'Min Value' will be applied to set the minimum value of the slider.")
		HelpCode("The 'Max Value' will be applied to set the maximum value of the slider.")
		HelpCode("The 'Max Value' will be applied to set the maximum value of the slider.")
		HelpCode("The 'Value' will be set from the specified Default value.")
		HelpCode("The 'Thumb Label' is set to show when a user drags the slider value.")
		
		
		fBinding.Remove("ReturnObject")
		If sMinValue <> "" Then
			fBinding.put("MinValue", sMinValue)
		End If
		If sMaxValue <> "" Then
			fBinding.Put("MaxValue", sMaxValue)
		End If
		If sDefaultValue <> "" Then
			fBinding.Put("Value", sDefaultValue)
		End If
		fBinding.Put("ThumbLabel", True)
		Dim sld As VSlider
		sld.Initialize(mCallBack, sName, sName)
		sld.DesignerCreateView(mparent, fBinding)
		For Each k As String In fldRules.Keys
			Dim v As String = fldRules.Get(k)
			sld.AddRule(v)
		Next
		VElement.BindVueElement(sld.VElement)
	Case "Website"
		HelpCode($"Additional Notes...."$)
		HelpCode("The Normal Text Field properties are applied based on your options.")
		
		fBinding.Put("TypeOf", "url")
		fBinding.Remove("ReturnObject")
		Dim txtW As VTextField
		txtW.Initialize(mCallBack, sName, sName)
		txtW.DesignerCreateView(mparent, fBinding)
		For Each k As String In fldRules.Keys
			Dim v As String = fldRules.Get(k)
			txtW.AddRule(v)
		Next
		VElement.BindVueElement(txtW.VElement)
	Case "Rating"
		HelpCode($"Additional Notes...."$)
		HelpCode("The Normal Rating properties are applied based on your options.")
		HelpCode("The 'Counter/Length' property is used to set the length of the ratings.")
		HelpCode("The 'Size / Own Size' properties are used to set the rating size.")
		
		fBinding.Remove("Outlined")
		fBinding.Remove("Rounded")
		fBinding.Remove("ReturnObject")
		fBinding.Put("Length", iMaxLen)
		fBinding.Put("Size1", ssize)
		If sownsize <> "" Then
			fBinding.Put("Size", sownsize)
		End If
		Dim rat As VRating
		rat.Initialize(mCallBack, sName, sName)
		rat.DesignerCreateView(mparent, fBinding)
		VElement.BindVueElement(rat.VElement)
	Case "ProgressCircular"
		HelpCode($"Additional Notes...."$)
		HelpCode("The Normal circular progress properties are applied based on your options.")
		HelpCode("The Caption of the progress is based on the v-model.")
		HelpCode("The 'Default Value' is used to set the value of the progress.")
		HelpCode("The 'Own Size' property is used to set the progress size.")
		HelpCode("The 'Src' property is used to set the avatar image inside the progress.")
		HelpCode("The 'Width' property is used to set the width of the progress.")
		
		fBinding.Remove("Outlined")
		fBinding.Remove("Rounded")
		fBinding.Remove("ReturnObject")
		fBinding.Remove("Height")
		If ssVModel <> "" Then
			fBinding.Put("Caption", $"{{ ${ssVModel} }}%"$)
		End If
		If sDefaultValue <> "" Then
			fBinding.Put("Value", sDefaultValue)
		End If
		If sownsize <> "" Then
			fBinding.Put("Size", sownsize)
		End If
		If sSrc <> "" Then
			fBinding.Put("Avatar", sSrc)
		End If
		If sWidth <> "" Then
			fBinding.Put("Width", sWidth)
		End If
		Dim prgc As VProgressCircular
		prgc.Initialize(mCallBack, sName, sName)
		prgc.DesignerCreateView(mparent, fBinding)
		VElement.BindVueElement(prgc.VElement)
	Case "ProgressLinear"
		HelpCode($"Additional Notes...."$)
		HelpCode("The Normal Rating properties are applied based on your options.")
		HelpCode("The 'Height' property is used to set the height of the progress.")
		HelpCode("The Caption of the progress is based on the v-model.")
		HelpCode("The 'Default Value' is used to set the value of the progress.")
		
		fBinding.Remove("Outlined")
		fBinding.Remove("Rounded")
		fBinding.Remove("ReturnObject")
		If sHeight <> "" Then
			fBinding.Put("Height", sHeight)
		End If
		fBinding.Put("ShowCaption", True)
		fBinding.Put("Caption", "{{ Math.ceil(value) }}%")
		If sDefaultValue <> "" Then
			fBinding.Put("Value", sDefaultValue)
		End If
		Dim prg As VProgressLinear
		prg.Initialize(mCallBack, sName, sName)
		prg.DesignerCreateView(mparent, fBinding)
		VElement.BindVueElement(prg.VElement)
	End Select	
	'eastablish bindings
	For Each k As String In fData.Keys
		Dim vx As Object = fData.Get(k)
		VElement.SetData(k, vx)
	Next
	'remove the element
	be.Remove
End Sub


'return the table Name
Sub getTableName As String
	Return sTableName
End Sub

'return the recordsource
Sub getRecordSource As String
	Return sRecordSource
End Sub

Sub AddToParent(targetID As String) 
	mTarget = BANano.GetElement("#" & targetID.ToLowerCase) 
	DesignerCreateView(mTarget, Null) 
End Sub

Sub Remove() 
	mElement.Remove 
	BANano.SetMeToNull 
End Sub

Sub AddClass(s As String) As VForm 
	VElement.AddClass(s) 
	Return Me 
End Sub

Sub AddAttr(p As String, v As Object) As VForm 
	VElement.SetAttr(p, v) 
	Return Me 
End Sub

Sub AddStyle(p As String, v As String) As VForm 
	VElement.AddStyle(p, v) 
	Return Me 
End Sub

Sub RemoveAttr(p As String) As VForm 
	VElement.RemoveAttr(p) 
	Return Me 
End Sub

'Update Disabled
Sub UpdateDisabled(C As VueComponent, vDisabled As Object)
C.SetData(sDisabled, vDisabled)
End Sub

'Update Disabled
Sub UpdateDisabledOnApp(C As VuetifyApp, vDisabled As Object)
C.SetData(sDisabled, vDisabled)
End Sub

'Update Readonly
Sub UpdateReadonly(C As VueComponent, vReadonly As Object)
C.SetData(sReadonly, vReadonly)
End Sub

'Update Readonly
Sub UpdateReadonlyOnApp(C As VuetifyApp, vReadonly As Object)
C.SetData(sReadonly, vReadonly)
End Sub

'Update Visible
Sub UpdateVisible(C As VueComponent, b As Boolean)
	C.SetData(sVShow, b)
End Sub

'Update Visible
Sub UpdateVisibleOnApp(C As VuetifyApp, b As Boolean)
	C.SetData(sVShow, b)
End Sub

'Update VModel
Sub SetValue(C As VueComponent, vVModel As Object)
C.SetData(sVModel, vVModel)
End Sub


'Update VModel
Sub SetValueOnApp(C As VuetifyApp, vVModel As Object)
C.SetData(sVModel, vVModel)
End Sub

'get value
Sub GetValue(C As VueComponent) As Object
	Dim res As Object = C.GetData(sVModel)
	Return res
End Sub

'get value
Sub GetValueOnApp(C As VuetifyApp) As Object
	Dim res As Object = C.GetData(sVModel)
	Return res
End Sub

Sub getID As String
	Return mName
End Sub


Sub getHere As String
	Return $"#${mName}"$
End Sub

'reset the form
Sub Reset(C As VueComponent)
	SetValue(C, True)
	Dim refs As BANanoObject = C.refs
	refs.GetField(mName).runmethod("reset", Null)
End Sub

'reset the form
Sub ResetOnApp(C As VuetifyApp)
	SetValueOnApp(C, True)
	C.GetRefs
	Dim refs As BANanoObject = C.refs
	refs.GetField(mName).runmethod("reset", Null)
End Sub

'reset validation not state
Sub ResetValidation(C As VueComponent)
	Dim refs As BANanoObject = C.refs
	refs.GetField(mName).runmethod("resetValidation", Null)
End Sub


'reset validation not state
Sub ResetValidationOnApp(C As VuetifyApp)
	C.GetRefs
	Dim refs As BANanoObject = C.refs
	refs.GetField(mName).runmethod("resetValidation", Null)
End Sub

'validate the form
Sub Validate(C As VueComponent) As Boolean
	Dim refs As BANanoObject = C.refs
	Dim res As Boolean = refs.GetField(mName).runmethod("validate", Null).Result
	Return res
End Sub

'validate the form
Sub ValidateOnApp(C As VuetifyApp) As Boolean
	C.GetRefs
	Dim refs As BANanoObject = C.refs
	Dim res As Boolean = refs.GetField(mName).runmethod("validate", Null).Result
	Return res
End Sub

Sub ValidateBlankOutMinusOne(C As VueComponent) As Boolean
	BlankOutMinusOne(C)
	Dim refs As BANanoObject = C.refs
	Dim res As Boolean = refs.GetField(mName).runmethod("validate", Null).Result
	Return res
End Sub

'blank out -1, for validation
Sub BlankOutMinusOne(C As VueComponent)
	If sRecordSource = "" Then Return
	Dim rec As Map = C.GetData(sRecordSource)
	For Each k As String In rec.Keys
		Dim v As String = rec.Get(k)
		v = BANanoShared.CStr(v)
		If v = "-1" Then
			rec.Put(k, "")
		End If
	Next
	C.SetData(sRecordSource, rec)
End Sub

'get the data of the form
Sub GetData(C As VueComponent) As Map
	Dim m As Map = CreateMap()
	If sRecordSource = "" Then
		BANano.Throw($"VForm.${mName} - the RecordSource has not been specified!"$)
		Return m
	End If
	m = C.GetData(sRecordSource)
	If bGuide Then
		Log($"${mName}.GetData: ${BANano.ToJson(m)}"$)
	End If
	Return m
End Sub

'get the data of the form
Sub GetDataOnApp(C As VuetifyApp) As Map
	Dim m As Map = CreateMap()
	If sRecordSource = "" Then
		BANano.Throw($"VForm.${mName} - the RecordSource has not been specified!"$)
		Return m
	End If
	m = C.GetData(sRecordSource)
	If bGuide Then
		Log($"${mName}.GetDataOnApp: ${BANano.ToJson(m)}"$)
	End If
	Return m
End Sub

'set the data of the form
Sub SetData(C As VueComponent, rec As Map)
	If sRecordSource = "" Then
		BANano.Throw($"VForm.${mName} - the RecordSource has not been specified!"$)
		Return
	End If
	If bGuide Then
		Log($"${mName}.SetData: ${BANano.ToJson(rec)}"$)
	End If
	C.SetData(sRecordSource, rec)
End Sub


'set the data of the form
Sub SetDataOnApp(C As VuetifyApp, rec As Map)
	If sRecordSource = "" Then
		BANano.Throw($"VForm.${mName} - the RecordSource has not been specified!"$)
		Return
	End If
	If bGuide Then
		Log($"${mName}.SetDataOnApp: ${BANano.ToJson(rec)}"$)
	End If
	C.SetData(sRecordSource, rec)
End Sub

Sub BindState(C As VueComponent)
	Dim mbindings As Map = VElement.bindings
	Dim mmethods As Map = VElement.methods
	'apply the binding for the control
	For Each k As String In mbindings.Keys
		Dim v As Object = mbindings.Get(k)
		Select Case k
		Case "key"
		Case Else
			C.SetData(k, v)
		End Select
	Next
	'apply the events
	For Each k As String In mmethods.Keys
		Dim cb As BANanoObject = mmethods.Get(k)
		C.SetCallBack(k, cb)
	Next
End Sub

Sub BindStateOnApp(c As VuetifyApp)
	Dim mbindings As Map = VElement.bindings
	Dim mmethods As Map = VElement.methods
	'apply the binding for the control
	For Each k As String In mbindings.Keys
		Dim v As Object = mbindings.Get(k)
		Select Case k
		Case "key"
		Case Else
			C.SetData(k, v)
		End Select
	Next
	'apply the events
	For Each k As String In mmethods.Keys
		Dim cb As BANanoObject = mmethods.Get(k)
		C.SetCallBack(k, cb)
	Next
End Sub

Sub HiddenXSOnly
	AddClass("hidden-xs-only")
End Sub

Sub HiddenSMOnly
	AddClass("d-sm-none d-md-flex")
End Sub
	
Sub HiddenMDOnly
	AddClass("d-md-none d-lg-flex")
End Sub
	
Sub HiddenLGOnly
	AddClass("d-lg-none d-xl-flex")
End Sub
	
Sub HiddenXLOnly
	AddClass("d-xl-none")
End Sub
'
'Sub HiddenXSAndDown
	
'End Sub

Sub HiddenSMAndDown
	AddClass("hidden-sm-and-down")
End Sub
	
Sub HiddenMDAndDown
	AddClass("hidden-md-and-down")
End Sub
	
Sub HiddenLGAndDown
	AddClass("hidden-lg-and-down")
End Sub
	
'Sub HiddenXLAndDown
	
'End Sub
'
'Sub HiddenXSAndUp
	
'End Sub

Sub HiddenSMAndUp
	AddClass("hidden-sm-and-up")
End Sub
	
Sub HiddenMDAndUp
	AddClass("hidden-md-and-up")
End Sub
	
Sub HiddenLGAndUp
	AddClass("hidden-lg-and-up")
End Sub
	
'Sub HiddenXLAndUp
	
'End Sub	

Sub HiddenOnAll
	AddClass("d-none")
End Sub

Sub HideOnlyOnXS
	AddClass("hidden-xs-only")
End Sub

Sub HideOnlyOnSM
	AddClass("d-sm-none d-md-flex")
End Sub

Sub HideOnlyOnMD
	AddClass("d-md-none d-lg-flex")
End Sub

Sub HideOnlyOnLG
	AddClass("d-lg-none d-xl-flex")
End Sub

Sub HideOnlyOnXL
	AddClass("d-xl-none")
End Sub

Sub VisibleOnAll
	AddClass("d-flex")
End Sub

Sub VisibleOnlyOnXS
	AddClass("d-flex d-sm-none")
End Sub

Sub VisibleOnlyOnSM
	AddClass("d-none d-sm-flex d-md-none")
End Sub

Sub VisibleOnlyOnMD
	AddClass("d-none d-md-flex d-lg-none")
End Sub

Sub VisibleOnlyOnLG
	AddClass("d-none d-lg-flex d-xl-none")
End Sub

Sub VisibleOnlyOnXL
	AddClass("d-none d-xl-flex")
End Sub

'get AutoIncrement
Sub getAutoIncrement As String
Return sAutoIncrement
End Sub

'set AutoIncrement
Sub setAutoIncrement(vAutoIncrement As String)
If BANano.IsNull(vAutoIncrement) Or BANano.IsUndefined(vAutoIncrement) Then Return
sAutoIncrement  = vAutoIncrement
End Sub

'get Clearable
Sub getClearable As Boolean
Return bClearable
End Sub

'set Clearable
Sub setClearable(vClearable As Boolean)
If BANano.IsNull(vClearable) Or BANano.IsUndefined(vClearable) Then Return
bClearable  = vClearable
End Sub

'get Dense
Sub getDense As Boolean
Return bDense
End Sub

'set Dense
Sub setDense(vDense As Boolean)
If BANano.IsNull(vDense) Or BANano.IsUndefined(vDense) Then Return
bDense  = vDense
End Sub

'get DisplayField
Sub getDisplayField As String
Return sDisplayField
End Sub

'set DisplayField
Sub setDisplayField(vDisplayField As String)
If BANano.IsNull(vDisplayField) Or BANano.IsUndefined(vDisplayField) Then Return
sDisplayField  = vDisplayField
End Sub

'get Filled
Sub getFilled As Boolean
Return bFilled
End Sub

'set Filled
Sub setFilled(vFilled As Boolean)
If BANano.IsNull(vFilled) Or BANano.IsUndefined(vFilled) Then Return
bFilled  = vFilled
End Sub

'get FocusOn
Sub getFocusOn As String
Return sFocusOn
End Sub

'set FocusOn
Sub setFocusOn(vFocusOn As String)
If BANano.IsNull(vFocusOn) Or BANano.IsUndefined(vFocusOn) Then Return
sFocusOn  = vFocusOn
End Sub

'get HideDetails
Sub getHideDetails As Boolean
Return bHideDetails
End Sub

'set HideDetails
Sub setHideDetails(vHideDetails As Boolean)
If BANano.IsNull(vHideDetails) Or BANano.IsUndefined(vHideDetails) Then Return
bHideDetails  = vHideDetails
End Sub

'get Outlined
Sub getOutlined As Boolean
Return bOutlined
End Sub

'set Outlined
Sub setOutlined(vOutlined As Boolean)
If BANano.IsNull(vOutlined) Or BANano.IsUndefined(vOutlined) Then Return
bOutlined  = vOutlined
End Sub

'get Plural
Sub getPlural As String
Return sPlural
End Sub

'set Plural
Sub setPlural(vPlural As String)
If BANano.IsNull(vPlural) Or BANano.IsUndefined(vPlural) Then Return
sPlural  = vPlural
End Sub

'get PrimaryKey
Sub getPrimaryKey As String
Return sPrimaryKey
End Sub

'set PrimaryKey
Sub setPrimaryKey(vPrimaryKey As String)
If BANano.IsNull(vPrimaryKey) Or BANano.IsUndefined(vPrimaryKey) Then Return
sPrimaryKey  = vPrimaryKey
End Sub

'get Rounded
Sub getRounded As Boolean
Return bRounded
End Sub

'set Rounded
Sub setRounded(vRounded As Boolean)
If BANano.IsNull(vRounded) Or BANano.IsUndefined(vRounded) Then Return
bRounded  = vRounded
End Sub

'get Shaped
Sub getShaped As Boolean
Return bShaped
End Sub

'set Shaped
Sub setShaped(vShaped As Boolean)
If BANano.IsNull(vShaped) Or BANano.IsUndefined(vShaped) Then Return
bShaped  = vShaped
End Sub

'get Singular
Sub getSingular As String
Return sSingular
End Sub

'set Singular
Sub setSingular(vSingular As String)
If BANano.IsNull(vSingular) Or BANano.IsUndefined(vSingular) Then Return
sSingular  = vSingular
End Sub

Sub AddRelationship(key As String, value As String, datasource As String, vmodel As String)
	key = key.Trim
	value = value.Trim
	datasource = datasource.Trim
	'
	If value = "" Or key = "" Then Return
	Dim rel As DBRelationship
	rel.Initialize
	rel.key = key
	rel.value = value
	rel.source = datasource
	rel.vmodel = vmodel
	rel.keys = ""
	rel.values = ""
	Relationships.Add(rel)
End Sub

Sub AddDataSource(key As String, value As String, datasource As String, vmodel As String, keys As String, values As String)
	key = key.Trim
	value = value.Trim
	datasource = datasource.Trim
	'
	If keys = "" Or values = "" Then Return
	Dim rel As DBRelationship
	rel.Initialize
	rel.key = key
	rel.value = value
	rel.source = datasource
	rel.vmodel = vmodel
	rel.keys = keys
	rel.values = values
	DataSources.Add(rel)
End Sub

'execute computations
Sub Compute(C As VueComponent)
	For Each k As String In computations.keys
		If SubExists(mCallBack, k) Then
			If bGuide Then
				Log($"${mName}.${k} compute..."$)
			End If
			C.RunMethod(k, Null)
		Else
			BANano.Throw($"The computation sub '${mName}.${k}' does not exist.!"$)
		End If	
	Next
End Sub