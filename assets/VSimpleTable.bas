B4J=true
Group=Default Group
ModulesStructureVersion=1
Type=Class
Version=7
@EndOfDesignText@
#IgnoreWarnings:12

#Event: Edit (item As Map)
#Event: Clone (item As Map)
#Event: Delete (item As Map)
#Event: Check (item As Map)

#DesignerProperty: Key: Hidden, DisplayName: Hidden, FieldType: Boolean, DefaultValue: False, Description: Hidden
#DesignerProperty: Key: ItemKey, DisplayName: ItemKey, FieldType: String, DefaultValue: id, Description: ItemKey
#DesignerProperty: Key: HideHeader, DisplayName: HideHeader, FieldType: Boolean, DefaultValue: False, Description: HideHeader
#DesignerProperty: Key: FixedHeader, DisplayName: FixedHeader, FieldType: Boolean, DefaultValue: False, Description: FixedHeader
#DesignerProperty: Key: HeaderColor, DisplayName: HeaderColor, FieldType: String, DefaultValue: , Description: HeaderColor, List: amber|black|blue|blue-grey|brown|cyan|deep-orange|deep-purple|green|grey|indigo|light-blue|light-green|lime|orange|pink|purple|red|teal|transparent|white|yellow|primary|secondary|accent|error|info|success|warning|none
#DesignerProperty: Key: HeaderColorIntensity, DisplayName: Headercolorintensity, FieldType: String, DefaultValue: , Description: Headercolorintensity, List: normal|lighten-5|lighten-4|lighten-3|lighten-2|lighten-1|darken-1|darken-2|darken-3|darken-4|accent-1|accent-2|accent-3|accent-4
#DesignerProperty: Key: HeaderHeight, DisplayName: HeaderHeight, FieldType: String, DefaultValue: , Description: HeaderHeight

#DesignerProperty: Key: Columns, DisplayName: Columns (;), FieldType: String, DefaultValue: , Description: Columns
#DesignerProperty: Key: Titles, DisplayName: Titles (;), FieldType: String, DefaultValue: , Description: Titles
#DesignerProperty: Key: Widths, DisplayName: Widths (;), FieldType: String, DefaultValue: , Description: Widths
#DesignerProperty: Key: HiddenColumns, DisplayName: Hidden Columns (;), FieldType: String, DefaultValue: , Description: HiddenColumns
#DesignerProperty: Key: CheckBoxes, DisplayName: CheckBoxes (;), FieldType: String, DefaultValue: , Description: CheckBoxes

#DesignerProperty: Key: ColumnCenterAlign, DisplayName: Centered Columns (;), FieldType: String, DefaultValue: edit; delete; clone, Description: ColumnCenterAlign
#DesignerProperty: Key: ColumnRightAlign, DisplayName: Right Aligned Columns (;), FieldType: String, DefaultValue: , Description: ColumnRightAlign

#DesignerProperty: Key: Dark, DisplayName: Dark, FieldType: Boolean, DefaultValue: False, Description: Dark
#DesignerProperty: Key: Light, DisplayName: Light, FieldType: Boolean, DefaultValue: False, Description: Light
#DesignerProperty: Key: Dense, DisplayName: Dense, FieldType: Boolean, DefaultValue: False, Description: Dense
#DesignerProperty: Key: HasBorders, DisplayName: HasBorders, FieldType: Boolean, DefaultValue: True, Description: HasBorders
#DesignerProperty: Key: Responsive, DisplayName: Responsive, FieldType: Boolean, DefaultValue: True, Description: Responsive
#DesignerProperty: Key: Height, DisplayName: Height, FieldType: String, DefaultValue: , Description: Height
'
#DesignerProperty: Key: PreDisplay, DisplayName: PreDisplay (JSON), FieldType: String, DefaultValue: , Description: PreDisplay
#DesignerProperty: Key: ConditionalClass, DisplayName: ConditionalClass (JSON), FieldType: String, DefaultValue: , Description: ConditionalClass
#DesignerProperty: Key: ConditionalColor, DisplayName: ConditionalColor (JSON), FieldType: String, DefaultValue: , Description: ConditionalColor
#DesignerProperty: Key: ConditionalStyle, DisplayName: ConditionalStyle (JSON), FieldType: String, DefaultValue: , Description: ConditionalStyle

#DesignerProperty: Key: HasEdit, DisplayName: HasEdit, FieldType: Boolean, DefaultValue: True, Description: HasEdit
#DesignerProperty: Key: EditColor, DisplayName: EditColor, FieldType: String, DefaultValue: green, Description: EditColor, List: amber|black|blue|blue-grey|brown|cyan|deep-orange|deep-purple|green|grey|indigo|light-blue|light-green|lime|orange|pink|purple|red|teal|transparent|white|yellow|primary|secondary|accent|error|info|success|warning|none
#DesignerProperty: Key: EditColorIntensity, DisplayName: EditColorIntensity, FieldType: String, DefaultValue: normal, Description: Editcolorintensity, List: normal|lighten-5|lighten-4|lighten-3|lighten-2|lighten-1|darken-1|darken-2|darken-3|darken-4|accent-1|accent-2|accent-3|accent-4
#DesignerProperty: Key: HasDelete, DisplayName: HasDelete, FieldType: Boolean, DefaultValue: True, Description: HasDelete
#DesignerProperty: Key: DeleteColor, DisplayName: DeleteColor, FieldType: String, DefaultValue: red, Description: DeleteColor, List: amber|black|blue|blue-grey|brown|cyan|deep-orange|deep-purple|green|grey|indigo|light-blue|light-green|lime|orange|pink|purple|red|teal|transparent|white|yellow|primary|secondary|accent|error|info|success|warning|none
#DesignerProperty: Key: DeleteColorIntensity, DisplayName: DeleteColorIntensity, FieldType: String, DefaultValue: normal, Description: Deletecolorintensity, List: normal|lighten-5|lighten-4|lighten-3|lighten-2|lighten-1|darken-1|darken-2|darken-3|darken-4|accent-1|accent-2|accent-3|accent-4
#DesignerProperty: Key: HasClone, DisplayName: HasClone, FieldType: Boolean, DefaultValue: False, Description: HasClone
#DesignerProperty: Key: CloneColor, DisplayName: CloneColor, FieldType: String, DefaultValue: amber, Description: CloneColor, List: amber|black|blue|blue-grey|brown|cyan|deep-orange|deep-purple|green|grey|indigo|light-blue|light-green|lime|orange|pink|purple|red|teal|transparent|white|yellow|primary|secondary|accent|error|info|success|warning|none
#DesignerProperty: Key: CloneColorIntensity, DisplayName: Clonecolorintensity, FieldType: String, DefaultValue: normal, Description: Clonecolorintensity, List: normal|lighten-5|lighten-4|lighten-3|lighten-2|lighten-1|darken-1|darken-2|darken-3|darken-4|accent-1|accent-2|accent-3|accent-4


#DesignerProperty: Key: VIf, DisplayName: VIf, FieldType: String, DefaultValue: , Description: VIf

#DesignerProperty: Key: Classes, DisplayName: Classes, FieldType: String, DefaultValue: , Description: Classes added to the HTML tag. 
#DesignerProperty: Key: Styles, DisplayName: Styles, FieldType: String, DefaultValue: , Description: Styles added to the HTML tag. Must be a json String, use = 
#DesignerProperty: Key: Attributes, DisplayName: Attributes, FieldType: String, DefaultValue: , Description: Attributes added to the HTML tag. Must be a json String, use =

Sub Class_Globals 
    Private BANano As BANano 'ignore 
	Private mName As String 'ignore 
	Private mEventName As String 'ignore 
	Private mCallBack As Object 'ignore 
	Private mTarget As BANanoElement 'ignore 
	Private mElement As BANanoElement 'ignore 
	Private mClasses As String = "" 
	Private mStyles As String = "" 
	Private mAttributes As String = "" 
	Public VElement As VueElement 
	Private sCloneColor As String
Private sCloneColorIntensity As String
Private sColumnCenterAlign As String
Private sColumnRightAlign As String
Private sColumns As String
Private bDark As Boolean
Private sDeleteColor As String
Private sDeleteColorIntensity As String
Private bDense As Boolean
Private sEditColor As String
Private sEditColorIntensity As String
Private bFixedHeader As Boolean
Private bHasBorders As Boolean
Private bHasClone As Boolean
Private bHasDelete As Boolean
Private bHasEdit As Boolean
Private sHeaderColor As String      'ignore
Private sHeaderColorIntensity As String   'ignore
Private sHeaderHeight As String     'ignore
Private sHeight As String
Private bHidden As Boolean
Private bLight As Boolean
Private bResponsive As Boolean
Private sTitles As String
Private sWidths As String
'
 	Private lstTitles As List
	Private lstWidths As List
	Private lstColumns As List
	Private lstCentered As List
	Private lstRightAligned As List
	'
	Private xRows As String
	Private dataRows As List
	Private sHidden As String
	Private xColumns As String
	Private sVIf As String
	Private sItemKey As String
	Private sHiddenColumns As String
	Private lstHiddenColumns As List
	Private sCheckBoxes As String
	Private lstCheckBoxes As List
	'
	Private sPreDisplay As String
	Private sConditionalClass As String
	Private sConditionalColor As String	
	Private sConditionalStyle As String
	'
	Private lstPreDisplay As List
	Private lstConditionalClass As List
	Private lstConditionalColor As List
	Private lstConditionalStyle As List
	Private bHideHeader As Boolean
	Private VC As VueComponent
End Sub

Sub Initialize (CallBack As Object, Name As String, EventName As String) 
	mName = Name.tolowercase 
	mEventName = EventName.ToLowerCase 
	mCallBack = CallBack	 
	mName = mName.Replace("#","") 
	mEventName = mEventName.Replace("#","") 
	If mName <> "" Then 
		Dim fKey As String = $"#${mName}"$ 
		If BANano.Exists(fKey) Then  
			mElement = BANano.GetElement(fKey) 
		End If 
	End If 
	xRows = $"${mName}rows"$
	sHidden = $"${mName}show"$
	xColumns = $"${mName}columns"$
	dataRows.Initialize 
End Sub

Sub DesignerCreateView (Target As BANanoElement, Props As Map) 
	mTarget = Target 
	If Props <> Null Then 
		mClasses = Props.GetDefault("Classes", "") 
		mStyles = Props.GetDefault("Styles", "") 
		mAttributes = Props.GetDefault("Attributes","") 
		sCloneColor = Props.GetDefault("CloneColor", "")
		sCloneColorIntensity = Props.GetDefault("CloneColorIntensity", "")
		sColumnCenterAlign = Props.GetDefault("ColumnCenterAlign", "")
		sColumnRightAlign = Props.GetDefault("ColumnRightAlign", "")
		sColumns = Props.GetDefault("Columns", "")
		bDark = Props.GetDefault("Dark", False)
		bDark = BANanoShared.parseBool(bDark)
		sDeleteColor = Props.GetDefault("DeleteColor", "")
		sDeleteColorIntensity = Props.GetDefault("DeleteColorIntensity", "")
		bDense = Props.GetDefault("Dense", False)
		bDense = BANanoShared.parseBool(bDense)
		sEditColor = Props.GetDefault("EditColor", "")
		sEditColorIntensity = Props.GetDefault("EditColorIntensity", "")
		bFixedHeader = Props.GetDefault("FixedHeader", False)
		bFixedHeader = BANanoShared.parseBool(bFixedHeader)
		bHasBorders = Props.GetDefault("HasBorders", False)
		bHasBorders = BANanoShared.parseBool(bHasBorders)
		bHasClone = Props.GetDefault("HasClone", False)
		bHasClone = BANanoShared.parseBool(bHasClone)
		bHasDelete = Props.GetDefault("HasDelete", False)
		bHasDelete = BANanoShared.parseBool(bHasDelete)
		bHasEdit = Props.GetDefault("HasEdit", False)
		bHasEdit = BANanoShared.parseBool(bHasEdit)
		sHeaderColor = Props.GetDefault("HeaderColor", "")
		sHeaderColorIntensity = Props.GetDefault("HeaderColorIntensity", "")
		sHeaderHeight = Props.GetDefault("HeaderHeight", "")
		sHeight = Props.GetDefault("Height", "")
		bHidden = Props.GetDefault("Hidden", False)
		bHidden = BANanoShared.parseBool(bHidden)
		bLight = Props.GetDefault("Light", False)
		bLight = BANanoShared.parseBool(bLight)
		bResponsive = Props.GetDefault("Responsive", False)
		bResponsive = BANanoShared.parseBool(bResponsive)
		sTitles = Props.GetDefault("Titles", "")
		sWidths = Props.GetDefault("Widths", "")
		sItemKey = Props.GetDefault("ItemKey","") 
		sHiddenColumns = Props.GetDefault("HiddenColumns", "")
		sCheckBoxes = Props.GetDefault("CheckBoxes", "")
		sPreDisplay = Props.getdefault("PreDisplay", "")
		sConditionalClass = Props.GetDefault("ConditionalClass", "")
		sConditionalColor = Props.GetDefault("ConditionalColor", "")
		sConditionalStyle = Props.GetDefault("ConditionalStyle", "")
		bHideHeader = Props.getdefault("HideHeader", False)
		bHideHeader = BANanoShared.parseBool(bHideHeader)
	End If 
	' 
	'build and get the element 
	If BANano.Exists($"#${mName}"$) Then 
		mElement = BANano.GetElement($"#${mName}"$) 
	Else	 
		mElement = mTarget.Append($"<v-simple-table ref="${mName}" id="${mName}"></v-simple-table>"$).Get("#" & mName) 
	End If 
	' 
	VElement.Initialize(mCallBack, mName, mName) 
	VElement.TagName = "v-simple-table"
	VElement.Classes = mClasses 
	VElement.Styles = mStyles 
	VElement.Attributes = mAttributes 
	VElement.AddAttr(":dark", bDark)
	VElement.AddAttr(":dense", bDense)
	VElement.AddAttr(":fixed-header", bFixedHeader)
	VElement.AddAttr("height", sHeight)
	If bHidden Then
	VElement.AddAttr("v-show", sHidden)
	VElement.SetData(sHidden, Not(bHidden))
	End If
	VElement.AddAttr(":light", bLight)
	
	If bHasEdit Then 
		sColumns = sColumns & ";edit"
		sTitles = sTitles & ";Edit"
	End If
	'
	If bHasDelete Then
		sColumns = sColumns & ";delete"
		sTitles = sTitles & ";Delete"
	End If
	'
	If bHasClone Then
		sColumns = sColumns & ";clone"
		sTitles = sTitles & ";Clone"
	End If
	
	'get the columns
	sColumns = sColumns.ToLowerCase
	sColumns = sColumns.Replace(" ", "")
	sColumns = sColumns.Trim
	'
	sColumnCenterAlign = sColumnCenterAlign.ToLowerCase
	sColumnRightAlign = sColumnRightAlign.ToLowerCase
	sHiddenColumns = sHiddenColumns.ToLowerCase
	sCheckBoxes = sCheckBoxes.tolowercase
	'
	lstColumns = BANanoShared.StrParseComma(";", sColumns)
	lstColumns = BANanoShared.ListTrimItems(lstColumns)
	'
	lstTitles = BANanoShared.StrParseComma(";", sTitles)
	lstTitles = BANanoShared.ListTrimItems(lstTitles)
	
	lstWidths = BANanoShared.StrParseComma(";", sWidths)
	lstWidths = BANanoShared.ListTrimItems(lstWidths)
	'
	lstCentered = BANanoShared.StrParseComma(";", sColumnCenterAlign)
	lstCentered = BANanoShared.ListTrimItems(lstCentered)
	'
	lstRightAligned = BANanoShared.StrParseComma(";", sColumnRightAlign)
	lstRightAligned = BANanoShared.ListTrimItems(lstRightAligned)
	'
	lstHiddenColumns = BANanoShared.StrParseComma(";", sHiddenColumns)
	lstHiddenColumns = BANanoShared.ListTrimItems(lstHiddenColumns)
	'
	lstCheckBoxes = BANanoShared.StrParseComma(";", sCheckBoxes)
	lstCheckBoxes = BANanoShared.ListTrimItems(lstCheckBoxes)
	'
	lstPreDisplay = BANanoShared.StrParseComma(";",  sPreDisplay)
	lstPreDisplay = BANanoShared.ListTrimItems(lstPreDisplay)
	'
	lstConditionalClass = BANanoShared.StrParseComma(";", sConditionalClass)
	lstConditionalClass = BANanoShared.ListTrimItems(lstConditionalClass)
	'
	lstConditionalColor = BANanoShared.StrParseComma(";", sConditionalColor)
	lstConditionalColor = BANanoShared.ListTrimItems(lstConditionalColor)
	'
	lstConditionalStyle = BANanoShared.StrParseComma(";", sConditionalStyle)
	lstConditionalStyle = BANanoShared.ListTrimItems(lstConditionalStyle)	
	'
	'add the rest of the table
	VElement.Append($"<v-template id="${mName}template" v-slot:default></v-template>"$)
	VElement.GetTemplate.Append($"<thead id="${mName}thead" v-show="${Not(bHideHeader)}"><tr><th v-for="hdr in ${xColumns}" v-show="hdr.visible" :key="hdr.name" :style="hdr.style" :class="hdr.class" v-text="hdr.title"></th></tr></thead>"$)
	VElement.GetTemplate.Append($"<tbody id="${mName}tbody"><tr id="${mName}tr" v-for="item in ${xRows}" :key="item.${sItemKey}"></tr></tbody>"$)
	Dim sbody As String = BuildBody
	VElement.GetTR.Append(sbody)
	'
	VElement.BindAllEvents
	BuildHeaders
End Sub

Sub AddRow(row As List)
	Dim rec As Map = CreateMap()
	Dim tColumns As Int = row.Size - 1
	Dim cColumns As Int
	For cColumns = 0 To tColumns
		Dim colName As String = lstColumns.Get(cColumns)
		Dim colValue As String = row.get(cColumns)
		rec.Put(colName, colValue)
	Next	
	dataRows.add(rec)
End Sub

Sub AddRowMap(row As Map)
	dataRows.add(row)
End Sub

'clear the rows
Sub Clear(C As VueComponent)
	dataRows.Initialize 
	C.SetData(xRows, dataRows)
End Sub

Sub ClearOnApp(C As VuetifyApp)
	dataRows.Initialize 
	C.SetData(xRows, dataRows)
End Sub

Sub BindState(C As VueComponent)
	VC = c
	BuildHeaders
	C.SetData(xRows, dataRows)
	VElement.BindState(VC)
End Sub

Sub BindStateOnApp(c As VuetifyApp)
	BuildHeaders
	C.SetData(xRows, dataRows)
	Dim mbindings As Map = VElement.bindings
	Dim mmethods As Map = VElement.methods
	'apply the binding for the control
	For Each k As String In mbindings.Keys
		Dim v As Object = mbindings.Get(k)
		Select Case k
		Case "key"
		Case Else
			C.SetData(k, v)
		End Select
	Next
	'apply the events
	For Each k As String In mmethods.Keys
		Dim cb As BANanoObject = mmethods.Get(k)
		C.SetCallBack(k, cb)
	Next
End Sub

Sub SetRows(C As VueComponent)
	C.SetData(xRows, dataRows)
End Sub

Sub SetRowsOnApp(C As VuetifyApp)
	C.SetData(xRows, dataRows)
End Sub

private Sub BuildHeaders
	Dim hdrs As List
	hdrs.Initialize 
	Dim tColumns As Int = lstColumns.Size - 1
	Dim cColumns As Int
	
	'
	For cColumns = 0 To tColumns
		Dim colName As String = lstColumns.Get(cColumns)
		Dim colTitle As String = lstTitles.Get(cColumns)
		'
		Dim hdr As Map = CreateMap()
		Dim sclass As String = "text-left"
		'find right alignment
		Dim raPos As Int = lstRightAligned.IndexOf(colName)
		If raPos >= 0 Then
			sclass = "text-right"
		End If
		'find center alignment
		Dim caPos As Int = lstCentered.IndexOf(colName)
		If caPos >= 0 Then
			sclass = "text-center"
		End If
		'find hidden status
		Dim viPos As Int = lstHiddenColumns.indexof(colName)
		If viPos >= 0 Then
			hdr.Put("visible", False)
		Else
			hdr.Put("visible", True)	
		End If
		'
		hdr.Put("name", colName)
		hdr.Put("title", colTitle)
		hdr.Put("style", "")
		hdr.Put("class", sclass)
		hdrs.Add(hdr)
	Next
	VElement.SetData(xColumns, hdrs)
End Sub

private Sub BuildBody As String
	Dim sbBody As StringBuilder
	sbBody.Initialize 
	'
	Dim tColumns As Int
	Dim cColumns As Int
	'
	Dim pre As Map = CreateMap()
	Dim con As Map = CreateMap()
	Dim colour As Map = CreateMap()
	Dim style As Map = CreateMap()
	
	tColumns = lstPreDisplay.Size - 1
	For colCnt = 0 To tColumns
		Dim fc As String = lstPreDisplay.Get(colCnt)
		Dim c As String = BANanoShared.mvfield(fc, 1, ":")
		Dim m As String = BANanoShared.MvField(fc, 2, ":")
		pre.Put(c, m)
	Next
	tColumns = lstConditionalClass.Size - 1
	For colCnt = 0 To tColumns
		Dim fc As String = lstConditionalClass.Get(colCnt)
		Dim c As String = BANanoShared.mvfield(fc, 1, ":")
		Dim m As String = BANanoShared.MvField(fc, 2, ":")
		con.Put(c, m)
	Next
	tColumns = lstConditionalColor.Size - 1
	For colCnt = 0 To tColumns
		Dim fc As String = lstConditionalColor.Get(colCnt)
		Dim c As String = BANanoShared.mvfield(fc, 1, ":")
		Dim m As String = BANanoShared.MvField(fc, 2, ":")
		colour.Put(c, m)
	Next
	tColumns = lstConditionalStyle.Size - 1
	For colCnt = 0 To tColumns
		Dim fc As String = lstConditionalStyle.Get(colCnt)
		Dim c As String = BANanoShared.mvfield(fc, 1, ":")
		Dim m As String = BANanoShared.MvField(fc, 2, ":")
		style.Put(c, m)
	Next
	'
	tColumns = lstColumns.Size - 1
	For cColumns = 0 To tColumns
		Dim colName As String = lstColumns.Get(cColumns)
		Dim eventName As String = $"${mName}_${colName}"$
		Dim colData As String = $"item.${colName}"$
		Dim spanCode As StringBuilder
		spanCode.Initialize 
		'
		Dim sline As StringBuilder
		sline.Initialize 
		sline.Append($"<td "$)
		'
		Dim sclass As String = "text-left"
		'find right alignment
		Dim raPos As Int = lstRightAligned.IndexOf(colName)
		If raPos >= 0 Then
			sclass = "text-right"
		End If
		'find center alignment
		Dim caPos As Int = lstCentered.IndexOf(colName)
		If caPos >= 0 Then
			sclass = "text-center"
		End If
		'find hidden status
		Dim viPos As Int = lstHiddenColumns.indexof(colName)
		If viPos >= 0 Then
			sline.append($" v-show=false"$)
		Else
			sline.append($" v-show=true"$)
		End If
		sline.append($" class="${sclass}""$)
		Dim prePos As Boolean = pre.ContainsKey(colName)
		If prePos Then
			Dim preCode As String = pre.Get(colName)
			colData = $"${preCode}(${colData})"$
		End If
		Dim conPos As Boolean = con.ContainsKey(colName)
		If conPos Then
			spanCode.Append($" :class="${con.Get(colName)}(item)""$)
		End If
		Dim colPos As Boolean = colour.ContainsKey(colName)
		If colPos Then
			spanCode.Append($" :color="${colour.Get(colName)}(item)""$)
		End If
		Dim stylePos As Boolean = style.ContainsKey(colName)
		If stylePos Then
			spanCode.Append($" :style="${style.Get(colName)}(item)""$)
		End If		
		sline.Append(">")
		'find if checkbox
		Dim chPos As Int = lstCheckBoxes.IndexOf(colName)
		If chPos >= 0 Then
			eventName = $"${mName}_check"$
			sline.Append($"<v-checkbox v-model="item.${colName}" ${spanCode.tostring} @change="${eventName}(item)"></v-checkbox>"$)
			VElement.SetMethod(mCallBack, eventName, Null)
			sline.Append("</td>")
			sbBody.Append(sline.ToString)
			Continue
		End If
		'
		Select Case colName
		Case "edit"
			sline.Append($"<v-btn text small icon dark class="mr-2" color="${sEditColor} ${sEditColorIntensity}" @click="${eventName}(item)"><v-icon>mdi-pencil</v-icon></v-btn>"$)
			VElement.SetMethod(mCallBack, eventName, Null)
		Case "delete"
			sline.Append($"<v-btn text small icon dark class="mr-2" color="${sDeleteColor} ${sDeleteColorIntensity}" @click="${eventName}(item)"><v-icon>mdi-delete</v-icon></v-btn>"$)
			VElement.SetMethod(mCallBack, eventName, Null)
		Case "clone"
			sline.Append($"<v-btn text small icon dark class="mr-2" color="${sCloneColor} ${sCloneColorIntensity}" @click="${eventName}(item)"><v-icon>mdi-content-copy</v-icon></v-btn>"$)
			VElement.SetMethod(mCallBack, eventName, Null)
		Case Else				
			sline.Append($"<span ${spanCode.tostring}>{{ ${colData} }}</span>"$)
		End Select
		
		sline.Append("</td>")
		sbBody.Append(sline.ToString)
	Next
	Return sbBody.ToString
End Sub


Sub Remove() 
	mTarget.Empty 
	BANano.SetMeToNull 
End Sub

Sub AddClass(s As String) As VSimpleTable 
	VElement.AddClass(s) 
	Return Me 
End Sub

Sub AddAttr(p As String, v As Object) As VSimpleTable 
	VElement.SetAttr(p, v) 
	Return Me 
End Sub

Sub AddStyle(p As String, v As String) As VSimpleTable 
	VElement.AddStyle(p, v) 
	Return Me 
End Sub

Sub RemoveAttr(p As String) As VSimpleTable 
	VElement.RemoveAttr(p) 
	Return Me 
End Sub

Sub UpdateVisible(C As VueComponent, b As Boolean) As VSimpleTable 
	C.SetData(sVIf, b) 
	C.SetData(sHidden, b) 
	Return Me 
End Sub

Sub UpdateVisibleOnApp(C As VuetifyApp, b As Boolean) As VSimpleTable 
	C.SetData(sVIf, b) 
	C.SetData(sHidden, b) 
	Return Me 
End Sub

Sub getID As String 
	Return mName 
End Sub

Sub getHere As String 
	Return $"#${mName}"$ 
End Sub


'add a new row at the end of the items in realtime
Sub AddItem(C As VueComponent, rowdata As Map)
	C.SetDataPush(xRows, rowdata)
End Sub

Sub AddItemOnApp(C As VuetifyApp, rowdata As Map)
	C.SetDataPush(xRows, rowdata)
End Sub


'add a row at the top of the list
Sub AddItemOnTop(C As VueComponent, rowdata As Map)
	C.SetDataUnshift(xRows, rowdata)
End Sub

Sub AddItemOnTopOnApp(C As VuetifyApp, rowdata As Map)
	C.SetDataUnshift(xRows, rowdata)
End Sub


'read an item where
Sub ReadItem(C As VueComponent, prop As String, value As String) As Map
	Return C.RealTimeReadItem(xRows, prop, value)
End Sub

Sub ReadItemOnApp(C As VuetifyApp, prop As String, value As String) As Map
	Return C.RealTimeReadItem(xRows, prop, value)
End Sub

'remove an item where
Sub DeleteItem(C As VueComponent, prop As String, value As String)
	C.RealTimeRemoveItem(xRows, prop, value)
End Sub

Sub DeleteItemOnApp(C As VuetifyApp, prop As String, value As String)
	C.RealTimeRemoveItem(xRows, prop, value)
End Sub

'update item where
Sub UpdateItem(C As VueComponent, prop As String, value As String, item As Map)
	C.RealTimeUpdateItem(xRows, prop, value, item)
End Sub

Sub UpdateItemOnApp(C As VuetifyApp, prop As String, value As String, item As Map)
	C.RealTimeUpdateItem(xRows, prop, value, item)
End Sub

Sub HiddenXSOnly
	AddClass("hidden-xs-only")
End Sub

Sub HiddenSMOnly
	AddClass("d-sm-none d-md-flex")
End Sub
	
Sub HiddenMDOnly
	AddClass("d-md-none d-lg-flex")
End Sub
	
Sub HiddenLGOnly
	AddClass("d-lg-none d-xl-flex")
End Sub
	
Sub HiddenXLOnly
	AddClass("d-xl-none")
End Sub
'
'Sub HiddenXSAndDown
	
'End Sub

Sub HiddenSMAndDown
	AddClass("hidden-sm-and-down")
End Sub
	
Sub HiddenMDAndDown
	AddClass("hidden-md-and-down")
End Sub
	
Sub HiddenLGAndDown
	AddClass("hidden-lg-and-down")
End Sub
	
'Sub HiddenXLAndDown
	
'End Sub
'
'Sub HiddenXSAndUp
	
'End Sub

Sub HiddenSMAndUp
	AddClass("hidden-sm-and-up")
End Sub
	
Sub HiddenMDAndUp
	AddClass("hidden-md-and-up")
End Sub
	
Sub HiddenLGAndUp
	AddClass("hidden-lg-and-up")
End Sub
	
'Sub HiddenXLAndUp
	
'End Sub	

Sub HiddenOnAll
	AddClass("d-none")
End Sub

Sub HideOnlyOnXS
	AddClass("hidden-xs-only")
End Sub

Sub HideOnlyOnSM
	AddClass("d-sm-none d-md-flex")
End Sub

Sub HideOnlyOnMD
	AddClass("d-md-none d-lg-flex")
End Sub

Sub HideOnlyOnLG
	AddClass("d-lg-none d-xl-flex")
End Sub

Sub HideOnlyOnXL
	AddClass("d-xl-none")
End Sub

Sub VisibleOnAll
	AddClass("d-flex")
End Sub

Sub VisibleOnlyOnXS
	AddClass("d-flex d-sm-none")
End Sub

Sub VisibleOnlyOnSM
	AddClass("d-none d-sm-flex d-md-none")
End Sub

Sub VisibleOnlyOnMD
	AddClass("d-none d-md-flex d-lg-none")
End Sub

Sub VisibleOnlyOnLG
	AddClass("d-none d-lg-flex d-xl-none")
End Sub

Sub VisibleOnlyOnXL
	AddClass("d-none d-xl-flex")
End Sub