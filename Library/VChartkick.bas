B4J=true
Group=Default Group
ModulesStructureVersion=1
Type=Class
Version=7
@EndOfDesignText@
#IgnoreWarnings:12
'Created with BANano Custom View Creator 1.00 by TheMash
'https://github.com/Mashiane/BANano-Custom-View-Creator
'Custom BANano View class
#DesignerProperty: Key: ChartType, DisplayName: ChartType, FieldType: String, DefaultValue: line-chart, Description: ChartType, List: area-chart|bubble-chart|bar-chart|column-chart|line-chart|pie-chart|scatter-chart|geo-chart
#DesignerProperty: Key: TitleText, DisplayName: TitleText, FieldType: String, DefaultValue: Chart, Description: TitleText
#DesignerProperty: Key: TitleDisplay, DisplayName: TitleDisplay, FieldType: Boolean, DefaultValue: True, Description: TitleDisplay
#DesignerProperty: Key: TitlePosition, DisplayName: TitlePosition, FieldType: String, DefaultValue: top, Description: TitlePosition, List: top|left|bottom|right
#DesignerProperty: Key: Xtitle, DisplayName: Xtitle, FieldType: String, DefaultValue: Categories, Description: Xtitle
#DesignerProperty: Key: Ytitle, DisplayName: Ytitle, FieldType: String, DefaultValue: Values, Description: Ytitle
#DesignerProperty: Key: Hidden, DisplayName: Hidden, FieldType: Boolean, DefaultValue: False, Description: Hidden
#DesignerProperty: Key: Bytes, DisplayName: Bytes, FieldType: Boolean, DefaultValue: False, Description: Bytes
#DesignerProperty: Key: Curve, DisplayName: Curve, FieldType: Boolean, DefaultValue: False, Description: Curve
#DesignerProperty: Key: Decimal, DisplayName: Decimal, FieldType: String, DefaultValue: . , Description: Decimal
#DesignerProperty: Key: Thousands, DisplayName: Thousands, FieldType: String, DefaultValue: ,, Description: Thousands
#DesignerProperty: Key: UseColors, DisplayName: Use Own Colors, FieldType: Boolean, DefaultValue: False, Description: Use Own Colors
#DesignerProperty: Key: DifferentColors, DisplayName: DifferentColors, FieldType: Boolean, DefaultValue: False, Description: DifferentColors
#DesignerProperty: Key: DifferentColorsCurveSeries, DisplayName: DifferentColorsCurveSeries, FieldType: Boolean, DefaultValue: False, Description: DifferentColorsCurveSeries
#DesignerProperty: Key: Discrete, DisplayName: Discrete, FieldType: Boolean, DefaultValue: False, Description: Discrete
#DesignerProperty: Key: Donut, DisplayName: Donut, FieldType: Boolean, DefaultValue: False, Description: Donut
#DesignerProperty: Key: Download, DisplayName: Download, FieldType: Boolean, DefaultValue: False, Description: Download
#DesignerProperty: Key: Height, DisplayName: Height, FieldType: String, DefaultValue: 500px, Description: Height
#DesignerProperty: Key: Width, DisplayName: Width, FieldType: String, DefaultValue: 100%, Description: Width
#DesignerProperty: Key: Label, DisplayName: Label, FieldType: String, DefaultValue: , Description: Label
#DesignerProperty: Key: Legend, DisplayName: Legend Position, FieldType: String, DefaultValue: bottom, Description: Legend Position, List: none|bottom|left|right|top
#DesignerProperty: Key: Max, DisplayName: Max, FieldType: String, DefaultValue: , Description: Max
#DesignerProperty: Key: Min, DisplayName: Min, FieldType: String, DefaultValue: , Description: Min
#DesignerProperty: Key: Precision, DisplayName: Precision, FieldType: String, DefaultValue: , Description: Precision
#DesignerProperty: Key: Prefix, DisplayName: Prefix, FieldType: String, DefaultValue: , Description: Prefix
#DesignerProperty: Key: Refresh, DisplayName: Refresh, FieldType: String, DefaultValue: , Description: Refresh
#DesignerProperty: Key: Round, DisplayName: Round, FieldType: String, DefaultValue: , Description: Round
#DesignerProperty: Key: Stacked, DisplayName: Stacked, FieldType: Boolean, DefaultValue: False, Description: Stacked
#DesignerProperty: Key: Suffix, DisplayName: Suffix, FieldType: String, DefaultValue: , Description: Suffix
#DesignerProperty: Key: XAxisDisplay, DisplayName: XAxisDisplay, FieldType: Boolean, DefaultValue: True, Description: XAxisDisplay
#DesignerProperty: Key: XAxisGridCircular, DisplayName: XAxisGridCircular, FieldType: Boolean, DefaultValue: False, Description: XAxisGridCircular
#DesignerProperty: Key: XAxisGridDisplay, DisplayName: XAxisGridDisplay, FieldType: Boolean, DefaultValue: True, Description: XAxisGridDisplay
#DesignerProperty: Key: XAxisGridDrawBorder, DisplayName: XAxisGridDrawBorder, FieldType: Boolean, DefaultValue: True, Description: XAxisGridDrawBorder
#DesignerProperty: Key: XAxisGridDrawOnChartArea, DisplayName: XAxisGridDrawOnChartArea, FieldType: Boolean, DefaultValue: True, Description: XAxisGridDrawOnChartArea
#DesignerProperty: Key: XAxisGridDrawTicks, DisplayName: XAxisGridDrawTicks, FieldType: Boolean, DefaultValue: True, Description: XAxisGridDrawTicks
#DesignerProperty: Key: XAxisGridLineWidth, DisplayName: XAxisGridLineWidth, FieldType: String, DefaultValue: 1, Description: XAxisGridLineWidth
#DesignerProperty: Key: XAxisGridOffsetGridLines, DisplayName: XAxisGridOffsetGridLines, FieldType: Boolean, DefaultValue: False, Description: XAxisGridOffsetGridLines
#DesignerProperty: Key: XAxisTickMarkLength, DisplayName: XAxisTickMarkLength, FieldType: String, DefaultValue: 10, Description: XAxisTickMarkLength
#DesignerProperty: Key: XAxisGridZeroLineWidth, DisplayName: XAxisGridZeroLineWidth, FieldType: String, DefaultValue: 1, Description: XAxisZeroLineWidth
#DesignerProperty: Key: XTicksAutoSkip, DisplayName: XTicksAutoSkip, FieldType: Boolean, DefaultValue: False, Description: XTicksAutoSkip
#DesignerProperty: Key: XTicksBeginAtZero, DisplayName: XTicksBeginAtZero, FieldType: Boolean, DefaultValue: False, Description: XTicksBeginAtZero
#DesignerProperty: Key: XTicksMaxRotation, DisplayName: XTicksMaxRotation, FieldType: String, DefaultValue: , Description: XTicksMaxRotation
#DesignerProperty: Key: XTicksMaxValue, DisplayName: XTicksMaxValue, FieldType: String, DefaultValue: , Description: XTicksMaxValue
#DesignerProperty: Key: XTicksMinRotation, DisplayName: XTicksMinRotation, FieldType: String, DefaultValue: , Description: XTicksMinRotation
#DesignerProperty: Key: XTicksMinValue, DisplayName: XTicksMinValue, FieldType: String, DefaultValue: , Description: XTicksMinValue
#DesignerProperty: Key: XTicksStepSize, DisplayName: XTicksStepSize, FieldType: String, DefaultValue: , Description: XTicksStepSize
#DesignerProperty: Key: Xmax, DisplayName: Xmax, FieldType: String, DefaultValue: , Description: Xmax
#DesignerProperty: Key: Xmin, DisplayName: XMin, FieldType: String, DefaultValue: , Description: XMin
#DesignerProperty: Key: YAxisDisplay, DisplayName: YAxisDisplay, FieldType: Boolean, DefaultValue: True, Description: YAxisDisplay
#DesignerProperty: Key: YAxisGridCircular, DisplayName: YAxisGridCircular, FieldType: Boolean, DefaultValue: False, Description: YAxisGridCircular
#DesignerProperty: Key: YAxisGridDisplay, DisplayName: YAxisGridDisplay, FieldType: Boolean, DefaultValue: True, Description: YAxisGridDisplay
#DesignerProperty: Key: YAxisGridDrawBorder, DisplayName: YAxisGridDrawBorder, FieldType: Boolean, DefaultValue: True, Description: YAxisGridDrawBorder
#DesignerProperty: Key: YAxisGridDrawOnChartArea, DisplayName: YAxisGridDrawOnChartArea, FieldType: Boolean, DefaultValue: True, Description: YAxisGridDrawOnChartArea
#DesignerProperty: Key: YAxisGridDrawTicks, DisplayName: YAxisGridDrawTicks, FieldType: Boolean, DefaultValue: True, Description: YAxisGridDrawTicks
#DesignerProperty: Key: YAxisGridLineWidth, DisplayName: YAxisGridLineWidth, FieldType: String, DefaultValue: 1, Description: YAxisGridLineWidth
#DesignerProperty: Key: YAxisGridOffsetGridLines, DisplayName: YAxisGridOffsetGridLines, FieldType: Boolean, DefaultValue: False, Description: YAxisGridOffsetGridLines
#DesignerProperty: Key: YAxisGridTickMarkLength, DisplayName: YAxisGridTickMarkLength, FieldType: String, DefaultValue: 10, Description: YAxisGridTickMarkLength
#DesignerProperty: Key: YAxisGridZeroLineWidth, DisplayName: YAxisGridZeroLineWidth, FieldType: String, DefaultValue: 1, Description: YAxisGridZeroLineWidth
#DesignerProperty: Key: YTicksAutoSkip, DisplayName: YTicksAutoSkip, FieldType: Boolean, DefaultValue: False, Description: YTicksAutoSkip
#DesignerProperty: Key: YTicksBeginAtZero, DisplayName: YTicksBeginAtZero, FieldType: Boolean, DefaultValue: False, Description: YTicksBeginAtZero
#DesignerProperty: Key: YTicksMaxRotation, DisplayName: YTicksMaxRotation, FieldType: String, DefaultValue: , Description: YTicksMaxRotation
#DesignerProperty: Key: YTicksMaxValue, DisplayName: YTicksMaxValue, FieldType: String, DefaultValue: , Description: YTicksMaxValue
#DesignerProperty: Key: YTicksMinRotation, DisplayName: YTicksMinRotation, FieldType: String, DefaultValue: , Description: YTicksMinRotation
#DesignerProperty: Key: YTicksMinValue, DisplayName: YTicksMinValue, FieldType: String, DefaultValue: , Description: YTicksMinValue
#DesignerProperty: Key: YTicksStepSize, DisplayName: YTicksStepSize, FieldType: String, DefaultValue: , Description: YTicksStepSize
#DesignerProperty: Key: Zeros, DisplayName: Zeros, FieldType: Boolean, DefaultValue: False, Description: Zeros
#DesignerProperty: Key: Classes, DisplayName: Classes, FieldType: String, DefaultValue: , Description: Classes added to the HTML tag. 
#DesignerProperty: Key: Styles, DisplayName: Styles, FieldType: String, DefaultValue: , Description: Styles added to the HTML tag. Must be a json String, use = 
#DesignerProperty: Key: Attributes, DisplayName: Attributes, FieldType: String, DefaultValue: , Description: Attributes added to the HTML tag. Must be a json String, use =

Sub Class_Globals 
    Private BANano As BANano 'ignore 
	Private mName As String 'ignore 
	Private mEventName As String 'ignore 
	Private mCallBack As Object 'ignore 
	Private mTarget As BANanoElement 'ignore 
	Private mElement As BANanoElement 'ignore 
	Private mClasses As String = "" 
	Private mStyles As String = "" 
	Private mAttributes As String = "" 
	Public VElement As VueElement 
	Private bHidden As Boolean
	Private ColorMap As Map
	Private bBytes As Boolean
		Private sChartType As String
		Private sColors As String
		Private bCurve As Boolean
		Private sData As String
		Private sDecimal As String
		Private bDifferentColors As Boolean
		Private bDifferentColorsCurveSeries As Boolean
		Private bDiscrete As Boolean
		Private bDonut As Boolean
		Private bDownload As Boolean
		Private sHeight As String
		Private sLabel As String
		Private sLegend As String
		Private sMax As String
		Private sMin As String
		Private sPrecision As String
		Private sPrefix As String
		Private sRefresh As String
		Private sRound As String
		Private bStacked As Boolean
		Private sSuffix As String
		Private sThousands As String
		Private bTitleDisplay As Boolean
		Private sTitlePosition As String
		Private sTitleText As String
		Private sWidth As String
		Private bXAxisDisplay As Boolean
		Private bXAxisGridCircular As Boolean
		Private bXAxisGridDisplay As Boolean
		Private bXAxisGridDrawBorder As Boolean
		Private bXAxisGridDrawOnChartArea As Boolean
		Private bXAxisGridDrawTicks As Boolean
		Private sXAxisGridLineWidth As String
		Private bXAxisGridOffsetGridLines As Boolean
		Private sXAxisTickMarkLength As String
		Private sXAxisGridZeroLineWidth As String
		Private bXTicksAutoSkip As Boolean
		Private bXTicksBeginAtZero As Boolean
		Private sXTicksMaxRotation As String
		Private sXTicksMaxValue As String
		Private sXTicksMinRotation As String
		Private sXTicksMinValue As String
		Private sXTicksStepSize As String
		Private sXmax As String
		Private sXmin As String
		Private sXtitle As String
		Private bYAxisDisplay As Boolean
		Private bYAxisGridCircular As Boolean
		Private bYAxisGridDisplay As Boolean
		Private bYAxisGridDrawBorder As Boolean
		Private bYAxisGridDrawOnChartArea As Boolean
		Private bYAxisGridDrawTicks As Boolean
		Private sYAxisGridLineWidth As String
		Private bYAxisGridOffsetGridLines As Boolean
		Private sYAxisGridTickMarkLength As String
		Private sYAxisGridZeroLineWidth As String
		Private bYTicksAutoSkip As Boolean
		Private bYTicksBeginAtZero As Boolean
		Private sYTicksMaxRotation As String
		Private sYTicksMaxValue As String
		Private sYTicksMinRotation As String
		Private sYTicksMinValue As String
		Private sYTicksStepSize As String
		Private sYtitle As String
		Private bZeros As Boolean 
		Private sVShow As String
		Private bUseColors As Boolean
		'
		Private series As Map
		Private data As Map
		Private colors As List
		Private coptions As String
		Type grdLine(display As Boolean, circular As Boolean,lineWidth As Int, drawBorder As Boolean, drawOnChartArea As Boolean, _
		drawTicks As Boolean, tickMarkLength As Int, zeroLineWidth As Int, offsetGridLines As Boolean)
		
		Type ticksType(autoSkip As Boolean, maxRotation As Int, minRotation As Int, MinValue As Int, MaxValue As Int, stepSize As Int, _
		beginAtZero As Boolean)
		
		Type xAxesType(display As Boolean, ticks As ticksType, gridLines As grdLine)
		
		Public xAxes As xAxesType
		Public yAxes As xAxesType
		Public OverwriteOptions As Boolean
		Type titleType(display As Boolean, text As String, position As String)
		Public Title As titleType
End Sub

Sub Initialize (CallBack As Object, Name As String, EventName As String) 
	mName = Name.tolowercase 
	mEventName = EventName.ToLowerCase 
	mCallBack = CallBack	 
	mName = mName.Replace("#","") 
	mEventName = mEventName.Replace("#","") 
	If mName <> "" Then 
		Dim fKey As String = $"#${mName}"$ 
		If BANano.Exists(fKey) Then  
			mElement = BANano.GetElement(fKey) 
		End If 
	End If
	sData = $"${mName}data"$
	sColors = $"${mName}colors"$ 
	sVShow = $"${mName}show"$
	coptions = $"${mName}options"$
	OverwriteOptions = False
	InitColors
End Sub

Sub DesignerCreateView (Target As BANanoElement, Props As Map) 
	mTarget = Target 
	If Props <> Null Then 
		bHidden = Props.GetDefault("Hidden", False)
		mClasses = Props.GetDefault("Classes", "") 
		mStyles = Props.GetDefault("Styles", "") 
		mAttributes = Props.GetDefault("Attributes","") 
		bBytes = Props.GetDefault("Bytes", False)
		sChartType = Props.GetDefault("ChartType", "")
		bCurve = Props.GetDefault("Curve", False)
		sDecimal = Props.GetDefault("Decimal", "")
		bDifferentColors = Props.GetDefault("DifferentColors", False)
		bDifferentColorsCurveSeries = Props.GetDefault("DifferentColorsCurveSeries", False)
		bDiscrete = Props.GetDefault("Discrete", False)
		bDonut = Props.GetDefault("Donut", False)
		bDownload = Props.GetDefault("Download", False)
		sHeight = Props.GetDefault("Height", "")
		sLabel = Props.GetDefault("Label", "")
		sLegend = Props.GetDefault("Legend", "bottom")
		sMax = Props.GetDefault("Max", "")
		sMin = Props.GetDefault("Min", "")
		sPrecision = Props.GetDefault("Precision", "")
		sPrefix = Props.GetDefault("Prefix", "")
		sRefresh = Props.GetDefault("Refresh", "")
		sRound = Props.GetDefault("Round", "")
		bStacked = Props.GetDefault("Stacked", False)
		sSuffix = Props.GetDefault("Suffix", "")
		sThousands = Props.GetDefault("Thousands", "")
		bTitleDisplay = Props.GetDefault("TitleDisplay", False)
		sTitlePosition = Props.GetDefault("TitlePosition", "")
		sTitleText = Props.GetDefault("TitleText", "")
		sWidth = Props.GetDefault("Width", "")
		bXAxisDisplay = Props.GetDefault("XAxisDisplay", False)
		bXAxisGridCircular = Props.GetDefault("XAxisGridCircular", False)
		bXAxisGridDisplay = Props.GetDefault("XAxisGridDisplay", False)
		bXAxisGridDrawBorder = Props.GetDefault("XAxisGridDrawBorder", False)
		bXAxisGridDrawOnChartArea = Props.GetDefault("XAxisGridDrawOnChartArea", False)
		bXAxisGridDrawTicks = Props.GetDefault("XAxisGridDrawTicks", False)
		sXAxisGridLineWidth = Props.GetDefault("XAxisGridLineWidth", "")
		bXAxisGridOffsetGridLines = Props.GetDefault("XAxisGridOffsetGridLines", False)
		sXAxisTickMarkLength = Props.GetDefault("XAxisTickMarkLength", "")
		sXAxisGridZeroLineWidth = Props.GetDefault("XAxisGridZeroLineWidth", "")
		bXTicksAutoSkip = Props.GetDefault("XTicksAutoSkip", False)
		bXTicksBeginAtZero = Props.GetDefault("XTicksBeginAtZero", False)
		sXTicksMaxRotation = Props.GetDefault("XTicksMaxRotation", "")
		sXTicksMaxValue = Props.GetDefault("XTicksMaxValue", "")
		sXTicksMinRotation = Props.GetDefault("XTicksMinRotation", "")
		sXTicksMinValue = Props.GetDefault("XTicksMinValue", "")
		sXTicksStepSize = Props.GetDefault("XTicksStepSize", "")
		sXmax = Props.GetDefault("Xmax", "")
		sXmin = Props.GetDefault("Xmin", "")
		sXtitle = Props.GetDefault("Xtitle", "")
		bYAxisDisplay = Props.GetDefault("YAxisDisplay", False)
		bYAxisGridCircular = Props.GetDefault("YAxisGridCircular", False)
		bYAxisGridDisplay = Props.GetDefault("YAxisGridDisplay", False)
		bYAxisGridDrawBorder = Props.GetDefault("YAxisGridDrawBorder", False)
		bYAxisGridDrawOnChartArea = Props.GetDefault("YAxisGridDrawOnChartArea", False)
		bYAxisGridDrawTicks = Props.GetDefault("YAxisGridDrawTicks", False)
		sYAxisGridLineWidth = Props.GetDefault("YAxisGridLineWidth", "")
		bYAxisGridOffsetGridLines = Props.GetDefault("YAxisGridOffsetGridLines", False)
		sYAxisGridTickMarkLength = Props.GetDefault("YAxisGridTickMarkLength", "")
		sYAxisGridZeroLineWidth = Props.GetDefault("YAxisGridZeroLineWidth", "")
		bYTicksAutoSkip = Props.GetDefault("YTicksAutoSkip", False)
		bYTicksBeginAtZero = Props.GetDefault("YTicksBeginAtZero", False)
		sYTicksMaxRotation = Props.GetDefault("YTicksMaxRotation", "")
		sYTicksMaxValue = Props.GetDefault("YTicksMaxValue", "")
		sYTicksMinRotation = Props.GetDefault("YTicksMinRotation", "")
		sYTicksMinValue = Props.GetDefault("YTicksMinValue", "")
		sYTicksStepSize = Props.GetDefault("YTicksStepSize", "")
		sYtitle = Props.GetDefault("Ytitle", "")
		bZeros = Props.GetDefault("Zeros", False) 
		bUseColors = Props.GetDefault("UseColors", False)
	End If 
	' 
	'build and get the element 
	If BANano.Exists($"#${mName}"$) Then 
		mElement = BANano.GetElement($"#${mName}"$) 
	Else	 
		mElement = mTarget.Append($"<${sChartType} id="${mName}"></${sChartType}>"$).Get("#" & mName) 
	End If 
	'
	VElement.Initialize(mCallBack, mName, mName) 
	VElement.TagName = sChartType 
	VElement.Classes = mClasses 
	VElement.Styles = mStyles 
	VElement.Attributes = mAttributes 
	VElement.AddAttr(":bytes", bBytes)
	VElement.AddAttr(":curve", bCurve)
	VElement.AddAttr(":data", sData)
	VElement.SetData(sData, VElement.NewList)
	If bUseColors Then
		VElement.AddAttr(":colors", sColors)
		VElement.SetData(sColors, VElement.NewList)
	End If
	VElement.AddAttr("decimal", sDecimal)
	VElement.AddAttr(":discrete", bDiscrete)
	VElement.AddAttr(":donut", bDonut)
	VElement.AddAttr("label", sLabel)
	VElement.AddAttr("legend", sLegend)
	VElement.AddAttr("max", sMax)
	VElement.AddAttr("min", sMin)
	VElement.AddAttr("precision", sPrecision)
	VElement.AddAttr("prefix", sPrefix)
	VElement.AddAttr("refresh", sRefresh)
	VElement.AddAttr(":round", sRound)
	VElement.AddAttr(":stacked", bStacked)
	VElement.AddAttr("suffix", sSuffix)
	VElement.AddAttr("thousands", sThousands)
	VElement.AddStyle("width", sWidth)
	VElement.AddStyle("height", sHeight)
	VElement.AddAttr("xmax", sXmax)
	VElement.AddAttr("xmin", sXmin)
	VElement.AddAttr("xtitle", sXtitle)
	VElement.AddAttr("ytitle", sYtitle)
	VElement.AddAttr("zeros", bZeros)
	VElement.AddAttr("v-show", sVShow)
	VElement.SetData(sVShow, Not(bHidden))
	VElement.AddAttr(":library", coptions)
	VElement.BindAllEvents
	
	SetDownload
	Reset 
End Sub

private Sub SetDownload
	Dim obj As Map = CreateMap()
	obj.Put("background", "#fff")
	Dim objJSON As String = BANano.ToJson(obj)
	objJSON = objJSON.Replace(QUOTE,"'")
	VElement.AddAttr(":download", objJSON)
End Sub

Sub Clear(VC As VueComponent)
	VC.SetData(sData, VC.NewList)
	VC.SetData(sColors, VC.NewList)
End Sub

Sub Refresh(VC As VueComponent)
	Update
	BuildOptions
	If series.Size > 0 Then
		Dim seriesList As List
		seriesList.Initialize 
		For Each k As String In series.Keys
			Dim obj As Map = series.Get(k)
			seriesList.Add(obj)
		Next
		VC.SetData(sData, seriesList)
	Else
		Dim plotList As List = data.Get("a")
		VC.SetData(sData, plotList)
	End If
	If colors.Size > 0 Then
		VC.SetData(sColors, colors)
	End If
End Sub


private Sub Update
	Title.display = bTitleDisplay
	Title.position = sTitlePosition
	Title.text = sTitleText
	'
	xAxes.display = bXAxisDisplay
	xAxes.ticks.autoSkip = bXTicksAutoSkip
	xAxes.ticks.maxRotation = sXTicksMaxRotation
	xAxes.ticks.minRotation = sXTicksMinRotation
	xAxes.ticks.MinValue = sXTicksMinValue
	xAxes.ticks.MaxValue = sXTicksMaxValue
	xAxes.ticks.stepSize = sXTicksStepSize
	xAxes.ticks.beginAtZero = bXTicksBeginAtZero
	'
	xAxes.gridLines.display = bXAxisGridDisplay
	xAxes.gridLines.circular = bXAxisGridCircular
	xAxes.gridLines.lineWidth = sXAxisGridLineWidth
	xAxes.gridLines.drawBorder = bXAxisGridDrawBorder
	xAxes.gridLines.drawOnChartArea = bXAxisGridDrawOnChartArea
	xAxes.gridLines.drawTicks = bXAxisGridDrawTicks
	xAxes.gridLines.tickMarkLength = sXAxisTickMarkLength
	xAxes.gridLines.zeroLineWidth = sXAxisGridZeroLineWidth
	xAxes.gridLines.offsetGridLines = bXAxisGridOffsetGridLines
	'
	yAxes.display = bYAxisDisplay
	yAxes.ticks.autoSkip = bYTicksAutoSkip
	yAxes.ticks.maxRotation = sYTicksMaxRotation
	yAxes.ticks.minRotation = sYTicksMinRotation
	yAxes.ticks.MinValue = sYTicksMinValue
	yAxes.ticks.MaxValue = sYTicksMaxValue
	yAxes.ticks.stepSize = sYTicksStepSize
	yAxes.ticks.beginAtZero = bYTicksBeginAtZero
	yAxes.gridLines.display = bYAxisGridDisplay
	yAxes.gridLines.circular = bYAxisGridCircular
	yAxes.gridLines.lineWidth = sYAxisGridLineWidth
	yAxes.gridLines.drawBorder = bYAxisGridDrawBorder
	yAxes.gridLines.drawOnChartArea = bYAxisGridDrawOnChartArea
	yAxes.gridLines.drawTicks = bYAxisGridDrawTicks
	yAxes.gridLines.tickMarkLength = sYAxisGridTickMarkLength
	yAxes.gridLines.zeroLineWidth = sYAxisGridZeroLineWidth
	yAxes.gridLines.offsetGridLines = bYAxisGridOffsetGridLines	
End Sub


public Sub AddToParent(targetID As String) 
	mTarget = BANano.GetElement("#" & targetID.ToLowerCase) 
	DesignerCreateView(mTarget, Null) 
End Sub

public Sub Remove() 
	mTarget.Empty 
	BANano.SetMeToNull 
End Sub

Sub AddClass(s As String) 
	VElement.AddClass(s) 
End Sub

Sub AddAttr(p As String, v As Object) 
	VElement.SetAttr(p, v) 
End Sub

Sub AddStyle(p As String, v As String) 
	VElement.AddStyle(p, v) 
End Sub

Sub RemoveAttr(p As String) 
	VElement.RemoveAttr(p) 
End Sub

Sub UpdateVisible(VC As VueComponent, b As Boolean) 
	VC.SetData(sVShow, b) 
End Sub

Sub getID As String 
	Return mName 
End Sub

Sub getHere As String 
	Return $"#${mName}"$ 
End Sub

'reset the chart
private Sub Reset
	series.Initialize
	data.Initialize
	colors.Initialize
	'
	Title.Initialize 
	
	Dim sl As List
	sl.Initialize
	data.Put("a",sl)
	xAxes.Initialize
	xAxes.ticks.Initialize
	xAxes.gridLines.Initialize
	xAxes.display = True
	xAxes.ticks.autoSkip = Null
	xAxes.ticks.maxRotation = Null
	xAxes.ticks.minRotation = Null
	xAxes.ticks.MinValue = Null
	xAxes.ticks.MaxValue = Null
	xAxes.ticks.stepSize = Null
	xAxes.ticks.beginAtZero = Null
	'
	xAxes.gridLines.display = True
	xAxes.gridLines.circular = False
	xAxes.gridLines.lineWidth = 1
	xAxes.gridLines.drawBorder = True
	xAxes.gridLines.drawOnChartArea = True
	xAxes.gridLines.drawTicks = True
	xAxes.gridLines.tickMarkLength = 10
	xAxes.gridLines.zeroLineWidth = 1
	xAxes.gridLines.offsetGridLines = False
	'
	yAxes.Initialize
	yAxes.ticks.Initialize
	yAxes.gridLines.Initialize
	yAxes.display = True
	yAxes.ticks.autoSkip = Null
	yAxes.ticks.maxRotation = Null
	yAxes.ticks.minRotation = Null
	yAxes.ticks.MinValue = Null
	yAxes.ticks.MaxValue = Null
	yAxes.ticks.stepSize = Null
	yAxes.ticks.beginAtZero = Null
	yAxes.gridLines.display = True
	yAxes.gridLines.circular = False
	yAxes.gridLines.lineWidth = 1
	yAxes.gridLines.drawBorder = True
	yAxes.gridLines.drawOnChartArea = True
	yAxes.gridLines.drawTicks = True
	yAxes.gridLines.tickMarkLength = 10
	yAxes.gridLines.zeroLineWidth = 1
	yAxes.gridLines.offsetGridLines = False	
End Sub


private Sub BuildOptions
	Dim chartOptions As Map = CreateMap()
	Dim scales As Map = CreateMap()
	'x axis
	Dim xList As List
	Dim xticks As Map = CreateMap()
	Dim xsis As Map = CreateMap()
	Dim xgrid As Map = CreateMap()
	'
	xList.Initialize
	If xAxes.ticks.autoSkip <> Null Then xticks.Put("autoSkip", xAxes.ticks.autoSkip) 
	If xAxes.ticks.maxRotation <> Null Then xticks.Put("maxRotation", xAxes.ticks.maxRotation) 
	If xAxes.ticks.minRotation <> Null Then xticks.Put("minRotation", xAxes.ticks.minRotation)
	If xAxes.ticks.MinValue <> Null Then xticks.Put("min", xAxes.ticks.MinValue)
	If xAxes.ticks.MaxValue <> Null Then xticks.Put("max", xAxes.ticks.MaxValue)
	If xAxes.ticks.stepSize <> Null Then xticks.Put("stepSize", xAxes.ticks.stepSize)
	If xAxes.ticks.beginAtZero <> Null Then xticks.Put("beginAtZero", xAxes.ticks.beginAtZero)
	'
	xgrid.Put("display", xAxes.gridLines.display)
	xgrid.Put("circular",xAxes.gridLines.circular)
	xgrid.Put("lineWidth",xAxes.gridLines.lineWidth)
	xgrid.Put("drawBorder",xAxes.gridLines.drawBorder)
	xgrid.Put("drawOnChartArea",xAxes.gridLines.drawOnChartArea)
	xgrid.Put("drawTicks",xAxes.gridLines.drawTicks)
	xgrid.Put("tickMarkLength",xAxes.gridLines.tickMarkLength)
	xgrid.Put("zeroLineWidth",xAxes.gridLines.zeroLineWidth)
	xgrid.Put("offsetGridLines",xAxes.gridLines.offsetGridLines)
	
	'
	xsis.Put("display", xAxes.display)
	If xticks.Size > 0 Then xsis.Put("ticks", xticks)
	If xgrid.Size > 0 Then xsis.Put("gridLines", xgrid)
	xList.Add(xsis)
	scales.Put("xAxes", xList)
	'y axes
	Dim yList As List
	Dim ysis As Map = CreateMap()
	Dim yticks As Map = CreateMap()
	Dim ygrid As Map = CreateMap()
	'
	yList.Initialize
	If yAxes.ticks.autoSkip <> Null Then yticks.Put("autoSkip", yAxes.ticks.autoSkip)
	If yAxes.ticks.maxRotation <> Null Then yticks.Put("maxRotation", yAxes.ticks.maxRotation)
	If yAxes.ticks.minRotation <> Null Then yticks.Put("minRotation", yAxes.ticks.minRotation)
	If yAxes.ticks.MinValue <> Null Then yticks.Put("min", yAxes.ticks.MinValue)
	If yAxes.ticks.MaxValue <> Null Then yticks.Put("max", yAxes.ticks.MaxValue)
	If yAxes.ticks.stepSize <> Null Then yticks.Put("stepSize", yAxes.ticks.stepSize)
	If yAxes.ticks.beginAtZero <> Null Then yticks.Put("beginAtZero", yAxes.ticks.beginAtZero)
	'
	ygrid.Put("display", yAxes.gridLines.display)
	ygrid.Put("circular",yAxes.gridLines.circular)
	ygrid.Put("lineWidth",yAxes.gridLines.lineWidth)
	ygrid.Put("drawBorder",yAxes.gridLines.drawBorder)
	ygrid.Put("drawOnChartArea",yAxes.gridLines.drawOnChartArea)
	ygrid.Put("drawTicks",yAxes.gridLines.drawTicks)
	ygrid.Put("tickMarkLength",yAxes.gridLines.tickMarkLength)
	ygrid.Put("zeroLineWidth",yAxes.gridLines.zeroLineWidth)
	ygrid.Put("offsetGridLines",yAxes.gridLines.offsetGridLines)
	'	
	ysis.Put("display", yAxes.display)
	If yticks.Size > 0 Then ysis.Put("ticks", yticks)
	If ygrid.Size > 0 Then ysis.Put("gridLines", ygrid)
	yList.Add(ysis)
	scales.Put("yAxes", yList)
	'
	If OverwriteOptions = True Then 
		chartOptions.Put("scales", scales)
	End If
	'
	Dim titObj As Map = CreateMap()
	titObj.Put("display", Title.display)
	titObj.Put("text", Title.text)
	chartOptions.Put("title", titObj)
	'
'	If bDifferentColors Then
'		SetDifferentColors(bDifferentColorsCurveSeries)
'	End If
	
	'If colors.Size > 0 Then 
	'	chartOptions.Put("colors", colors)
	'End If
	'chartOptions.Put("curve", bCurve)
	VElement.SetData(coptions, chartOptions)
End Sub

'add a new series, the list will store the data
Sub AddSeries(seriesCaption As String, seriesColor As String, seriesCurve As Boolean, seriesData As Map)
	Dim obj As Map = CreateMap()
	obj.Put("name", seriesCaption)
	obj.Put("data", seriesData)
	obj.Put("curve", seriesCurve)
	obj.Put("label", seriesCaption)
	If seriesColor <> "" Then
		Dim xColor As String = GetColorHex(seriesColor)
		obj.Put("color", xColor)
		colors.Add(xColor)
	End If
	series.Put(seriesCaption, obj)
End Sub

Sub UpdateSeriesData(seriesCaption As String, X As String, Y As String)
	If series.ContainsKey(seriesCaption) Then
		Dim m As Map = series.Get(seriesCaption)
		Dim mdata As Map = m.Get("data")
		mdata.Put(X, Y)
		m.Put("data", mdata)
		series.Put(seriesCaption, m)
	End If	
End Sub

'add xy values to a chart
Sub AddXY(X As String, y As String)
	'get the list of records
	Dim exdata As List = data.Get("a")
	Dim cudata As List
	cudata.Initialize
	cudata.Add(X)
	cudata.Add(y)
	exdata.Add(cudata)
	data.Put("a",exdata)
End Sub

'add xy with a color
Sub AddXYColor(X As String, y As String, color As String)
	'get the list of records
	Dim exdata As List = data.Get("a")
	Dim cudata As List
	cudata.Initialize
	cudata.Add(X)
	cudata.Add(y)
	exdata.Add(cudata)
	data.Put("a",exdata)
	If color <> "" Then
		Dim xColor As String = GetColorHex(color)
		Dim mc As List
		mc.Initialize 
		mc.Add(xColor)
		colors.Add(mc)
	End If
End Sub

private Sub SetDifferentColors(seriesCurve As Boolean)
	Dim exdata As List = data.Get("a")
	colors.Initialize 
	Dim tItems As Int = exdata.Size - 1
	Dim cItems As Int
	For cItems = 0 To tItems
		Dim cColor As String = ColorMap.GetValueAt(cItems)
		colors.Add(cColor)
	Next
	
	'old way
	'series.Initialize 
'	Dim colCnt As Int = 0
'	For Each cudata As List In exdata
'		If cudata.Size = 2 Then
'			Dim c As String = ""
'			Dim x As String = cudata.get(0)
'			Dim y As String = cudata.get(1)
'			If colors.size > 0 Then
'				c = colors.get(colCnt)
'			End If
'			Dim xd As Map = CreateMap()
'			xd.put(x, y)
'			AddSeries(x, c, seriesCurve, xd)
'		End If
'		colCnt = colCnt + 1
'	Next
'	colors.initialize
End Sub

'add xy map
Sub AddXYMap(values As Map)
	For Each strKey As String In values.Keys
		Dim strVal As String = values.Get(strKey)
		AddXY(strKey,strVal)
	Next
End Sub

'add a bubble
Sub AddBubble(X As String, y As String, size As String)
	'get the list of records
	Dim exdata As List = data.Get("a")
	Dim cudata As List
	cudata.Initialize
	cudata.Add(X)
	cudata.Add(y)
	cudata.Add(size)
	exdata.Add(cudata)
	data.Put("a",exdata)
End Sub


'get a hex color from provided colors
private Sub GetColorHex(sColor As String) As String
	sColor = sColor.tolowercase
	If ColorMap.ContainsKey(sColor) Then
		Dim xColor As String = ColorMap.Get(sColor)
		Return xColor
	Else
		Return sColor
	End If
End Sub


private Sub InitColors
	ColorMap.Initialize
	ColorMap.put("red", "#f44336")
	ColorMap.put("pink", "#e91e63")
	ColorMap.put("purple", "#9c27b0")
	ColorMap.put("deep-purple", "#673ab7")
	ColorMap.put("indigo", "#3f51b5")
	ColorMap.put("blue", "#2196f3")
	ColorMap.put("light-blue", "#03a9f4")
	ColorMap.put("cyan", "#00bcd4")
	ColorMap.put("teal", "#009688")
	ColorMap.put("green", "#4caf50")
	ColorMap.put("light-green", "#8bc34a")
	ColorMap.put("lime", "#cddc39")
	ColorMap.put("yellow", "#ffeb3b")
	ColorMap.put("amber", "#ffc107")
	ColorMap.put("orange", "#ff9800")
	ColorMap.put("deep-orange", "#ff5722")
	ColorMap.put("brown", "#795548")
	ColorMap.put("grey", "#9e9e9e")
	ColorMap.put("blue-grey", "#607d8b")
	ColorMap.put("black", "#000000")
End Sub