B4J=true
Group=Default Group
ModulesStructureVersion=1
Type=Class
Version=8.95
@EndOfDesignText@
#IgnoreWarnings:12

#Event: Click (item As Map)
#Event: RightClick (item As Map)
#Event: LeftClick (item As Map)

#DesignerProperty: Key: Hidden, DisplayName: Hidden, FieldType: Boolean, DefaultValue: False, Description: Hidden
#DesignerProperty: Key: PlaceAtBottom, DisplayName: PlaceAtBottom, FieldType: Boolean, DefaultValue: False, Description: PlaceAtBottom
#DesignerProperty: Key: TwoLine, DisplayName: TwoLine, FieldType: Boolean, DefaultValue: false, Description: TwoLine
#DesignerProperty: Key: ThreeLine, DisplayName: ThreeLine, FieldType: Boolean, DefaultValue: false, Description: ThreeLine
#DesignerProperty: Key: Color, DisplayName: Color, FieldType: String, DefaultValue: , Description: Color, List: amber|black|blue|blue-grey|brown|cyan|deep-orange|deep-purple|green|grey|indigo|light-blue|light-green|lime|orange|pink|purple|red|teal|transparent|white|yellow|primary|secondary|accent|error|info|success|warning|none
#DesignerProperty: Key: ColorIntensity, DisplayName: ColorIntensity, FieldType: String, DefaultValue: , Description: ColorIntensity, List: normal|lighten-5|lighten-4|lighten-3|lighten-2|lighten-1|darken-1|darken-2|darken-3|darken-4|accent-1|accent-2|accent-3|accent-4
#DesignerProperty: Key: Dark, DisplayName: Dark, FieldType: Boolean, DefaultValue: false, Description: Dark
#DesignerProperty: Key: Dense, DisplayName: Dense, FieldType: Boolean, DefaultValue: false, Description: Dense
#DesignerProperty: Key: Disabled, DisplayName: Disabled, FieldType: Boolean, DefaultValue: False, Description: Disabled
#DesignerProperty: Key: Elevation, DisplayName: Elevation, FieldType: String, DefaultValue: , Description: Elevation
#DesignerProperty: Key: Expand, DisplayName: Expand, FieldType: Boolean, DefaultValue: false, Description: Expand
#DesignerProperty: Key: Flat, DisplayName: Flat, FieldType: Boolean, DefaultValue: false, Description: Flat
#DesignerProperty: Key: Height, DisplayName: Height, FieldType: String, DefaultValue: , Description: Height
#DesignerProperty: Key: Key, DisplayName: Key, FieldType: String, DefaultValue: , Description: Key
#DesignerProperty: Key: Light, DisplayName: Light, FieldType: Boolean, DefaultValue: false, Description: Light
#DesignerProperty: Key: MaxHeight, DisplayName: MaxHeight, FieldType: String, DefaultValue: , Description: MaxHeight
#DesignerProperty: Key: MaxWidth, DisplayName: MaxWidth, FieldType: String, DefaultValue: , Description: MaxWidth
#DesignerProperty: Key: MinHeight, DisplayName: MinHeight, FieldType: String, DefaultValue: , Description: MinHeight
#DesignerProperty: Key: MinWidth, DisplayName: MinWidth, FieldType: String, DefaultValue: , Description: MinWidth
#DesignerProperty: Key: Nav, DisplayName: Nav, FieldType: Boolean, DefaultValue: false, Description: Nav
#DesignerProperty: Key: Outlined, DisplayName: Outlined, FieldType: Boolean, DefaultValue: false, Description: Outlined
#DesignerProperty: Key: Rounded, DisplayName: Rounded, FieldType: Boolean, DefaultValue: false, Description: Rounded, List: none|rounded-0|rounded|rounded-sm|rounded-lg|rounded-xl|rounded-t-xl|rounded-r-xl|rounded-b-xl|rounded-l-xl|rounded-tl-xl|rounded-tr-xl|rounded-br-xl|rounded-bl-xl|rounded-pill|rounded-circle
#DesignerProperty: Key: Shaped, DisplayName: Shaped, FieldType: Boolean, DefaultValue: false, Description: Shaped
#DesignerProperty: Key: Subheader, DisplayName: Subheader, FieldType: Boolean, DefaultValue: false, Description: Subheader
#DesignerProperty: Key: TextColor, DisplayName: TextColor, FieldType: String, DefaultValue: , Description: TextColor, List: amber|black|blue|blue-grey|brown|cyan|deep-orange|deep-purple|green|grey|indigo|light-blue|light-green|lime|orange|pink|purple|red|teal|transparent|white|yellow|primary|secondary|accent|error|info|success|warning|none
#DesignerProperty: Key: TextColorIntensity, DisplayName: TextColorIntensity, FieldType: String, DefaultValue: , Description: TextColorIntensity, List: normal|lighten-5|lighten-4|lighten-3|lighten-2|lighten-1|darken-1|darken-2|darken-3|darken-4|accent-1|accent-2|accent-3|accent-4

#DesignerProperty: Key: Tile, DisplayName: Tile, FieldType: Boolean, DefaultValue: false, Description: Tile
'
#DesignerProperty: Key: UseLeftAction, DisplayName: UseLeftAction, FieldType: Boolean, DefaultValue: True, Description: UseLeftAction
#DesignerProperty: Key: UseLeftActionButton, DisplayName: UseLeftActionButton, FieldType: Boolean, DefaultValue: True, Description: UseLeftActionButton
#DesignerProperty: Key: UseLeftActionCheckBox, DisplayName: UseLeftActionCheckBox, FieldType: Boolean, DefaultValue: True, Description: UseLeftActionCheckBox
#DesignerProperty: Key: UseLeftActionSwitch, DisplayName: UseLeftActionSwitch, FieldType: Boolean, DefaultValue: True, Description: UseLeftActionSwitch

#DesignerProperty: Key: UseLeftAvatar, DisplayName: UseLeftAvatar, FieldType: Boolean, DefaultValue: True, Description: UseLeftAvatar
#DesignerProperty: Key: UseLeftAvatarImage, DisplayName: UseLeftAvatarImage, FieldType: Boolean, DefaultValue: True, Description: UseLeftAvatarImage
#DesignerProperty: Key: UseLeftAvatarIcon, DisplayName: UseLeftAvatarIcon, FieldType: Boolean, DefaultValue: True, Description: UseLeftAvatarIcon
#DesignerProperty: Key: UseLeftAvatarText, DisplayName: UseLeftAvatarText, FieldType: Boolean, DefaultValue: True, Description: UseLeftAvatarText

#DesignerProperty: Key: UseIcon, DisplayName: UseIcon, FieldType: Boolean, DefaultValue: True, Description: UseIcon
#DesignerProperty: Key: UseTitle, DisplayName: UseTitle, FieldType: Boolean, DefaultValue: True, Description: UseTitle
#DesignerProperty: Key: UseSubTitle, DisplayName: UseSubTitle, FieldType: Boolean, DefaultValue: True, Description: UseSubTitle
#DesignerProperty: Key: UseSubTitle1, DisplayName: UseSubTitle1, FieldType: Boolean, DefaultValue: True, Description: UseSubTitle1
#DesignerProperty: Key: UseSubTitle2, DisplayName: UseSubTitle2, FieldType: Boolean, DefaultValue: True, Description: UseSubTitle2
#DesignerProperty: Key: UseSubTitle3, DisplayName: UseSubTitle3, FieldType: Boolean, DefaultValue: True, Description: UseSubTitle3
#DesignerProperty: Key: UseSubTitle4, DisplayName: UseSubTitle4, FieldType: Boolean, DefaultValue: True, Description: UseSubTitle4

#DesignerProperty: Key: UseRightAvatar, DisplayName: UseRightAvatar, FieldType: Boolean, DefaultValue: True, Description: UseRightAvatar
#DesignerProperty: Key: UseRightAvatarIcon, DisplayName: UseRightAvatarIcon, FieldType: Boolean, DefaultValue: True, Description: UseRightAvatarIcon
#DesignerProperty: Key: UseRightAvatarImage, DisplayName: UseRightAvatarImage, FieldType: Boolean, DefaultValue: True, Description: UseRightAvatarImage
#DesignerProperty: Key: UseRightAvatarText, DisplayName: UseRightAvatarText, FieldType: Boolean, DefaultValue: True, Description: UseRightAvatarText

#DesignerProperty: Key: UseRightChip, DisplayName: UseRightChip, FieldType: Boolean, DefaultValue: True, Description: UseRightChip

#DesignerProperty: Key: UseRightAction, DisplayName: UseRightAction, FieldType: Boolean, DefaultValue: True, Description: UseRightAction
#DesignerProperty: Key: UseRightActionButton, DisplayName: UseRightActionButton, FieldType: Boolean, DefaultValue: True, Description: UseRightActionButton
#DesignerProperty: Key: UseRightActionCheckBox, DisplayName: UseRightActionCheckBox, FieldType: Boolean, DefaultValue: True, Description: UseRightActionCheckBox
#DesignerProperty: Key: UseRightActionRating, DisplayName: UseRightActionRating, FieldType: Boolean, DefaultValue: True, Description: UseRightActionRating
#DesignerProperty: Key: UseRightActionSwitch, DisplayName: UseRightActionSwitch, FieldType: Boolean, DefaultValue: True, Description: UseRightActionSwitch
#DesignerProperty: Key: UseRightActionText, DisplayName: UseRightActionText, FieldType: Boolean, DefaultValue: True, Description: UseRightActionText


#DesignerProperty: Key: VBind, DisplayName: VBind, FieldType: String, DefaultValue: , Description: VBind
#DesignerProperty: Key: VFor, DisplayName: VFor, FieldType: String, DefaultValue: , Description: VFor
#DesignerProperty: Key: VIf, DisplayName: VIf, FieldType: String, DefaultValue: , Description: VIf
#DesignerProperty: Key: VOn, DisplayName: VOn, FieldType: String, DefaultValue: , Description: VOn
#DesignerProperty: Key: Width, DisplayName: Width, FieldType: String, DefaultValue: , Description: Width
#DesignerProperty: Key: Classes, DisplayName: Classes, FieldType: String, DefaultValue: , Description: Classes added to the HTML tag.
#DesignerProperty: Key: Styles, DisplayName: Styles, FieldType: String, DefaultValue: , Description: Styles added to the HTML tag. Must be a json String, use =
#DesignerProperty: Key: Attributes, DisplayName: Attributes, FieldType: String, DefaultValue: , Description: Attributes added to the HTML tag. Must be a json String, use =

Sub Class_Globals
    Private BANano As BANano 'ignore
	Private mName As String 'ignore
	Private mEventName As String 'ignore
	Private mCallBack As Object 'ignore
	Private mTarget As BANanoElement 'ignore
	Private mElement As BANanoElement 'ignore
	Private mClasses As String = ""
	Private mStyles As String = ""
	Private mAttributes As String = ""
	Public VElement As VueElement
	Private sColor As String
Private sColorIntensity As String
Private bDark As Boolean
Private bDense As Boolean
Private sDisabled As String
Private sElevation As String
Private bExpand As Boolean
Private bFlat As Boolean
Private sHeight As String
Private sKey As String
Private bLight As Boolean
Private sMaxHeight As String
Private sMaxWidth As String
Private sMinHeight As String
Private sMinWidth As String
Private bNav As Boolean
Private bOutlined As Boolean
Private bRounded As Boolean
Private bShaped As Boolean
Private bSubheader As Boolean
Private sTextColor As String
Private sTextColorIntensity As String
Private bThreeLine As Boolean
Private bTile As Boolean
Private bTwoLine As Boolean
Private sVBind As String
Private sVFor As String
Private sVIf As String
Private sVOn As String
'Private sVShow As String
Private sWidth As String
Private Options As ListViewItemOptions
Public Records As List
Public DataSource As String
Private numLines As Int
Private xTemplate As String
Private bDisabled As Boolean
Private bHidden As Boolean
Private bPlaceAtBottom As Boolean
	Private bUseIcon As Boolean
Private bUseLeftAction As Boolean
Private bUseLeftActionButton As Boolean
Private bUseLeftActionCheckBox As Boolean
Private bUseLeftActionSwitch As Boolean
Private bUseLeftAvatar As Boolean
Private bUseLeftAvatarIcon As Boolean
Private bUseLeftAvatarImage As Boolean
Private bUseLeftAvatarText As Boolean
Private bUseRightAction As Boolean
Private bUseRightActionButton As Boolean
Private bUseRightActionCheckBox As Boolean
Private bUseRightActionRating As Boolean
Private bUseRightActionSwitch As Boolean
Private bUseRightActionText As Boolean
Private bUseRightAvatar As Boolean
Private bUseRightAvatarIcon As Boolean
Private bUseRightAvatarImage As Boolean
Private bUseRightAvatarText As Boolean
Private bUseRightChip As Boolean
Private bUseSubTitle As Boolean
Private bUseSubTitle1 As Boolean
Private bUseSubTitle2 As Boolean
Private bUseSubTitle3 As Boolean
Private bUseSubTitle4 As Boolean
Private bUseTitle As Boolean
End Sub
	
Sub Initialize (CallBack As Object, Name As String, EventName As String)
	mName = Name.tolowercase
	mEventName = EventName.ToLowerCase
	mCallBack = CallBack	
	mName = mName.Replace("#","")
	mEventName = mEventName.Replace("#","")
	If mName <> "" Then
		Dim fKey As String = $"#${mName}"$
		If BANano.Exists(fKey) Then 
			mElement = BANano.GetElement(fKey)
		End If
	End If
	Records.Initialize 
	DataSource = ""
	numLines = 0
	sDisabled = $"${mName}disabled"$
	'sVShow = $"${mName}show"$
	NewListViewItemOptions
	'
	bUseIcon = True
	bUseLeftAction = True
	bUseLeftActionButton = True
	bUseLeftActionCheckBox = True
	bUseLeftActionSwitch = True
	bUseLeftAvatar = True
	bUseLeftAvatarIcon = True
	bUseLeftAvatarImage = True
	bUseLeftAvatarText = True
	bUseRightAction = True
	bUseRightActionButton = True
	bUseRightActionCheckBox = True
	bUseRightActionRating = True
	bUseRightActionSwitch = True
	bUseRightActionText = True
	bUseRightAvatar = True
	bUseRightAvatarIcon = True
	bUseRightAvatarImage = True
	bUseRightAvatarText = True
	bUseRightChip = True
	bUseSubTitle = True
	bUseSubTitle1 = True
	bUseSubTitle2 = True
	bUseSubTitle3 = True
	bUseSubTitle4 = True
	bUseTitle = True
End Sub
	
Sub DesignerCreateView (Target As BANanoElement, Props As Map)
	mTarget = Target
	If Props <> Null Then
		mClasses = Props.Get("Classes")
		mStyles = Props.Get("Styles")
		mAttributes = Props.Get("Attributes")
		sColor = Props.Get("Color")
sColorIntensity = Props.Get("ColorIntensity")
bDark = Props.Get("Dark")
bDense = Props.Get("Dense")
bDisabled = Props.GetDefault("Disabled",False)
sElevation = Props.Get("Elevation")
bExpand = Props.Get("Expand")
bFlat = Props.Get("Flat")
sHeight = Props.Get("Height")
sKey = Props.Get("Key")
bLight = Props.Get("Light")
sMaxHeight = Props.Get("MaxHeight")
sMaxWidth = Props.Get("MaxWidth")
sMinHeight = Props.Get("MinHeight")
sMinWidth = Props.Get("MinWidth")
bNav = Props.Get("Nav")
bOutlined = Props.Get("Outlined")
bRounded = Props.Get("Rounded")
bShaped = Props.Get("Shaped")
bSubheader = Props.Get("Subheader")
sTextColor = Props.Get("TextColor")
sTextColorIntensity = Props.Get("TextColorIntensity")
bThreeLine = Props.Get("ThreeLine")
bTile = Props.Get("Tile")
bTwoLine = Props.Get("TwoLine")
sVBind = Props.Get("VBind")
sVFor = Props.Get("VFor")
sVIf = Props.Get("VIf")
sVOn = Props.Get("VOn")
bHidden = Props.GetDefault("Hidden", False)
sWidth = Props.Get("Width")
bPlaceAtBottom = Props.GetDefault("PlaceAtBottom", False)
		bUseIcon = Props.GetDefault("UseIcon", True)
bUseIcon = BANanoShared.parseBool(bUseIcon)
bUseLeftAction = Props.GetDefault("UseLeftAction", True)
bUseLeftAction = BANanoShared.parseBool(bUseLeftAction)
bUseLeftActionButton = Props.GetDefault("UseLeftActionButton", True)
bUseLeftActionButton = BANanoShared.parseBool(bUseLeftActionButton)
bUseLeftActionCheckBox = Props.GetDefault("UseLeftActionCheckBox", True)
bUseLeftActionCheckBox = BANanoShared.parseBool(bUseLeftActionCheckBox)
bUseLeftActionSwitch = Props.GetDefault("UseLeftActionSwitch", True)
bUseLeftActionSwitch = BANanoShared.parseBool(bUseLeftActionSwitch)
bUseLeftAvatar = Props.GetDefault("UseLeftAvatar", True)
bUseLeftAvatar = BANanoShared.parseBool(bUseLeftAvatar)
bUseLeftAvatarIcon = Props.GetDefault("UseLeftAvatarIcon", True)
bUseLeftAvatarIcon = BANanoShared.parseBool(bUseLeftAvatarIcon)
bUseLeftAvatarImage = Props.GetDefault("UseLeftAvatarImage", True)
bUseLeftAvatarImage = BANanoShared.parseBool(bUseLeftAvatarImage)
bUseLeftAvatarText = Props.GetDefault("UseLeftAvatarText", True)
bUseLeftAvatarText = BANanoShared.parseBool(bUseLeftAvatarText)
bUseRightAction = Props.GetDefault("UseRightAction", True)
bUseRightAction = BANanoShared.parseBool(bUseRightAction)
bUseRightActionButton = Props.GetDefault("UseRightActionButton", True)
bUseRightActionButton = BANanoShared.parseBool(bUseRightActionButton)
bUseRightActionCheckBox = Props.GetDefault("UseRightActionCheckBox", True)
bUseRightActionCheckBox = BANanoShared.parseBool(bUseRightActionCheckBox)
bUseRightActionRating = Props.GetDefault("UseRightActionRating", True)
bUseRightActionRating = BANanoShared.parseBool(bUseRightActionRating)
bUseRightActionSwitch = Props.GetDefault("UseRightActionSwitch", True)
bUseRightActionSwitch = BANanoShared.parseBool(bUseRightActionSwitch)
bUseRightActionText = Props.GetDefault("UseRightActionText", True)
bUseRightActionText = BANanoShared.parseBool(bUseRightActionText)
bUseRightAvatar = Props.GetDefault("UseRightAvatar", True)
bUseRightAvatar = BANanoShared.parseBool(bUseRightAvatar)
bUseRightAvatarIcon = Props.GetDefault("UseRightAvatarIcon", True)
bUseRightAvatarIcon = BANanoShared.parseBool(bUseRightAvatarIcon)
bUseRightAvatarImage = Props.GetDefault("UseRightAvatarImage", True)
bUseRightAvatarImage = BANanoShared.parseBool(bUseRightAvatarImage)
bUseRightAvatarText = Props.GetDefault("UseRightAvatarText", True)
bUseRightAvatarText = BANanoShared.parseBool(bUseRightAvatarText)
bUseRightChip = Props.GetDefault("UseRightChip", True)
bUseRightChip = BANanoShared.parseBool(bUseRightChip)
bUseSubTitle = Props.GetDefault("UseSubTitle", True)
bUseSubTitle = BANanoShared.parseBool(bUseSubTitle)
bUseSubTitle1 = Props.GetDefault("UseSubTitle1", True)
bUseSubTitle1 = BANanoShared.parseBool(bUseSubTitle1)
bUseSubTitle2 = Props.GetDefault("UseSubTitle2", True)
bUseSubTitle2 = BANanoShared.parseBool(bUseSubTitle2)
bUseSubTitle3 = Props.GetDefault("UseSubTitle3", True)
bUseSubTitle3 = BANanoShared.parseBool(bUseSubTitle3)
bUseSubTitle4 = Props.GetDefault("UseSubTitle4", True)
bUseSubTitle4 = BANanoShared.parseBool(bUseSubTitle4)
bUseTitle = Props.GetDefault("UseTitle", True)
bUseTitle = BANanoShared.parseBool(bUseTitle)
	End If
	'
	bDark = BANanoShared.parseBool(bDark)
bDense = BANanoShared.parseBool(bDense)
bDisabled = BANanoShared.parseBool(bDisabled)
bExpand = BANanoShared.parseBool(bExpand)
bFlat = BANanoShared.parseBool(bFlat)
bLight = BANanoShared.parseBool(bLight)
bNav = BANanoShared.parseBool(bNav)
bOutlined = BANanoShared.parseBool(bOutlined)
bRounded = BANanoShared.parseBool(bRounded)
bShaped = BANanoShared.parseBool(bShaped)
bSubheader = BANanoShared.parseBool(bSubheader)
bThreeLine = BANanoShared.parseBool(bThreeLine)
bTile = BANanoShared.parseBool(bTile)
bTwoLine = BANanoShared.parseBool(bTwoLine)
bHidden = BANanoShared.parseBool(bHidden)
bPlaceAtBottom = BANanoShared.parseBool(bPlaceAtBottom)
bDisabled = BANanoShared.parseBool(bDisabled)

	'build and get the element
	If BANano.Exists($"#${mName}"$) Then
		mElement = BANano.GetElement($"#${mName}"$)
	Else	
		mElement = mTarget.Append($"<v-list ref="${mName}" id="${mName}"></v-list>"$).Get("#" & mName)
	End If
		
	VElement.Initialize(mCallBack, mName, mName)
	VElement.TagName = "v-list"
	VElement.Classes = mClasses
	VElement.Styles = mStyles
	VElement.Attributes = mAttributes
	VElement.Color = VElement.BuildColor(sColor, sColorIntensity)
VElement.AddAttr(":dark", bDark)
VElement.AddAttr(":dense", bDense)
VElement.AddAttr(":disabled", sDisabled)
VElement.SetData(sDisabled, bDisabled)
VElement.AddAttr("elevation", sElevation)
VElement.AddAttr(":expand", bExpand)
VElement.AddAttr(":flat", bFlat)
VElement.AddAttr("height", sHeight)
VElement.AddAttr("key", sKey)
VElement.AddAttr(":light", bLight)
VElement.AddAttr("max-height", sMaxHeight)
VElement.AddAttr("max-width", sMaxWidth)
VElement.AddAttr("min-height", sMinHeight)
VElement.AddAttr("min-width", sMinWidth)
VElement.AddAttr(":nav", bNav)
VElement.AddAttr(":outlined", bOutlined)
VElement.AddAttr(":rounded", bRounded)
VElement.AddAttr(":shaped", bShaped)
VElement.AddAttr(":subheader", bSubheader)
VElement.TextColor = sTextColor
VElement.TextColorIntensity = sTextColorIntensity
VElement.AddAttr(":three-line", bThreeLine)
VElement.AddAttr(":tile", bTile)
VElement.AddAttr(":two-line", bTwoLine)
VElement.AddAttr("v-bind", sVBind)
VElement.AddAttr("v-for", sVFor)
VElement.AddAttr("v-if", sVIf)
VElement.AddAttr("v-on", sVOn)
'VElement.AddAttr("v-show", sVShow)
'VElement.SetData(sVShow, Not(bHidden))
VElement.AddAttr("width", sWidth)
numLines = 0
If bThreeLine Then numLines = 3
If bTwoLine Then numLines = 2
If bPlaceAtBottom Then
	VElement.AddStyle("position", "absolute")
	VElement.AddStyle("bottom", "0")
	VElement.AddClass("ml-3")
End If
VElement.BindAllEvents
End Sub

'set options from definition
Sub SetOptions(opt As VListOptions)
	Dim tmp As ListViewItemOptions = opt.Options
	xTemplate = opt.Template
	Select Case xTemplate
	Case "none"
	Case "list"
		AddListViewTemplate(tmp)
	Case "list-item-group"
		AddListItemGroupTemplate(tmp)
	Case "tree"
		AddListViewGroupTemplate(tmp)
	End Select
	VElement.setdata(tmp.dataSource, VElement.NewList)
End Sub

public Sub AddToParent(targetID As String)
	mTarget = BANano.GetElement("#" & targetID.ToLowerCase)
	DesignerCreateView(mTarget, Null)
End Sub

public Sub Remove()
	mElement.Remove
	BANano.SetMeToNull
End Sub

Sub AddClass(s As String) As VList
	VElement.AddClass(s)
	Return Me
End Sub

Sub AddAttr(p As String, v As Object) As VList
	VElement.SetAttr(p, v)
	Return Me
End Sub

Sub AddStyle(p As String, v As String) As VList
	VElement.AddStyle(p, v)
	Return Me
End Sub

Sub RemoveAttr(p As String) As VList
	VElement.RemoveAttr(p)
	Return Me
End Sub

Sub UpdateVisible(VC As VueComponent, b As Boolean) As VList
	VC.SetData(sVIf, b)
	'VC.SetData(sVShow, b)
	Return Me
End Sub

Sub UpdateDisabled(VC As VueComponent, b As Boolean)
	bDisabled = b
	VC.SetData(sDisabled, b)
End Sub


Sub getHere As String
	Return $"#${mName}"$
End Sub

Sub getID As String
	Return mName
End Sub

Sub Clear(VC As VueComponent)
	Records.Initialize
	VC.SetData(DataSource, Records)
End Sub

Sub ClearOnApp(app As VuetifyApp)
	Records.Initialize 
	app.SetData(DataSource, Records)
End Sub

Sub Refresh(VC As VueComponent)
	Select Case xTemplate
	Case "tree"
		Dim recs As List = BANanoShared.Unflatten(Records, "items")
		VC.SetData(DataSource, recs)	
	Case Else
		VC.setdata(DataSource, Records)
	End Select
End Sub

Sub RefreshOnApp(app As VuetifyApp)
	Select Case xTemplate
	Case "tree"
		Dim recs As List = BANanoShared.Unflatten(Records, "items")
		app.SetData(DataSource, recs)	
	Case Else
		app.setdata(DataSource, Records)
	End Select
End Sub


'add a header to the list
Sub AddHeader(txt As String)
	Dim rec As Map = CreateMap()
	rec.Put("header", txt)
	Records.Add(rec)
End Sub

'add a divider
Sub AddDivider(binset As Boolean)
	Dim rec As Map = CreateMap()
	rec.Put("divider", True)
	If binset Then 
		rec.Put("inset", binset)
	End If
	Records.Add(rec)
End Sub


private Sub CleanID(v As String) As String
	v = v.Replace("#","")
	v = $"#${v}"$
	v = v.tolowercase
	Return v
End Sub

'add a list item template to draw item
Sub AddListItemGroupTemplate(props As ListViewItemOptions)
	Dim elID As String = mName.ToLowerCase
	Dim parentID As String = CleanID(mName)
	'
	Dim templateID As String = $"${elID}template"$
	'Dim headerID As String = $"${elID}header"$
	'Dim dividerID As String = $"${elID}divider"$
	Dim listitemID As String = $"${elID}listitem"$
	Dim leftactionID As String = $"${elID}leftaction"$
	Dim leftactionBtnID As String = $"${elID}leftactionbtn"$
	Dim leftactionIconID As String = $"${elID}leftactionicon"$
	Dim leftcheckboxID As String = $"${elID}leftcheckbox"$
	Dim rightcheckboxID As String = $"${elID}rightcheckbox"$
	Dim avatarID As String = $"${elID}avatar"$
	Dim avatarImgID As String = $"${elID}avatarimage"$
	Dim avatarIconID As String = $"${elID}avataricon"$
	Dim itemiconID As String = $"${elID}itemicon"$
	Dim iconID As String = $"${elID}icon"$
	Dim contentID As String = $"${elID}content"$
	Dim titleID As String = $"${elID}title"$
	Dim subtitleID As String = $"${elID}subtitle"$
	Dim subtitle1ID As String = $"${elID}subtitle1"$
	Dim subtitle2ID As String = $"${elID}subtitle2"$
	Dim subtitle3ID As String = $"${elID}subtitle3"$
	Dim subtitle4ID As String = $"${elID}subtitle4"$
	Dim rightactionID As String = $"${elID}rightaction"$
	Dim rightactiontextID As String = $"${elID}rightactiontext"$
	Dim rightactionBtnID As String = $"${elID}rightactionbtn"$
	Dim rightactionIconID As String = $"${elID}rightactionicon"$
	Dim rightratingID As String = $"${elID}rightrating"$
	Dim leftswitchID As String = $"${elID}leftswitch"$
	Dim rightswitchID As String = $"${elID}rightswitch"$
	Dim rightchipID As String = $"${elID}rightchip"$
	'
	Dim rightavatarID As String = $"${elID}rightavatar"$
	Dim rightavatarImgID As String = $"${elID}rightavatarimage"$
	Dim rightavatarIconID As String = $"${elID}rightavataricon"$
	Dim rightavatarTextID As String = $"${elID}rightavatartext"$
	Dim avatarTextID As String = $"${elID}avatartext"$
	
	'in case the pointers are changed
	Dim xurl As String = props.url
	Dim xlefticon As String = props.lefticon
	Dim xlefticoncolor As String = props.lefticoncolor
	Dim xlefticonclass As String = props.lefticonclass
	'
	Dim xavatar As String = props.avatar
	Dim xavatarclass As String = props.avatarclass
	
	Dim xavataricon As String = props.avataricon
	Dim xavatariconcolor As String = props.avatariconcolor
	Dim xavatariconclass As String = props.avatariconclass
	
	Dim xicon As String = props.icon
	Dim xiconclass As String = props.iconclass
	Dim xiconcolor As String = props.iconcolor
	
	Dim xtitle As String = props.title
	Dim xsubtitle As String = props.subtitle
	Dim xsubtitle1 As String = props.subtitle1
	Dim xsubtitle2 As String = props.subtitle2
	Dim xsubtitle3 As String = props.subtitle3
	Dim xsubtitle4 As String = props.subtitle4
	'
	Dim xrighticon As String = props.righticon
	Dim xrighticonclass As String = props.righticonclass
	Dim xrighttext As String = props.righttext
	Dim xrighticoncolor As String = props.righticoncolor
	DataSource = props.dataSource
	DataSource = DataSource.ToLowerCase
	Dim key As String = props.key
	key = key.ToLowerCase
	
	Dim xactiveclass As String = props.activeclass
	Dim xleftcheckbox As String = props.leftcheckbox
	Dim xrightcheckbox As String = props.rightcheckbox
	Dim xshowleftcheckboxes As Boolean = props.showleftcheckboxes
	Dim xshowrightcheckboxes As Boolean = props.showrightcheckboxes
	Dim xshowrightrating As Boolean = props.showrightrating
	Dim xrightrating As String = props.rightrating
	'
	Dim xleftswitch As String = props.leftswitch
	Dim xshowleftswitch As Boolean = props.showleftswitches
	Dim xrightswitch As String = props.rightswitch
	Dim xshowrightswitch As Boolean = props.showrightswitches
	Dim xswitchinset As Boolean = props.switchinset
	Dim xitemavatarclass As String = props.itemavatarclass
	'
	Dim xrightchip As String = props.rightchip
	Dim xrightchipcolor As String = props.rightchipcolor
	Dim xhref As String = props.href
	Dim xtarget As String = props.target
	If xhref = "" Then xhref = "href"
	If xtarget = "" Then xtarget = "target"
	
	Dim xrightitemavatarclass As String = props.rightitemavatarclass
	
	Dim sTemplate As String = $"<v-list-item-group id="${templateID}" active-class="${xactiveclass}">
	<v-template v-for="(item, index) in ${DataSource}">
<v-list-item id="${listitemID}" :key="item.${key}" :to="item.${xurl}" :href="item.${xhref}" :target="item.${xtarget}">
<v-list-item-action id="${leftactionID}" v-if="item.${xlefticon} || ${xshowleftcheckboxes} || ${xshowleftswitch}">
<v-btn id="${leftactionBtnID}" :icon="true" v-if="item.${xlefticon}">
<v-icon id="${leftactionIconID}" ${props.lefticonattr} :color="item.${xlefticoncolor}" v-html="item.${xlefticon}" class="${xlefticonclass}"></v-icon>
</v-btn>
<v-checkbox id="${leftcheckboxID}" ${props.leftcheckboxattr} v-if="${xshowleftcheckboxes}" :item="item" v-model="item.${xleftcheckbox}" :input-value="item.${xleftcheckbox}"></v-checkbox>
<v-switch id="${leftswitchID}" ${props.leftswitchattr} v-if="${xshowleftswitch}" :inset="${xswitchinset}" :item="item" v-model="item.${xleftswitch}" :input-value="item.${xleftswitch}"></v-switch>
</v-list-item-action>
<v-list-item-avatar id="${avatarID}" class="${xitemavatarclass}" v-if="item.${xavatar} || item.${xavataricon} || item.${props.avatartext}">
<v-img id="${avatarImgID}" ${props.avatarattr} :src="item.${xavatar}" class="${xavatarclass}" v-if="item.${xavatar}"></v-img>
<v-icon id="${avatarIconID}" ${props.avatariconattr} v-if="item.${xavataricon}" :color="item.${xavatariconcolor}" class="${xavatariconclass}" v-html="item.${xavataricon}"></v-icon>
<span id="${avatarTextID}" v-if="item.${props.avatartext}" :color="item.${props.avatartextcolor}" class="${props.avatartextclass}" v-html="item.${props.avatartext}"></span>
</v-list-item-avatar>
<v-list-item-icon id="${itemiconID}" v-if="item.${xicon}">
<v-icon id="${iconID}" ${props.iconattr} :color="item.${xiconcolor}" class="${xiconclass}" v-html="item.${xicon}"></v-icon>
</v-list-item-icon>
<v-list-item-content id="${contentID}" v-if="item.${xtitle} || item.${xsubtitle} || item.${xsubtitle1} || item.${xsubtitle2} || item.${xsubtitle3} || item.${xsubtitle4}">
<v-list-item-title id="${titleID}" v-if="item.${xtitle}" v-html="item.${xtitle}"></v-list-item-title>
<v-list-item-subtitle id="${subtitleID}" v-if="item.${xsubtitle}" v-html="item.${xsubtitle}"></v-list-item-subtitle>
<v-list-item-subtitle id="${subtitle1ID}" v-if="item.${xsubtitle1}" v-html="item.${xsubtitle1}"></v-list-item-subtitle>
<v-list-item-subtitle id="${subtitle2ID}" v-if="item.${xsubtitle2}" v-html="item.${xsubtitle2}"></v-list-item-subtitle>
<v-list-item-subtitle id="${subtitle3ID}" v-if="item.${xsubtitle3}" v-html="item.${xsubtitle3}"></v-list-item-subtitle>
<v-list-item-subtitle id="${subtitle4ID}" v-if="item.${xsubtitle4}" v-html="item.${xsubtitle4}"></v-list-item-subtitle>
</v-list-item-content>
<v-list-item-avatar id="${rightavatarID}" class="${xrightitemavatarclass}" v-if="item.${props.rightavatar} || item.${props.rightavataricon} || item.${props.rightavatartext}">
<v-img id="${rightavatarImgID}" ${props.rightavatarattr} :src="item.${props.rightavatar}" class="${props.rightavatarclass}" v-if="item.${props.rightavatar}"></v-img>
<v-icon id="${rightavatarIconID}" ${props.rightavatariconattr} v-if="item.${props.rightavataricon}" :color="item.${props.rightavatariconcolor}" class="${props.rightavatariconclass}" v-html="item.${props.rightavataricon}"></v-icon>
<span id="${rightavatarTextID}" v-if="item.${props.rightavatartext}" :color="item.${props.rightavatartextcolor}" class="${props.rightavatartextclass}" v-html="item.${props.rightavatartext}"></span>
</v-list-item-avatar>
<v-chip id="${rightchipID}" ${props.rightchipattr} v-if="item.${xrightchip}" :color="item.${xrightchipcolor}" dark small v-html="item.${xrightchip}"></v-chip>
<v-list-item-action id="${rightactionID}" v-if="item.${xrighticon} || item.${xrighttext} || ${xshowrightcheckboxes} || ${xshowrightrating} || ${xshowrightswitch}">
<v-list-item-action-text ${props.righttextattr} id="${rightactiontextID}" v-if="item.${xrighttext}" v-html="item.${xrighttext}"></v-list-item-action-text>
<v-btn id="${rightactionBtnID}" :icon="true" v-if="item.${xrighticon}">
<v-icon id="${rightactionIconID}" ${props.righticonattr} v-html="item.${xrighticon}" class="${xrighticonclass}" :color="item.${xrighticoncolor}"></v-icon>
</v-btn>
<v-checkbox id="${rightcheckboxID}" ${props.rightcheckboxattr} v-if="${xshowrightcheckboxes}" :item="item" v-model="item.${xrightcheckbox}" :input-value="item.${xrightcheckbox}"></v-checkbox>
<v-rating id="${rightratingID}" ${props.rightratingattr} length="1" v-if="${xshowrightrating}" v-model="item.${xrightrating}" :value="item.${xrightrating}"></v-rating>
<v-switch id="${rightswitchID}" ${props.rightswitchattr} v-if="${xshowrightswitch}" :inset="${xswitchinset}" :item="item" v-model="item.${xrightswitch}" :input-value="item.${xrightswitch}"></v-switch>
</v-list-item-action>
</v-list-item>
<v-divider v-if="${props.hasdivider}" :inset="${props.insetdivider}"></v-divider>
</v-template>
</v-list-item-group>"$
	
	'
	sTemplate = sTemplate.Replace("~","$")
	
	BANano.GetElement(parentID).Append(sTemplate)
	'
	Dim vlistitemx As VueElement
	vlistitemx.Initialize(mCallBack, listitemID, listitemID)
	Select Case numLines
	Case 2
		vlistitemx.AddAttr(":two-line", True)
	Case 3
		vlistitemx.AddAttr(":three-line", True)
	End Select
	vlistitemx.SetOnEventOwn(mCallBack, $"${elID}_click"$, "click", "item")
	'left action
	'
'	Dim vleftcheckbox As VueElement
'	vleftcheckbox.Initialize(mCallBack, leftcheckboxID, leftcheckboxID)
'	If xshowleftcheckboxes Then
'		vleftcheckbox.SetOnEventOwn(mCallBack, $"${elID}_leftclick"$, "click.stop", "item")
'	End If
	'
'	Dim vrightcheckbox As VueElement
'	vrightcheckbox.Initialize(mCallBack, rightcheckboxID, rightcheckboxID)
'	If xshowrightcheckboxes Then
'		vrightcheckbox.SetOnEventOwn(mCallBack, $"${elID}_rightclick"$, "click.stop", "item")
'	End If
	
	Dim vleftlistitemaction As VueElement
	vleftlistitemaction.Initialize(mCallBack, leftactionID, leftactionID)
	'If xshowleftcheckboxes = False And xshowleftswitch = False Then
		vleftlistitemaction.SetOnEventOwn(mCallBack, $"${elID}_leftclick"$, "click.stop", "item")
	'End If
	'
	Dim vrightlistitemaction As VueElement
	vrightlistitemaction.Initialize(mCallBack, rightactionID, rightactionID)
	'If xshowrightcheckboxes = False And xshowrightswitch = False Then
		vrightlistitemaction.SetOnEventOwn(mCallBack, $"${elID}_rightclick"$, "click.stop", "item")
	'End If
	'
'	Dim vleftswitch As VueElement
'	vleftswitch.Initialize(mCallBack, leftswitchID, leftswitchID)
'	'If xshowleftswitch Then 
	'	vleftswitch.SetOnEventOwn(mCallBack, $"${elID}_leftclick"$, "change.stop", "item")
	'End If
	'
'	Dim vrightswitch As VueElement
'	vrightswitch.Initialize(mCallBack, rightswitchID, rightswitchID)
	'If xshowrightswitch Then
	'	vrightswitch.SetOnEventOwn(mCallBack, $"${elID}_rightclick"$, "change.stop", "item")
	'End If
	
	VElement.SetData(DataSource, VElement.NewList)
	VElement.BindVueElement(vlistitemx)
	VElement.BindVueElement(vleftlistitemaction)
	VElement.BindVueElement(vrightlistitemaction)
'	vlistitem.BindVueElement(vleftcheckbox)
'	vlistitem.BindVueElement(vrightcheckbox)
'	vlistitem.BindVueElement(vrightswitch)
'	vlistitem.BindVueElement(vleftswitch)
	CleanUp
End Sub

'add a list item template to draw item
Sub AddListViewGroupTemplate(props As ListViewItemOptions)
	Dim elID As String = mName.ToLowerCase
	Dim parentID As String = CleanID(mName)
	'
	'Dim templateID As String = $"${elID}template"$
	'Dim headerID As String = $"${elID}header"$
	'Dim dividerID As String = $"${elID}divider"$
	Dim listitemID As String = $"${elID}listitem"$
	Dim leftactionID As String = $"${elID}leftaction"$
	Dim leftactionBtnID As String = $"${elID}leftactionbtn"$
	Dim leftactionIconID As String = $"${elID}leftactionicon"$
	Dim leftcheckboxID As String = $"${elID}leftcheckbox"$
	Dim rightcheckboxID As String = $"${elID}rightcheckbox"$
	Dim avatarID As String = $"${elID}avatar"$
	Dim avatarImgID As String = $"${elID}avatarimg"$
	Dim avatarIconID As String = $"${elID}avataricon"$
	Dim itemiconID As String = $"${elID}itemicon"$
	Dim iconID As String = $"${elID}icon"$
	Dim contentID As String = $"${elID}content"$
	Dim titleID As String = $"${elID}title"$
	Dim subtitleID As String = $"${elID}subtitle"$
	Dim subtitle1ID As String = $"${elID}subtitle1"$
	Dim subtitle2ID As String = $"${elID}subtitle2"$
	Dim subtitle3ID As String = $"${elID}subtitle3"$
	Dim subtitle4ID As String = $"${elID}subtitle4"$
	Dim rightactionID As String = $"${elID}rightaction"$
	Dim rightactiontextID As String = $"${elID}rightactiontext"$
	Dim rightactionBtnID As String = $"${elID}rightactionbtn"$
	Dim rightactionIconID As String = $"${elID}rightactionicon"$
	Dim rightratingID As String = $"${elID}rightrating"$
	Dim leftswitchID As String = $"${elID}leftswitch"$
	Dim rightswitchID As String = $"${elID}rightswitch"$
	Dim rightchipID As String = $"${elID}rightchip"$
	Dim rightavatarTextID As String = $"${elID}rightavatartext"$
	Dim avatarTextID As String = $"${elID}avatartext"$
	'
	Dim rightavatarID As String = $"${elID}rightavatar"$
	Dim rightavatarImgID As String = $"${elID}rightavatarimage"$
	Dim rightavatarIconID As String = $"${elID}rightavataricon"$
	
	'
	'in case the pointers are changed
	Dim xurl As String = props.url
	Dim xlefticon As String = props.lefticon
	Dim xlefticoncolor As String = props.lefticoncolor
	Dim xlefticonclass As String = props.lefticonclass
	'
	Dim xavatar As String = props.avatar
	Dim xavatarclass As String = props.avatarclass
	
	Dim xavataricon As String = props.avataricon
	Dim xavatariconcolor As String = props.avatariconcolor
	Dim xavatariconclass As String = props.avatariconclass
	
	Dim xicon As String = props.icon
	Dim xiconclass As String = props.iconclass
	Dim xiconcolor As String = props.iconcolor
	
	Dim xtitle As String = props.title
	Dim xsubtitle As String = props.subtitle
	Dim xsubtitle1 As String = props.subtitle1
	Dim xsubtitle2 As String = props.subtitle2
	Dim xsubtitle3 As String = props.subtitle3
	Dim xsubtitle4 As String = props.subtitle4

	'
	Dim xrighticon As String = props.righticon
	Dim xrighticonclass As String = props.righticonclass
	Dim xrighttext As String = props.righttext
	Dim xrighticoncolor As String = props.righticoncolor
	DataSource = props.dataSource
	Dim key As String = props.key
	
	Dim xactiveclass As String = props.activeclass
	Dim xleftcheckbox As String = props.leftcheckbox
	Dim xrightcheckbox As String = props.rightcheckbox
	Dim xshowleftcheckboxes As Boolean = props.showleftcheckboxes
	Dim xshowrightcheckboxes As Boolean = props.showrightcheckboxes
	Dim xshowrightrating As Boolean = props.showrightrating
	Dim xrightrating As String = props.rightrating
	'
	Dim xleftswitch As String = props.leftswitch
	Dim xshowleftswitch As Boolean = props.showleftswitches
	Dim xrightswitch As String = props.rightswitch
	Dim xshowrightswitch As Boolean = props.showrightswitches
	Dim xswitchinset As Boolean = props.switchinset
	Dim xitemavatarclass As String = props.itemavatarclass
	'
	Dim xrightchip As String = props.rightchip
	Dim xrightchipcolor As String = props.rightchipcolor
	Dim xhref As String = props.href
	Dim xtarget As String = props.target
	If xhref = "" Then xhref = "href"
	If xtarget = "" Then xtarget = "target"
	
	DataSource = DataSource.ToLowerCase
	key = key.ToLowerCase
		'
	Dim sTemplate As StringBuilder
	sTemplate.Initialize
	sTemplate.Append($"<v-template v-for="item in ${DataSource}">"$)
	sTemplate.Append($"<v-list-group v-if="item.items" :key="item.${key}" v-model="item.model" no-action active-class="${xactiveclass}">"$)
	sTemplate.Append($"<v-icon id="${iconID}" slot="prependIcon" ${props.iconattr} :color="item.${xiconcolor}" v-html="item.${xicon}"></v-icon>"$)
	'
	sTemplate.Append($"<v-template v-slot:activator>"$)
	sTemplate.Append($"<v-list-item-content id="${contentID}">"$)
	sTemplate.Append($"<v-list-item-title id="${titleID}" v-html="item.${xtitle}"></v-list-item-title>"$)
	sTemplate.Append($"</v-list-item-content>"$)
	sTemplate.Append($"</v-template>"$)

	sTemplate.Append($"<v-template v-for="child in item.items">"$)
sTemplate.Append($"<v-list-item id="${listitemID}" :key="child.${key}" :to="child.${xurl}" active-class="${xactiveclass}" :href="child.${xhref}" :target="child.${xtarget}">
<v-list-item-action id="${leftactionID}" v-if="child.${xlefticon} || ${xshowleftcheckboxes} || ${xshowleftswitch}">
<v-btn id="${leftactionBtnID}" :icon="true" v-if="child.${xlefticon}">
<v-icon id="${leftactionIconID}" ${props.lefticonattr} :color="child.${xlefticoncolor}" v-html="child.${xlefticon}" class="${xlefticonclass}"></v-icon>
</v-btn>
<v-checkbox id="${leftcheckboxID}" ${props.leftcheckboxattr} v-if="${xshowleftcheckboxes}" :item="child" v-model="child.${xleftcheckbox}" :input-value="child.${xleftcheckbox}"></v-checkbox>
<v-switch id="${leftswitchID}" ${props.leftswitchattr} v-if="${xshowleftswitch}" :inset="${xswitchinset}" :item="child" v-model="child.${xleftswitch}" :input-value="child.${xleftswitch}"></v-switch>
</v-list-item-action>
<v-list-item-avatar id="${avatarID}" class="${xitemavatarclass}" v-if="child.${xavatar} || child.${xavataricon}">
<v-img id="${avatarImgID}" ${props.avatarattr} :src="child.${xavatar}" class="${xavatarclass}" v-if="child.${xavatar}"></v-img>
<v-icon id="${avatarIconID}" ${props.avatariconattr} v-if="child.${xavataricon}" :color="child.${xavatariconcolor}" class="${xavatariconclass}" v-html="child.${xavataricon}"></v-icon>
<span id="${avatarTextID}" v-if="item.${props.avatartext}" :color="child.${props.avatartextcolor}" class="${props.avatartextclass}" v-html="child.${props.avatartext}"></span>
</v-list-item-avatar>
<v-list-item-icon id="${itemiconID}" v-if="child.${xicon}">
<v-icon id="${iconID}" ${props.iconattr} :color="child.${xiconcolor}" class="${xiconclass}" v-html="child.${xicon}"></v-icon>
</v-list-item-icon>
<v-list-item-content id="${contentID}" v-if="child.${xtitle} || child.${xsubtitle} || child.${xsubtitle1} || child.${xsubtitle2} || child.${xsubtitle3} || child.${xsubtitle4}">
<v-list-item-title id="${titleID}" v-if="child.${xtitle}" v-html="child.${xtitle}"></v-list-item-title>
<v-list-item-subtitle id="${subtitleID}" v-if="child.${xsubtitle}" v-html="child.${xsubtitle}"></v-list-item-subtitle>
<v-list-item-subtitle id="${subtitle1ID}" v-if="child.${xsubtitle1}" v-html="child.${xsubtitle1}"></v-list-item-subtitle>
<v-list-item-subtitle id="${subtitle2ID}" v-if="child.${xsubtitle2}" v-html="child.${xsubtitle2}"></v-list-item-subtitle>
<v-list-item-subtitle id="${subtitle3ID}" v-if="child.${xsubtitle3}" v-html="child.${xsubtitle3}"></v-list-item-subtitle>
<v-list-item-subtitle id="${subtitle4ID}" v-if="child.${xsubtitle4}" v-html="child.${xsubtitle4}"></v-list-item-subtitle>
</v-list-item-content>
<v-list-item-avatar id="${rightavatarID}" class="${props.rightitemavatarclass}" v-if="child.${props.rightavatar} || child.${props.rightavataricon} || child.${props.rightavatartext}">
<v-img id="${rightavatarImgID}" ${props.rightavatarattr} :src="child.${props.rightavatar}" class="${props.rightavatarclass}" v-if="child.${props.rightavatar}"></v-img>
<v-icon id="${rightavatarIconID}" ${props.rightavatariconattr} v-if="child.${props.rightavataricon}" :color="child.${props.rightavatariconcolor}" class="${props.rightavatariconclass}" v-html="child.${props.rightavataricon}"></v-icon>
<span id="${rightavatarTextID}" v-if="child.${props.rightavatartext}" :color="child.${props.rightavatartextcolor}" class="${props.rightavatartextclass}" v-html="child.${props.rightavatartext}"></span>
</v-list-item-avatar>
<v-chip id="${rightchipID}" ${props.rightchipattr} v-if="child.${xrightchip}" :color="child.${xrightchipcolor}" dark small v-html="child.${xrightchip}"></v-chip>
<v-list-item-action id="${rightactionID}" v-if="child.${xrighticon} || child.${xrighttext} || ${xshowrightcheckboxes} || ${xshowrightrating} || ${xshowrightswitch}">
<v-list-item-action-text ${props.righttextattr} id="${rightactiontextID}" v-if="child.${xrighttext}" v-html="child.${xrighttext}"></v-list-item-action-text>
<v-btn id="${rightactionBtnID}" :icon="true" v-if="child.${xrighticon}">
<v-icon id="${rightactionIconID}" ${props.righticonattr} v-html="child.${xrighticon}" class="${xrighticonclass}" :color="child.${xrighticoncolor}"></v-icon>
</v-btn>
<v-checkbox id="${rightcheckboxID}" ${props.rightcheckboxattr} v-if="${xshowrightcheckboxes}" :item="child" v-model="child.${xrightcheckbox}" :input-value="child.${xrightcheckbox}"></v-checkbox>
<v-rating id="${rightratingID}" ${props.rightratingattr} length="1" v-if="${xshowrightrating}" v-model="child.${xrightrating}" :value="child.${xrightrating}"></v-rating>
<v-switch id="${rightswitchID}" ${props.rightswitchattr} v-if="${xshowrightswitch}" :inset="${xswitchinset}" :item="child" v-model="child.${xrightswitch}" :input-value="child.${xrightswitch}"></v-switch>
</v-list-item-action>
</v-list-item>
<v-divider v-if="${props.hasdivider}" :inset="${props.insetdivider}"></v-divider>
</v-template>
</v-list-group>"$)
'
sTemplate.Append($"<v-list-item v-else id="${listitemID}" :key="item.${key}" :to="item.${xurl}" active-class="${xactiveclass}" :href="item.${xhref}" :target="item.${xtarget}">
<v-list-item-action id="${leftactionID}" v-if="item.${xlefticon} || ${xshowleftcheckboxes} || ${xshowleftswitch}">
<v-btn id="${leftactionBtnID}" :icon="true" v-if="item.${xlefticon}">
<v-icon id="${leftactionIconID}" ${props.lefticonattr} :color="item.${xlefticoncolor}" v-html="item.${xlefticon}" class="${xlefticonclass}"></v-icon>
</v-btn>
<v-checkbox id="${leftcheckboxID}" ${props.leftcheckboxattr} v-if="${xshowleftcheckboxes}" :item="item" v-model="item.${xleftcheckbox}" :input-value="item.${xleftcheckbox}"></v-checkbox>
<v-switch id="${leftswitchID}" ${props.leftswitchattr} v-if="${xshowleftswitch}" :inset="${xswitchinset}" :item="item" v-model="item.${xleftswitch}" :input-value="item.${xleftswitch}"></v-switch>
</v-list-item-action>
<v-list-item-avatar id="${avatarID}" class="${xitemavatarclass}" v-if="item.${xavatar} || item.${xavataricon}">
<v-img id="${avatarImgID}" ${props.avatarattr} :src="item.${xavatar}" class="${xavatarclass}" v-if="item.${xavatar}"></v-img>
<v-icon id="${avatarIconID}" ${props.avatariconattr} v-if="item.${xavataricon}" :color="item.${xavatariconcolor}" class="${xavatariconclass}" v-html="item.${xavataricon}"></v-icon>
<span id="${avatarTextID}" v-if="item.${props.avatartext}" :color="item.${props.avatartextcolor}" class="${props.avatartextclass}" v-html="item.${props.avatartext}"></span>
</v-list-item-avatar>
<v-list-item-icon id="${itemiconID}" v-if="item.${xicon}">
<v-icon id="${iconID}" ${props.iconattr} :color="item.${xiconcolor}" class="${xiconclass}" v-html="item.${xicon}"></v-icon>
</v-list-item-icon>
<v-list-item-content id="${contentID}" v-if="item.${xtitle} || item.${xsubtitle} || item.${xsubtitle1} || item.${xsubtitle2} || item.${xsubtitle3} || item.${xsubtitle4}">
<v-list-item-title id="${titleID}" v-if="item.${xtitle}" v-html="item.${xtitle}"></v-list-item-title>
<v-list-item-subtitle id="${subtitleID}" v-if="item.${xsubtitle}" v-html="item.${xsubtitle}"></v-list-item-subtitle>
<v-list-item-subtitle id="${subtitle1ID}" v-if="item.${xsubtitle1}" v-html="item.${xsubtitle1}"></v-list-item-subtitle>
<v-list-item-subtitle id="${subtitle2ID}" v-if="item.${xsubtitle2}" v-html="item.${xsubtitle2}"></v-list-item-subtitle>
<v-list-item-subtitle id="${subtitle3ID}" v-if="item.${xsubtitle3}" v-html="item.${xsubtitle3}"></v-list-item-subtitle>
<v-list-item-subtitle id="${subtitle4ID}" v-if="item.${xsubtitle4}" v-html="item.${xsubtitle4}"></v-list-item-subtitle>
</v-list-item-content>
<v-list-item-avatar id="${rightavatarID}" class="${props.rightitemavatarclass}" v-if="item.${props.rightavatar} || item.${props.rightavataricon} || item.${props.rightavatartext}">
<v-img id="${rightavatarImgID}" ${props.rightavatarattr} :src="item.${props.rightavatar}" class="${props.rightavatarclass}" v-if="item.${props.rightavatar}"></v-img>
<v-icon id="${rightavatarIconID}" ${props.rightavatariconattr} v-if="item.${props.rightavataricon}" :color="item.${props.rightavatariconcolor}" class="${props.rightavatariconclass}" v-html="item.${props.rightavataricon}"></v-icon>
<span id="${rightavatarTextID}" v-if="item.${props.rightavatartext}" :color="item.${props.rightavatartextcolor}" class="${props.rightavatartextclass}" v-html="item.${props.rightavatartext}"></span>
</v-list-item-avatar>
<v-chip id="${rightchipID}" ${props.rightchipattr} v-if="item.${xrightchip}" :color="item.${xrightchipcolor}" dark small v-html="item.${xrightchip}"></v-chip>
<v-list-item-action id="${rightactionID}" v-if="item.${xrighticon} || item.${xrighttext} || ${xshowrightcheckboxes} || ${xshowrightrating} || ${xshowrightswitch}">
<v-list-item-action-text ${props.righttextattr} id="${rightactiontextID}" v-if="item.${xrighttext}" v-html="item.${xrighttext}"></v-list-item-action-text>
<v-btn id="${rightactionBtnID}" :icon="true" v-if="item.${xrighticon}">
<v-icon id="${rightactionIconID}" ${props.righticonattr} v-html="item.${xrighticon}" class="${xrighticonclass}" :color="item.${xrighticoncolor}"></v-icon>
</v-btn>
<v-checkbox id="${rightcheckboxID}" ${props.rightcheckboxattr} v-if="${xshowrightcheckboxes}" :item="item" v-model="item.${xrightcheckbox}" :input-value="item.${xrightcheckbox}"></v-checkbox>
<v-rating id="${rightratingID}" ${props.rightratingattr} length="1" v-if="${xshowrightrating}" v-model="item.${xrightrating}" :value="item.${xrightrating}"></v-rating>
<v-switch id="${rightswitchID}" ${props.rightswitchattr} v-if="${xshowrightswitch}" :inset="${xswitchinset}" :item="item" v-model="item.${xrightswitch}" :input-value="item.${xrightswitch}"></v-switch>
</v-list-item-action>
</v-list-item>"$)
sTemplate.Append("</v-template>")
	'
	BANano.GetElement(parentID).Append(sTemplate.tostring)
	'
	Dim vlistitemx As VueElement
	vlistitemx.Initialize(mCallBack, listitemID, listitemID)
	Select Case numLines
	Case 2
		vlistitemx.AddAttr(":two-line", True)
	Case 3
		vlistitemx.AddAttr(":three-line", True)
	End Select
	vlistitemx.SetOnEventOwn(mCallBack, $"${elID}_click"$, "click", "child")
	'left action
	'
	VElement.SetData(DataSource, VElement.NewList)
	VElement.BindVueElement(vlistitemx)
	CleanUp
End Sub

private Sub NewListViewItemOptions
	Options.Initialize
	Options.datasource = ""
	Options.key = "id"
	Options.url  = "to"
	Options.href = "href"
	Options.target = "target"
	Options.lefticon  = "lefticon"
	Options.lefticoncolor  = "lefticoncolor"
	Options.lefticonclass  = ""
	'
	Options.avatar  = "avatar"
	Options.avatarclass  = ""
	
	Options.avataricon  = "avataricon"
	Options.avatariconcolor  = "avatariconcolor"
	Options.avatariconclass  = ""
	
	Options.icon  = "icon"
	Options.iconclass  = ""
	Options.iconcolor  = "iconcolor"
	
	Options.title  = "title"
	Options.subtitle  = "subtitle"
	Options.subtitle1  = "subtitle1"
	Options.subtitle2  = "subtitle2"
	Options.subtitle3  = "subtitle3"
	Options.subtitle4  = "subtitle4"
	'
	Options.righticon  = "righticon"
	Options.righticonclass  = ""
	Options.righttext  = "righttext"
	Options.righticoncolor  = "righticoncolor"
	Options.activeclass = ""
	'
	Options.rightcheckbox = "rightcheckbox"
	Options.leftcheckbox = "leftcheckbox"
	Options.showleftcheckboxes = False
	Options.showrightcheckboxes = False
	'
	Options.rightrating = "rightrating"
	Options.rightratingcolor = "rightratingcolor"
	Options.showrightrating = False
	'
	Options.leftswitch = "leftswitch"
	Options.showleftswitches = False
	'
	Options.rightswitch = "rightswitch"
	Options.showrightswitches = False
	Options.switchinset = False
	Options.itemavatarclass = ""
	'
	Options.rightchip = "rightchip"
	Options.rightchipcolor = "rightchipcolor"
	
	Options.lefticonattr = ""
	Options.avatarattr = ""
	Options.avatariconattr = ""
	Options.righticonattr = ""
	Options.righttextattr = ""
	Options.rightcheckboxattr = ""
	Options.leftcheckboxattr = ""
	Options.rightratingattr = ""
	Options.leftswitchattr = ""
	Options.rightswitchattr = ""
	Options.rightchipattr = ""
	Options.iconattr = ""
	Options.hasdivider = False
	Options.insetdivider = False
	'
	Options.rightavatar = "rightavatar"
	Options.rightavatarclass = ""
	Options.rightavataricon = "rightavataricon"
	Options.rightavatariconcolor = "rightavatariconcolor"
	Options.rightavatariconclass = ""
	Options.rightavatarattr = ""
	Options.rightavatariconattr = ""
	Options.rightitemavatarclass = ""
	'
	Options.avatartext = "avatartext"
	Options.rightavatartext = "rightavatartext"
	Options.avatartextcolor = "avatartextcolor"
	Options.rightavatartextcolor = "rightavatartextcolor"
	Options.avatartextclass = ""
	Options.rightavatartextclass = ""
End Sub

'add a list item template to draw item
Sub AddListViewTemplate(props As ListViewItemOptions) 
	Dim elID As String = mName.ToLowerCase
	Dim parentID As String = CleanID(mName)
	'
	Dim templateID As String = $"${elID}template"$
	Dim headerID As String = $"${elID}header"$
	Dim dividerID As String = $"${elID}divider"$
	Dim listitemID As String = $"${elID}listitem"$
	Dim leftactionID As String = $"${elID}leftaction"$
	Dim leftactionBtnID As String = $"${elID}leftactionbtn"$
	Dim leftactionIconID As String = $"${elID}leftactionicon"$
	Dim leftcheckboxID As String = $"${elID}leftcheckbox"$
	Dim rightcheckboxID As String = $"${elID}rightcheckbox"$
	Dim avatarID As String = $"${elID}avatar"$
	Dim avatarImgID As String = $"${elID}avatarimage"$
	Dim avatarIconID As String = $"${elID}avataricon"$
	Dim itemiconID As String = $"${elID}itemicon"$
	Dim iconID As String = $"${elID}icon"$
	Dim contentID As String = $"${elID}content"$
	Dim titleID As String = $"${elID}title"$
	Dim subtitleID As String = $"${elID}subtitle"$
	Dim subtitle1ID As String = $"${elID}subtitle1"$
	Dim subtitle2ID As String = $"${elID}subtitle2"$
	Dim subtitle3ID As String = $"${elID}subtitle3"$
	Dim subtitle4ID As String = $"${elID}subtitle4"$
	Dim rightactionID As String = $"${elID}rightaction"$
	Dim rightactiontextID As String = $"${elID}rightactiontext"$
	Dim rightactionBtnID As String = $"${elID}rightactionbtn"$
	Dim rightactionIconID As String = $"${elID}rightactionicon"$
	Dim rightratingID As String = $"${elID}rightrating"$
	Dim leftswitchID As String = $"${elID}leftswitch"$
	Dim rightswitchID As String = $"${elID}rightswitch"$
	Dim rightchipID As String = $"${elID}rightchip"$
	'
	Dim rightavatarID As String = $"${elID}rightavatar"$
	Dim rightavatarImgID As String = $"${elID}rightavatarimage"$
	Dim rightavatarIconID As String = $"${elID}rightavataricon"$
	Dim rightavatarTextID As String = $"${elID}rightavatartext"$
	Dim avatarTextID As String = $"${elID}avatartext"$
	
	'in case the pointers are changed
	Dim xurl As String = props.url
	Dim xlefticon As String = props.lefticon
	Dim xlefticoncolor As String = props.lefticoncolor
	Dim xlefticonclass As String = props.lefticonclass
	'
	Dim xavatar As String = props.avatar
	Dim xavatarclass As String = props.avatarclass
	
	Dim xavataricon As String = props.avataricon
	Dim xavatariconcolor As String = props.avatariconcolor
	Dim xavatariconclass As String = props.avatariconclass
	
	Dim xicon As String = props.icon
	Dim xiconclass As String = props.iconclass
	Dim xiconcolor As String = props.iconcolor
	
	Dim xtitle As String = props.title
	Dim xsubtitle As String = props.subtitle
	Dim xsubtitle1 As String = props.subtitle1
	Dim xsubtitle2 As String = props.subtitle2
	Dim xsubtitle3 As String = props.subtitle3
	Dim xsubtitle4 As String = props.subtitle4

	'
	Dim xrighticon As String = props.righticon
	Dim xrighticonclass As String = props.righticonclass
	Dim xrighttext As String = props.righttext
	Dim xrighticoncolor As String = props.righticoncolor
	DataSource = props.dataSource
	Dim key As String = props.key
	
	Dim xactiveclass As String = props.activeclass
	Dim xleftcheckbox As String = props.leftcheckbox
	Dim xrightcheckbox As String = props.rightcheckbox
	Dim xshowleftcheckboxes As Boolean = props.showleftcheckboxes
	Dim xshowrightcheckboxes As Boolean = props.showrightcheckboxes
	Dim xshowrightrating As Boolean = props.showrightrating
	Dim xrightrating As String = props.rightrating
	'
	Dim xleftswitch As String = props.leftswitch
	Dim xshowleftswitch As Boolean = props.showleftswitches
	Dim xrightswitch As String = props.rightswitch
	Dim xshowrightswitch As Boolean = props.showrightswitches
	Dim xswitchinset As Boolean = props.switchinset
	Dim xitemavatarclass As String = props.itemavatarclass
	'
	Dim xrightchip As String = props.rightchip
	Dim xrightchipcolor As String = props.rightchipcolor
	'
	DataSource = DataSource.ToLowerCase
	key = key.ToLowerCase
	Dim xrightitemavatarclass As String = props.rightitemavatarclass
	Dim xhref As String = props.href
	Dim xtarget As String = props.target
	If xhref = "" Then xhref = "href"
	If xtarget = "" Then xtarget = "target"
	
	'
	Dim sTemplate As String = $"<v-template id="${templateID}" v-for="(item, index) in ${DataSource}">
<v-subheader id="${headerID}" v-if="item.header">{{ item.header }}</v-subheader>
<v-divider id="${dividerID}" v-else-if="item.divider" :inset="item.inset"></v-divider>
<v-list-item id="${listitemID}" v-else="true" :key="item.${key}" :to="item.${xurl}" :href="item.${xhref}" :target="item.${xtarget}"  active-class="${xactiveclass}">
<v-list-item-action id="${leftactionID}" v-if="item.${xlefticon} || ${xshowleftcheckboxes} || ${xshowleftswitch}">
<v-btn id="${leftactionBtnID}" :icon="true" v-if="item.${xlefticon}">
<v-icon id="${leftactionIconID}" ${props.lefticonattr} :color="item.${xlefticoncolor}" v-html="item.${xlefticon}" class="${xlefticonclass}"></v-icon>
</v-btn>
<v-checkbox id="${leftcheckboxID}" ${props.leftcheckboxattr} v-if="${xshowleftcheckboxes}" :item="item" v-model="item.${xleftcheckbox}" :input-value="item.${xleftcheckbox}"></v-checkbox>
<v-switch id="${leftswitchID}" ${props.leftswitchattr} v-if="${xshowleftswitch}" :inset="${xswitchinset}" :item="item" v-model="item.${xleftswitch}" :input-value="item.${xleftswitch}"></v-switch>
</v-list-item-action>
<v-list-item-avatar id="${avatarID}" class="${xitemavatarclass}" v-if="item.${xavatar} || item.${xavataricon} || item.${props.avatartext}">
<v-img id="${avatarImgID}" ${props.avatarattr} :src="item.${xavatar}" class="${xavatarclass}" v-if="item.${xavatar}"></v-img>
<v-icon id="${avatarIconID}" ${props.avatariconattr} v-if="item.${xavataricon}" :color="item.${xavatariconcolor}" class="${xavatariconclass}" v-html="item.${xavataricon}"></v-icon>
<span id="${avatarTextID}" v-if="item.${props.avatartext}" :color="item.${props.avatartextcolor}" class="${props.avatartextclass}" v-html="item.${props.avatartext}"></span>
</v-list-item-avatar>
<v-list-item-icon id="${itemiconID}" v-if="item.${xicon}">
<v-icon id="${iconID}" ${props.iconattr} :color="item.${xiconcolor}" class="${xiconclass}" v-html="item.${xicon}"></v-icon>
</v-list-item-icon>
<v-list-item-content id="${contentID}" v-if="item.${xtitle} || item.${xsubtitle} || item.${xsubtitle1} || item.${xsubtitle2} || item.${xsubtitle3} || item.${xsubtitle4}">
<v-list-item-title id="${titleID}" v-if="item.${xtitle}" v-html="item.${xtitle}"></v-list-item-title>
<v-list-item-subtitle id="${subtitleID}" v-if="item.${xsubtitle}" v-html="item.${xsubtitle}"></v-list-item-subtitle>
<v-list-item-subtitle id="${subtitle1ID}" v-if="item.${xsubtitle1}" v-html="item.${xsubtitle1}"></v-list-item-subtitle>
<v-list-item-subtitle id="${subtitle2ID}" v-if="item.${xsubtitle2}" v-html="item.${xsubtitle2}"></v-list-item-subtitle>
<v-list-item-subtitle id="${subtitle3ID}" v-if="item.${xsubtitle3}" v-html="item.${xsubtitle3}"></v-list-item-subtitle>
<v-list-item-subtitle id="${subtitle4ID}" v-if="item.${xsubtitle4}" v-html="item.${xsubtitle4}"></v-list-item-subtitle>
</v-list-item-content>
<v-list-item-avatar id="${rightavatarID}" class="${xrightitemavatarclass}" v-if="item.${props.rightavatar} || item.${props.rightavataricon} || item.${props.rightavatartext}">
<v-img id="${rightavatarImgID}" ${props.rightavatarattr} :src="item.${props.rightavatar}" class="${props.rightavatarclass}" v-if="item.${props.rightavatar}"></v-img>
<v-icon id="${rightavatarIconID}" ${props.rightavatariconattr} v-if="item.${props.rightavataricon}" :color="item.${props.rightavatariconcolor}" class="${props.rightavatariconclass}" v-html="item.${props.rightavataricon}"></v-icon>
<span id="${rightavatarTextID}" v-if="item.${props.rightavatartext}" :color="item.${props.rightavatartextcolor}" class="${props.rightavatartextclass}" v-html="item.${props.rightavatartext}"></span>
</v-list-item-avatar>
<v-chip id="${rightchipID}" ${props.rightchipattr} v-if="item.${xrightchip}" :color="item.${xrightchipcolor}" dark small v-html="item.${xrightchip}"></v-chip>
<v-list-item-action id="${rightactionID}" v-if="item.${xrighticon} || item.${xrighttext} || ${xshowrightcheckboxes} || ${xshowrightrating} || ${xshowrightswitch}">
<v-list-item-action-text ${props.righttextattr} id="${rightactiontextID}" v-if="item.${xrighttext}" v-html="item.${xrighttext}"></v-list-item-action-text>
<v-btn id="${rightactionBtnID}" :icon="true" v-if="item.${xrighticon}">
<v-icon id="${rightactionIconID}" ${props.righticonattr} v-html="item.${xrighticon}" class="${xrighticonclass}" :color="item.${xrighticoncolor}"></v-icon>
</v-btn>
<v-checkbox id="${rightcheckboxID}" ${props.rightcheckboxattr} v-if="${xshowrightcheckboxes}" :item="item" v-model="item.${xrightcheckbox}" :input-value="item.${xrightcheckbox}"></v-checkbox>
<v-rating id="${rightratingID}" ${props.rightratingattr} length="1" v-if="${xshowrightrating}" v-model="item.${xrightrating}" :value="item.${xrightrating}"></v-rating>
<v-switch id="${rightswitchID}" ${props.rightswitchattr} v-if="${xshowrightswitch}" :inset="${xswitchinset}" :item="item" v-model="item.${xrightswitch}" :input-value="item.${xrightswitch}"></v-switch>
</v-list-item-action>
</v-list-item>
<v-divider v-if="${props.hasdivider}" :inset="${props.insetdivider}"></v-divider>
</v-template>"$
	
	'
	sTemplate = sTemplate.Replace("~","$")
	
	BANano.GetElement(parentID).Append(sTemplate)
	'
	Dim vlistitemx As VueElement
	vlistitemx.Initialize(mCallBack, listitemID, listitemID)
	Select Case numLines
	Case 2
		vlistitemx.AddAttr(":two-line", True)
	Case 3
		vlistitemx.AddAttr(":three-line", True)
	End Select
	vlistitemx.SetOnEventOwn(mCallBack, $"${elID}_click"$, "click", "item")
	'left action
	'
'	Dim vleftcheckbox As VueElement
'	vleftcheckbox.Initialize(mCallBack, leftcheckboxID, leftcheckboxID)
'	If xshowleftcheckboxes Then
'		vleftcheckbox.SetOnEventOwn(mCallBack, $"${elID}_leftclick"$, "click.stop", "item")
'	End If
	'
'	Dim vrightcheckbox As VueElement
'	vrightcheckbox.Initialize(mCallBack, rightcheckboxID, rightcheckboxID)
'	If xshowrightcheckboxes Then
'		vrightcheckbox.SetOnEventOwn(mCallBack, $"${elID}_rightclick"$, "click.stop", "item")
'	End If
	
	Dim vleftlistitemaction As VueElement
	vleftlistitemaction.Initialize(mCallBack, leftactionID, leftactionID)
	'If xshowleftcheckboxes = False And xshowleftswitch = False Then
		vleftlistitemaction.SetOnEventOwn(mCallBack, $"${elID}_leftclick"$, "click.stop", "item")
	'End If
	'
	Dim vrightlistitemaction As VueElement
	vrightlistitemaction.Initialize(mCallBack, rightactionID, rightactionID)
	'If xshowrightcheckboxes = False And xshowrightswitch = False Then
		vrightlistitemaction.SetOnEventOwn(mCallBack, $"${elID}_rightclick"$, "click.stop", "item")
	'End If
	'
'	Dim vleftswitch As VueElement
'	vleftswitch.Initialize(mCallBack, leftswitchID, leftswitchID)
'	'If xshowleftswitch Then 
	'	vleftswitch.SetOnEventOwn(mCallBack, $"${elID}_leftclick"$, "change.stop", "item")
	'End If
	'
'	Dim vrightswitch As VueElement
'	vrightswitch.Initialize(mCallBack, rightswitchID, rightswitchID)
	'If xshowrightswitch Then
	'	vrightswitch.SetOnEventOwn(mCallBack, $"${elID}_rightclick"$, "change.stop", "item")
	'End If
	
	VElement.SetData(DataSource, VElement.NewList)
	VElement.BindVueElement(vlistitemx)
	VElement.BindVueElement(vleftlistitemaction)
	VElement.BindVueElement(vrightlistitemaction)
'	vlistitem.BindVueElement(vleftcheckbox)
'	vlistitem.BindVueElement(vrightcheckbox)
'	vlistitem.BindVueElement(vrightswitch)
'	vlistitem.BindVueElement(vleftswitch)
	CleanUp
End Sub

private Sub CleanUp
	
If bUseIcon = False Then
		ListItemIcon1.Remove
End If

If bUseLeftAction = False Then
		ListItemLeftAction.Remove
Else
	If  bUseLeftActionButton = False Then
		ListItemLeftButton.Remove
	End If
	If  bUseLeftActionCheckBox = False Then
		ListItemLeftCheckBox.Remove
	End If
	If  bUseLeftActionSwitch = False Then
		ListItemLeftSwitch.Remove
	End If
End If

If  bUseLeftAvatar = False Then
	ListItemAvatar.Remove
Else
	If  bUseLeftAvatarIcon = False Then
		ListItemAvatarIcon.Remove
	End If
	If  bUseLeftAvatarImage = False Then
		ListItemAvatarImage.Remove	
	End If
	If  bUseLeftAvatarText = False Then
		ListItemAvatarText.Remove
	End If
End If

If  bUseRightAction = False Then
	ListItemRightAction.Remove
Else
	If  bUseRightActionButton = False Then
		ListItemRightButton.Remove
	End If
	If  bUseRightActionCheckBox = False Then
		ListItemRightCheckBox.Remove
	End If
	If  bUseRightActionRating = False Then
		ListItemRightRating.Remove
	End If
	If  bUseRightActionSwitch = False Then
		ListItemRightSwitch.Remove
	End If	
	If  bUseRightActionText = False Then
		ListItemRightText.Remove
	End If
End If

If  bUseRightAvatar = False Then
	ListItemRightAvatar.Remove
Else
	If  bUseRightAvatarIcon = False Then
		ListItemRightAvatarIcon.remove
	End If
	If  bUseRightAvatarImage = False Then
		ListItemRightAvatarImage.Remove
	End If
	If  bUseRightAvatarText = False Then
		ListItemRightAvatarText.Remove
	End If
End If
If  bUseRightChip = False Then
	ListItemRightChip.Remove
End If
If bUseSubTitle = False Then
	ListItemSubTitle.Remove
End If
If bUseSubTitle1 = False Then
	ListItemSubTitle1.Remove
End If
If bUseSubTitle2 = False Then
	ListItemSubTitle2.remove
End If
If bUseSubTitle3 = False Then
	ListItemSubTitle3.remove
End If
If bUseSubTitle4 = False Then
	ListItemSubTitle4.remove
End If
If bUseTitle = False Then
	ListItemTitle.Remove
End If
End Sub

Sub ListItemTitle As VueElement
	Return VElement.GetVueElement($"${mName}title"$)
End Sub

Sub ListItemSubTitle As VueElement
	Return VElement.GetVueElement($"${mName}subtitle"$)
End Sub

Sub ListItemSubTitle1 As VueElement
	Return VElement.GetVueElement($"${mName}subtitle1"$)
End Sub

Sub ListItemSubTitle2 As VueElement
	Return VElement.GetVueElement($"${mName}subtitle2"$)
End Sub

Sub ListItemSubTitle3 As VueElement
	Return VElement.GetVueElement($"${mName}subtitle3"$)
End Sub

Sub ListItemSubTitle4 As VueElement
	Return VElement.GetVueElement($"${mName}subtitle4"$)
End Sub

Sub ListItemRightChip As VueElement
	Return VElement.GetVueElement($"${mName}rightchip"$)
End Sub

Sub ListItemRightRating As VueElement
	Return VElement.GetVueElement($"${mName}rightrating"$)
End Sub

Sub ListItemRightText As VueElement
	Return VElement.GetVueElement($"${mName}rightactiontext"$)
End Sub

Sub ListItemLeftIcon As VueElement
	Return VElement.GetVueElement($"${mName}leftactionicon"$)
End Sub

Sub ListItemLeftCheckBox As VueElement
	Return VElement.GetVueElement($"${mName}leftcheckbox"$)
End Sub

Sub ListItemRightCheckBox As VueElement
	Return VElement.GetVueElement($"${mName}rightcheckbox"$)
End Sub

Sub ListItemIcon As VueElement
	Return VElement.GetVueElement($"${mName}icon"$)
End Sub

Sub ListItemIcon1 As VueElement
	Return VElement.GetVueElement($"${mName}itemicon"$)
End Sub

Sub ListItemRightIcon As VueElement
	Return VElement.GetVueElement($"${mName}rightactionicon"$)
End Sub

Sub ListItemLeftSwitch As VueElement
	Return VElement.GetVueElement($"${mName}leftswitch"$)
End Sub

Sub ListItemRightSwitch As VueElement
	Return VElement.GetVueElement($"${mName}rightswitch"$)
End Sub

Sub ListItem As VueElement
	Return VElement.GetVueElement($"${mName}listitem"$)
End Sub

Sub ListItemLeftAction As VueElement
	Return VElement.GetVueElement($"${mName}leftaction"$)
End Sub

Sub ListItemRightAction As VueElement
	Return VElement.GetVueElement($"${mName}rightaction"$)
End Sub

Sub ListItemAvatar As VueElement
	Return VElement.GetVueElement($"${mName}avatar"$)
End Sub

Sub ListItemAvatarImage As VueElement
	Return VElement.GetVueElement($"${mName}avatarimage"$)
End Sub

Sub ListItemAvatarIcon As VueElement
	Return VElement.GetVueElement($"${mName}avataricon"$)
End Sub

Sub ListItemContent As VueElement
	Return VElement.GetVueElement($"${mName}content"$)
End Sub

Sub ListItemRightAvatar As VueElement
	Return VElement.GetVueElement($"${mName}rightavatar"$)
End Sub

Sub ListItemRightAvatarImage As VueElement
	Return VElement.GetVueElement($"${mName}rightavatarimage"$)
End Sub

Sub ListItemRightAvatarIcon As VueElement
	Return VElement.GetVueElement($"${mName}rightavataricon"$)
End Sub

Sub ListItemAvatarText As VueElement
	Return VElement.GetVueElement($"${mName}avatartext"$)
End Sub

Sub ListItemRightAvatarText As VueElement
	Return VElement.GetVueElement($"${mName}rightavatartext"$)
End Sub

Sub ListItemLeftButton As VueElement
	Return VElement.GetVueElement($"${mName}leftactionbtn"$)
End Sub

Sub ListItemRightButton As VueElement
	Return VElement.GetVueElement($"${mName}rightactionbtn"$)
End Sub


'add a list view item
Sub AddItem(parent As String, key As String, iconName As String, iconColor As String, title As String, url As String) As VList
	parent = parent.ToLowerCase
	key = key.ToLowerCase
	'
	Dim nitem As Map = CreateMap()
	nitem.Put("id", key)
	If iconName <> "" Then nitem.Put("icon", iconName)
	If iconColor <> "" Then nitem.Put("iconcolor", iconColor)
	If title <> "" Then nitem.Put("title", title)
	If url <> "" Then nitem.Put("to", url)
	nitem.Put("parentid", parent)
	Records.Add(nitem)
	Return Me
End Sub

'the url should be replaced
Sub SetItemReplace(itemID As String) As VList
	Dim m As Map = CreateMap()
	m.Put("replace", True)
	BANanoShared.ListOfMapsUpdateRecord(Records, "id", itemID,  m)
	Return Me
End Sub

'the url should be appended
Sub SetItemAppend(itemID As String) As VList
	Dim m As Map = CreateMap()
	m.Put("append", True)
	BANanoShared.ListOfMapsUpdateRecord(Records, "id", itemID,  m)
	Return Me
End Sub

'update an icon in the list
Sub SetItemIcon(itemID As String, sIcon As String) As VList
	Dim m As Map = CreateMap()
	m.Put("icon", sIcon)
	BANanoShared.ListOfMapsUpdateRecord(Records, "id", itemID,  m)
	Return Me
End Sub

'update an iconcolor in the list
Sub SetItemIconColor(itemID As String, sIcon As String) As VList
	Dim m As Map = CreateMap()
	m.Put("iconcolor", sIcon)
	BANanoShared.ListOfMapsUpdateRecord(Records, "id", itemID,  m)
	Return Me
End Sub

'add a header to the lust
Sub AddItemHeader(txt As String)
	Dim rec As Map = CreateMap()
	rec.Put("header", txt)
	Records.Add(rec)
End Sub

'add a divider
Sub AddItemDivider(binset As Boolean)
	Dim rec As Map = CreateMap()
	rec.Put("divider", True)
	If binset Then 
		rec.Put("inset", binset)
	End If
	Records.Add(rec)
End Sub

Sub SetItemRightChip(itemID As String, sValue As String) As VList
	Dim m As Map = CreateMap()
	m.Put("rightchip", sValue)
	BANanoShared.ListOfMapsUpdateRecord(Records, "id", itemID,  m)
	Return Me
End Sub

Sub SetItemRightChipColor(itemID As String, xColor As String) As VList
	Dim m As Map = CreateMap()
	m.Put("rightchipcolor", xColor)
	BANanoShared.ListOfMapsUpdateRecord(Records, "id", itemID,  m)
	Return Me
End Sub

Sub SetItemAvatar(itemID As String, sIcon As String) As VList
	Dim m As Map = CreateMap()
	m.Put("avatar", sIcon)
	BANanoShared.ListOfMapsUpdateRecord(Records, "id", itemID,  m)
	Return Me
End Sub

Sub SetItemTitle(itemID As String, sIcon As String) As VList
	Dim m As Map = CreateMap()
	m.Put("title", sIcon)
	BANanoShared.ListOfMapsUpdateRecord(Records, "id", itemID,  m)
	Return Me
End Sub

Sub SetItemSubTitle(itemID As String, sIcon As String) As VList
	Dim m As Map = CreateMap()
	m.Put("subtitle", sIcon)
	BANanoShared.ListOfMapsUpdateRecord(Records, "id", itemID,  m)
	Return Me
End Sub

Sub SetItemHREF(itemID As String, sHREF As String) As VList
	Dim m As Map = CreateMap()
	m.Put("href", sHREF)
	BANanoShared.ListOfMapsUpdateRecord(Records, "id", itemID,  m)
	Return Me
End Sub

Sub SetItemTarget(itemID As String, sTarget As String) As VList
	Dim m As Map = CreateMap()
	m.Put("target", sTarget)
	BANanoShared.ListOfMapsUpdateRecord(Records, "id", itemID,  m)
	Return Me
End Sub

Sub SetItemSubTitle1(itemID As String, sIcon As String) As VList
	Dim m As Map = CreateMap()
	m.Put("subtitle1", sIcon)
	BANanoShared.ListOfMapsUpdateRecord(Records, "id", itemID,  m)
	Return Me
End Sub

Sub SetItemRightIcon(itemID As String, sIcon As String) As VList
	Dim m As Map = CreateMap()
	m.Put("righticon", sIcon)
	BANanoShared.ListOfMapsUpdateRecord(Records, "id", itemID,  m)
	Return Me
End Sub

Sub SetItemRightText(itemID As String, sIcon As String) As VList
	Dim m As Map = CreateMap()
	m.Put("righttext", sIcon)
	BANanoShared.ListOfMapsUpdateRecord(Records, "id", itemID,  m)
	Return Me
End Sub

Sub SetItemRightIconColor(itemID As String, sIcon As String) As VList
	Dim m As Map = CreateMap()
	m.Put("righticoncolor", sIcon)
	BANanoShared.ListOfMapsUpdateRecord(Records, "id", itemID,  m)
	Return Me
End Sub

Sub SetItemRightRating(itemID As String, sIcon As String) As VList
	Dim m As Map = CreateMap()
	m.Put("rightrating", sIcon)
	BANanoShared.ListOfMapsUpdateRecord(Records, "id", itemID,  m)
	Return Me
End Sub

Sub SetItemTo(itemID As String, sTo As String) As VList
	Dim m As Map = CreateMap()
	m.Put("to", sTo)
	BANanoShared.ListOfMapsUpdateRecord(Records, "id", itemID,  m)
	Return Me
End Sub

Sub SetItemLeftIcon(itemID As String, sIcon As String) As VList
	Dim m As Map = CreateMap()
	m.Put("lefticon", sIcon)
	BANanoShared.ListOfMapsUpdateRecord(Records, "id", itemID,  m)
	Return Me
End Sub

Sub SetItemLeftIconColor(itemID As String, sIcon As String) As VList
	Dim m As Map = CreateMap()
	m.Put("lefticoncolor", sIcon)
	BANanoShared.ListOfMapsUpdateRecord(Records, "id", itemID,  m)
	Return Me
End Sub

Sub SetItemLeftCheckBox(itemID As String, bChecked As Boolean) As VList
	Dim m As Map = CreateMap()
	m.Put("leftcheckbox", bChecked)
	BANanoShared.ListOfMapsUpdateRecord(Records, "id", itemID,  m)
	Return Me
End Sub

Sub SetItemLeftSwitch(itemID As String, bChecked As Boolean) As VList
	Dim m As Map = CreateMap()
	m.Put("leftswitch", bChecked)
	BANanoShared.ListOfMapsUpdateRecord(Records, "id", itemID,  m)
	Return Me
End Sub

Sub SetItemRightSwitch(itemID As String, bChecked As Boolean) As VList
	Dim m As Map = CreateMap()
	m.Put("rightswitch", bChecked)
	BANanoShared.ListOfMapsUpdateRecord(Records, "id", itemID,  m)
	Return Me
End Sub

Sub SetItemRightCheckBox(itemID As String, bChecked As Boolean) As VList
	Dim m As Map = CreateMap()
	m.Put("rightcheckbox", bChecked)
	BANanoShared.ListOfMapsUpdateRecord(Records, "id", itemID,  m)
	Return Me
End Sub

Sub AddItemLeftCheckBox(id As String, bChecked As Boolean, title As String, subtitle As String, subtitle1 As String)
	Dim rec As Map = CreateMap()
	rec.Put("id", id)
	rec.Put("leftcheckbox", bChecked)
	If title <> "" Then rec.Put("title", title)
	If subtitle <> "" Then rec.Put("subtitle", subtitle)
	If subtitle1 <> "" Then rec.Put("subtitle1", subtitle1)
	Records.Add(rec)
End Sub

Sub AddItemLeftSwitch(id As String, bChecked As Boolean, title As String, subtitle As String, subtitle1 As String)
	Dim rec As Map = CreateMap()
	rec.Put("id", id)
	rec.Put("leftswitch", bChecked)
	If title <> "" Then rec.Put("title", title)
	If subtitle <> "" Then rec.Put("subtitle", subtitle)
	If subtitle1 <> "" Then rec.Put("subtitle1", subtitle1)
	Records.Add(rec)
End Sub

Sub AddItemRightSwitch(id As String, bChecked As Boolean, title As String, subtitle As String, subtitle1 As String)
	Dim rec As Map = CreateMap()
	rec.Put("id", id)
	rec.Put("rightswitch", bChecked)
	If title <> "" Then rec.Put("title", title)
	If subtitle <> "" Then rec.Put("subtitle", subtitle)
	If subtitle1 <> "" Then rec.Put("subtitle1", subtitle1)
	Records.Add(rec)
End Sub

Sub AddItemRightCheckBox(id As String, bChecked As Boolean, title As String, subtitle As String, subtitle1 As String)
	Dim rec As Map = CreateMap()
	rec.Put("id", id)
	rec.Put("rightcheckbox", bChecked)
	If title <> "" Then rec.Put("title", title)
	If subtitle <> "" Then rec.Put("subtitle", subtitle)
	If subtitle1 <> "" Then rec.Put("subtitle1", subtitle1)
	Records.Add(rec)
End Sub

'get checked / unchecked preferences
Sub GetPreferencesChecked(VC As VueComponent, bShouldBe As Boolean) As List
	Dim nl As List
	nl.Initialize 
	Dim ds As String = DataSource
	Dim rs1 As List = VC.GetData(ds)
	For Each rsm As Map In rs1
		Dim sid As String = rsm.Get("id")
		Dim brs As Boolean = False
		If rsm.ContainsKey("leftcheckbox") Then
			brs = rsm.Get("leftcheckbox")
			If brs = bShouldBe Then nl.Add(sid)
		End If
		If rsm.ContainsKey("rightcheckbox") Then
			brs = rsm.Get("rightcheckbox")
			If brs = bShouldBe Then nl.Add(sid)
		End If
		If rsm.ContainsKey("rightswitch") Then
			brs = rsm.Get("rightswitch")
			If brs = bShouldBe Then nl.Add(sid)
		End If
		If rsm.ContainsKey("leftswitch") Then
			brs = rsm.Get("leftswitch")
			If brs = bShouldBe Then nl.Add(sid)
		End If
	Next
	Return nl
End Sub

'Check/Uncheck preferences
Sub SetPreferencesChecked(VC As VueComponent, bShouldBe As Boolean)
	Dim ds As String = DataSource
	Dim rs1 As List = VC.GetData(ds)
	Dim rsTot As Int = rs1.Size - 1
	Dim rsCnt As Int
	For rsCnt = 0 To rsTot
		Dim rsm As Map = rs1.Get(rsCnt)
		If rsm.ContainsKey("leftcheckbox") Then
			rsm.put("leftcheckbox", bShouldBe)
		End If
		If rsm.ContainsKey("rightcheckbox") Then
			rsm.put("rightcheckbox", bShouldBe)
		End If
		If rsm.ContainsKey("rightswitch") Then
			rsm.put("rightswitch", bShouldBe)
		End If
		If rsm.ContainsKey("leftswitch") Then
			rsm.put("leftswitch", bShouldBe)
		End If
		rs1.Set(rsCnt, rsm)
	Next
	VC.SetData(ds, rs1)
End Sub

Sub GetPreferences(VC As VueComponent) As Map
	Dim nm As Map = CreateMap()
	Dim ds As String = DataSource
	Dim rs1 As List = VC.GetData(ds)
	For Each rsm As Map In rs1
		Dim sid As String = rsm.Get("id")
		Dim brs As Boolean = False
		If rsm.ContainsKey("leftcheckbox") Then
			brs = rsm.Get("leftcheckbox")
			nm.Put(sid, brs)
		End If
		If rsm.ContainsKey("rightcheckbox") Then
			brs = rsm.Get("rightcheckbox")
			nm.Put(sid, brs)
		End If
		If rsm.ContainsKey("rightswitch") Then
			brs = rsm.Get("rightswitch")
			nm.Put(sid, brs)
		End If
		If rsm.ContainsKey("leftswitch") Then
			brs = rsm.Get("leftswitch")
			nm.Put(sid, brs)
		End If
	Next
	Return nm
End Sub

Sub SetPreferences(VC As VueComponent, prefM As Map)
	Dim ds As String = DataSource
	Dim rs1 As List = VC.GetData(ds)
	Dim rsTot As Int = rs1.Size - 1
	Dim rsCnt As Int
	For rsCnt = 0 To rsTot
		Dim rsm As Map = rs1.Get(rsCnt)
		Dim sid As String = rsm.Get("id")
		Dim brs As Boolean = False
		If prefM.ContainsKey(sid) Then
			brs = prefM.Get(sid)
			If rsm.ContainsKey("leftcheckbox") Then 
				rsm.Put("leftcheckbox", brs)
			End If	
			If rsm.ContainsKey("rightcheckbox") Then 
				rsm.Put("rightcheckbox", brs)
			End If
			If rsm.ContainsKey("rightswitch") Then 
				rsm.Put("rightswitch", brs)
			End If
			If rsm.ContainsKey("leftswitch") Then
				rsm.Put("leftswitch", brs)
			End If
			rs1.Set(rsCnt, rsm)
		End If
	Next
	VC.SetData(ds, rs1)
End Sub

Sub SetItemAvatarIcon(itemID As String, bChecked As Boolean) As VList
	Dim m As Map = CreateMap()
	m.Put("avataricon", bChecked)
	BANanoShared.ListOfMapsUpdateRecord(Records, "id", itemID,  m)
	Return Me
End Sub

Sub SetItemAvatarIconColor(itemID As String, bChecked As Boolean) As VList
	Dim m As Map = CreateMap()
	m.Put("avatariconcolor", bChecked)
	BANanoShared.ListOfMapsUpdateRecord(Records, "id", itemID,  m)
	Return Me
End Sub

'create a BVAD3ListItem
Sub CreateListItem(id As String) As BVAD3ListItem
	Dim item As BVAD3ListItem
	item.Initialize(id)
	Return item
End Sub

'add an item to the listview usin BVAD3ListItem
Sub AddItem1(item As BVAD3ListItem) As VList
	Dim rec As Map = item.Item
	Records.Add(rec)
	Return Me
End Sub

'add an item using a map
Sub AddItem2(rec As Map) As VList
	Records.Add(rec)
	Return Me
End Sub

Sub BindVueElement(VE As VueElement)
	VElement.BindVueElement(VE)
End Sub

'add an item at realtime
Sub AddItem3(VC As VueComponent, rowData As Map)
	VC.SetDataPush(DataSource, rowData)
End Sub

'remove item at position
Sub RemoveItemAtPosition(VC As VueComponent, pos As Int)
	If pos >= 0 Then
		VC.SetDataSpliceRemove(DataSource, pos, 1)
	End If
End Sub

'remove an item where
Sub RemoveItem(VC As VueComponent, prop As String, value As String)
	Dim m As Map = CreateMap()
	m.Put(prop, value)
	'find the record at a position
	Dim mpos As Int = VC.GetDataPositionWhere(DataSource, m)
	If mpos >= 0 Then
		VC.SetDataSpliceRemove(DataSource, mpos, 1)
	End If
End Sub

'update item where
Sub UpdateItem(VC As VueComponent, prop As String, value As String, item As Map)
	Dim m As Map = CreateMap()
	m.Put(prop, value)
	'find the record at a position
	Dim mpos As Int = VC.GetDataPositionWhere(DataSource, m)
	If mpos >= 0 Then
		Dim oldm As Map = FindItemAtPosition(VC, mpos)
		oldm = BANanoShared.Merge(oldm, item)
		VC.SetDataSplice(DataSource, mpos, 1, oldm)
	End If
End Sub

'update item where
Sub UpdateItemAtPosition(VC As VueComponent, pos As Int, item As Map)
	If pos >= 0 Then
		Dim oldm As Map = FindItemAtPosition(VC, pos)
		oldm = BANanoShared.Merge(oldm, item)
		VC.SetDataSplice(DataSource, pos, 1, oldm)
	End If
End Sub

'get data where
Sub FindItem(VC As VueComponent, whereMap As Map) As Map
	Dim rm As Map = CreateMap()
	'find the item
	Dim recpos As Int = VC.GetDataPositionWhere(DataSource, whereMap)
	If recpos = -1 Then Return rm
	Dim recs As List = VC.GetData(DataSource)
	Dim rec As Map = recs.Get(recpos)
	Return rec
End Sub

'find item at position
Sub FindItemAtPosition(VC As VueComponent, pos As Int) As Map
	Dim recs As List = VC.GetData(DataSource)
	Dim rec As Map = recs.Get(pos)
	Return rec
End Sub

'find item position
Sub FindItemPosition(VC As VueComponent, whereMap As Map) As Int
	Dim mpos As Int = VC.GetDataPositionWhere(DataSource, whereMap)
	Return mpos
End Sub


Sub BindState(VC As VueComponent)
	Dim mbindings As Map = VElement.bindings
	Dim mmethods As Map = VElement.methods
	'apply the binding for the control
	For Each k As String In mbindings.Keys
		Dim v As Object = mbindings.Get(k)
		Select Case k
		Case "key"
		Case Else
			VC.SetData(k, v)
		End Select
	Next
	'apply the events
	For Each k As String In mmethods.Keys
		Dim cb As BANanoObject = mmethods.Get(k)
		VC.SetCallBack(k, cb)
	Next
End Sub


'read an item where
Sub Read(V As VueComponent, prop As String, value As String) As Map
	Dim m As Map = CreateMap()
	m.Put(prop, value)
	'find the record at a position
	Dim mpos As Int = V.GetDataPositionWhere(DataSource, m)
	Dim res As Map = CreateMap()
	If mpos >= 0 Then
		res = FindItemAtPosition(V, mpos)
	End If
	Return res
End Sub

'add a new row at the end of the items in realtime
Sub Add(V As VueComponent, rowdata As Map)
	V.SetDataPush(DataSource, rowdata)
End Sub

'add a row at the top of the list
Sub AddOnTop(V As VueComponent, rowdata As Map)
	V.SetDataUnshift(DataSource, rowdata)
End Sub

'remove an item where
Sub Delete(V As VueComponent, prop As String, value As String)
	Dim m As Map = CreateMap()
	m.Put(prop, value)
	'find the record at a position
	Dim mpos As Int = V.GetDataPositionWhere(DataSource, m)
	If mpos >= 0 Then
		V.SetDataSpliceRemove(DataSource, mpos, 1)
	End If
End Sub

'update item where
Sub Update(V As VueComponent, prop As String, value As String, item As Map)
	Dim m As Map = CreateMap()
	m.Put(prop, value)
	'find the record at a position
	Dim mpos As Int = V.GetDataPositionWhere(DataSource, m)
	If mpos >= 0 Then
		Dim oldm As Map = FindItemAtPosition(V, mpos)
		oldm = BANanoShared.Merge(oldm, item)
		V.SetDataSplice(DataSource, mpos, 1, oldm)
	End If
End Sub
