!function(root,factory){if("function"==typeof define&&define.amd)define([],factory);else if("function"==typeof define)define(factory);else if("undefined"!=typeof module&&module.exports){var jsZip=require("jszip"),fs=require("fs");module.exports=factory(jsZip,fs)}else root.oxml=factory()}(this,(function(_jsZip,_fs){var requirejs,require,define;return function(e){function n(e,n){return m.call(e,n)}function r(e,n){var r,i,t,o,u,f,l,c,s,p,a,d=n&&n.split("/"),h=g.map,m=h&&h["*"]||{};if(e){for(u=(e=e.split("/")).length-1,g.nodeIdCompat&&y.test(e[u])&&(e[u]=e[u].replace(y,"")),"."===e[0].charAt(0)&&d&&(e=d.slice(0,d.length-1).concat(e)),s=0;s<e.length;s++)if("."===(a=e[s]))e.splice(s,1),s-=1;else if(".."===a){if(0===s||1===s&&".."===e[2]||".."===e[s-1])continue;s>0&&(e.splice(s-1,2),s-=2)}e=e.join("/")}if((d||m)&&h){for(s=(r=e.split("/")).length;s>0;s-=1){if(i=r.slice(0,s).join("/"),d)for(p=d.length;p>0;p-=1)if((t=h[d.slice(0,p).join("/")])&&(t=t[i])){o=t,f=s;break}if(o)break;!l&&m&&m[i]&&(l=m[i],c=s)}!o&&l&&(o=l,f=c),o&&(r.splice(0,f,o),e=r.join("/"))}return e}function i(n,r){return function(){var i=v.call(arguments,0);return"string"!=typeof i[0]&&1===i.length&&i.push(null),c.apply(e,i.concat([n,r]))}}function t(e){return function(n){a[e]=n}}function o(r){if(n(d,r)){var i=d[r];delete d[r],h[r]=!0,l.apply(e,i)}if(!n(a,r)&&!n(h,r))throw new Error("No "+r);return a[r]}function u(e){var n,r=e?e.indexOf("!"):-1;return r>-1&&(n=e.substring(0,r),e=e.substring(r+1,e.length)),[n,e]}function f(e){return e?u(e):[]}var l,c,s,p,a={},d={},g={},h={},m=Object.prototype.hasOwnProperty,v=[].slice,y=/\.js$/;s=function(e,n){var i,t=u(e),f=t[0],l=n[1];return e=t[1],f&&(i=o(f=r(f,l))),f?e=i&&i.normalize?i.normalize(e,function(e){return function(n){return r(n,e)}}(l)):r(e,l):(f=(t=u(e=r(e,l)))[0],e=t[1],f&&(i=o(f))),{f:f?f+"!"+e:e,n:e,pr:f,p:i}},p={require:function(e){return i(e)},exports:function(e){var n=a[e];return void 0!==n?n:a[e]={}},module:function(e){return{id:e,uri:"",exports:a[e],config:function(e){return function(){return g&&g.config&&g.config[e]||{}}}(e)}}},l=function(r,u,l,c){var g,m,v,y,j,q,x,b=[],w=typeof l;if(q=f(c=c||r),"undefined"===w||"function"===w){for(u=!u.length&&l.length?["require","exports","module"]:u,j=0;j<u.length;j+=1)if("require"===(m=(y=s(u[j],q)).f))b[j]=p.require(r);else if("exports"===m)b[j]=p.exports(r),x=!0;else if("module"===m)g=b[j]=p.module(r);else if(n(a,m)||n(d,m)||n(h,m))b[j]=o(m);else{if(!y.p)throw new Error(r+" missing "+m);y.p.load(y.n,i(c,!0),t(m),{}),b[j]=a[m]}v=l?l.apply(a[r],b):void 0,r&&(g&&g.exports!==e&&g.exports!==a[r]?a[r]=g.exports:v===e&&x||(a[r]=v))}else r&&(a[r]=l)},requirejs=require=c=function(n,r,i,t,u){if("string"==typeof n)return p[n]?p[n](r):o(s(n,f(r)).f);if(!n.splice){if((g=n).deps&&c(g.deps,g.callback),!r)return;r.splice?(n=r,r=i,i=null):n=e}return r=r||function(){},"function"==typeof i&&(i=t,t=u),t?l(e,n,r,i):setTimeout((function(){l(e,n,r,i)}),4),c},c.config=function(e){return c(e)},requirejs._defined=a,(define=function(e,r,i){if("string"!=typeof e)throw new Error("See almond README: incorrect module build, no module name");r.splice||(i=r,r=[]),n(a,e)||n(d,e)||(d[e]=[e,r,i])}).amd={jQuery:!0}}(),define("build/almond",(function(){})),define("fileHandler",[],(function(){"use strict";var FileHandler=function(){this.className="FileHandler"},CompressedFile,addFile,saveFile;return FileHandler.prototype=((CompressedFile=function(zip,fs){this.className="CompressedFile",this._zip=zip,this._fs=fs}).prototype={addFile:function(content,fileName,filePath,options){var path;filePath&&(path=this._zip.folder(filePath)),options?(path||this._zip).file(fileName,content,options):(path||this._zip).file(fileName,content)},saveFile:function(fileName,callback){var zip=this._zip,fs=this._fs;return"undefined"!=typeof window?zip.generateAsync({type:"blob",mimeType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}).then((function(content){try{if(window.saveAs)return saveAs(content,fileName);var url=window.URL.createObjectURL(content),element=document.createElement("a");if(element.setAttribute("href",url),element.setAttribute("download",fileName),element.style.display="none",document.body.appendChild(element),element.click(),document.body.removeChild(element),callback)callback(zip);else if("undefined"!=typeof Promise)return new Promise((function(resolve,reject){resolve(zip)}))}catch(err){if(callback)callback(null,"Err: Not able to create file object.");else if("undefined"!=typeof Promise)return new Promise((function(resolve,reject){reject("Err: Not able to create file object.")}))}})):callback?(zip.generateNodeStream({type:"nodebuffer",streamFiles:!0}).pipe(fs.createWriteStream(fileName)),void callback(zip)):new Promise((function(resolve,reject){zip.generateNodeStream({type:"nodebuffer",streamFiles:!0}).pipe(fs.createWriteStream(fileName)),resolve(zip)}))}},{createFile:function(zip,fs){return new CompressedFile(zip,fs)}}),FileHandler})),define("contentFile",[],(function(){var ContentFile=function(file){this.className="ContentFile",this._file=file},attach;return ContentFile.prototype={attach:function(zipFile){var fileContent=this.generateContent(zipFile);zipFile.addFile(fileContent,this.fileName,this.folderName),this.attachChild&&this.attachChild(zipFile)}},ContentFile})),define("contentString",[],(function(){var ContentString=function(template){template&&(this.template=template)},format,toString;return ContentString.prototype={format:function(){var args=arguments;return this.template=this.template.replace(/{(\d+)}/g,(function(match,number){return void 0!==args[number]?args[number]:match})),this.template},toString:function(){return this.template}},ContentString})),define("xmlContentString",["contentString"],(function(ContentString){var XMLContentString=function(options){this.className="XMLContentString",this.rootNode=options.rootNode,this.nameSpaces=options.nameSpaces,this.template='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>';for(var contentTemplate=new ContentString("<{0}{1}{3}>{2}</{0}>"),nameSpaceContent="",attributes="",index=0;index<this.nameSpaces.length;index++){var nameSpaceTemplate=new ContentString(' xmlns{0}="{1}"');"string"==typeof this.nameSpaces[index]?nameSpaceContent+=nameSpaceTemplate.format("",this.nameSpaces[index]):nameSpaceContent+=nameSpaceTemplate.format(this.nameSpaces[index].attribute?":"+this.nameSpaces[index].attribute:"",this.nameSpaces[index].value)}if(options.attributes)for(var attr in options.attributes){var attributesContent;attributes+=new ContentString(' {0}="{1}"').format(attr,options.attributes[attr])}this.template+=contentTemplate.format(this.rootNode,nameSpaceContent,"{0}",attributes)};return XMLContentString.prototype=Object.create(ContentString.prototype),XMLContentString})),define("oxml_rels",["contentFile","contentString","xmlContentString"],(function(ContentFile,ContentString,XMLContentString){"use strict";var Relation=function(fileName,folderName){this.className="Relation",this.fileName=fileName,this.folderName=folderName,this.relations=[]};return(Relation.prototype=Object.create(ContentFile.prototype)).addRelation=function(id,type,target){this.relations.push({Id:id,Type:type,Target:target})},Relation.prototype.generateContent=function(){var template=new XMLContentString({rootNode:"Relationships",nameSpaces:["http://schemas.openxmlformats.org/package/2006/relationships"]}),index,rels="";for(index=0;index<this.relations.length;index++){var relationTemplate;rels+=new ContentString('<Relationship Id="{0}" Type="{1}" Target="{2}"/>').format(this.relations[index].Id,this.relations[index].Type,this.relations[index].Target)}return template.format(rels)},{createRelation:function(fileName,folderName){return new Relation(fileName,folderName)}}})),define("oxml_content_types",["contentFile","contentString","xmlContentString"],(function(ContentFile,ContentString,XMLContentString){"use strict";var ContentTypes=function(){this.className="ContentTypes",this._contentType={contentTypes:[]},this.fileName="[Content_Types].xml"};return(ContentTypes.prototype=Object.create(ContentFile.prototype)).generateContent=function(){var template=new XMLContentString({rootNode:"Types",nameSpaces:["http://schemas.openxmlformats.org/package/2006/content-types"]}),index,contentTypes="";for(index=0;index<this._contentType.contentTypes.length;index++){var contentTypeTemplate=new ContentString('<{0} ContentType="{1}"{2}{3}/>'),contentType=this._contentType.contentTypes[index];contentTypes+=contentTypeTemplate.format(contentType.name,contentType.contentType,contentType.Extension?' Extension="'+contentType.Extension+'"':"",contentType.PartName?' PartName="'+contentType.PartName+'"':"")}return template.format(contentTypes)},ContentTypes.prototype.addContentType=function(name,contentType,attributes){var content={name:name,contentType:contentType};for(var key in attributes)content[key]=attributes[key];this._contentType.contentTypes.push(content)},{createContentType:function(){return new ContentTypes}}})),define("oxml_table",["xmlContentString","contentFile"],(function(XMLContentString,ContentFile){"use strict";var Table=function(displayName,fromCell,toCell,columns,relId,options,_sheet){var rowFrom=parseInt(fromCell.match(/\d+/)[0],10),rowTo=parseInt(toCell.match(/\d+/)[0],10),columnFrom=fromCell.match(/\D+/)[0].toUpperCase().charCodeAt()-64,columnTo=toCell.match(/\D+/)[0].toUpperCase().charCodeAt()-64,_table={rid:relId,displayName:displayName,columns:columns,fromCell:fromCell,toCell:toCell,fromRow:rowFrom,toRow:rowTo,fromColumn:columnFrom,toColumn:columnTo};applyOptions(options,_table,_sheet),this.className="Table",this.fileName="table"+relId+".xml",this.folderName="workbook/tables",this._table=_table,this.rid=relId,this._sheet=_sheet};(Table.prototype=Object.create(ContentFile.prototype)).generateContent=function(){var template=new XMLContentString({rootNode:"table",nameSpaces:["http://schemas.openxmlformats.org/spreadsheetml/2006/main"],attributes:{totalsRowShown:"0",ref:this._table.fromCell+":"+this._table.toCell,displayName:this._table.displayName,name:this._table.displayName,id:this._table.rid}}),tableContent="";if(this._table.filters){tableContent+='<autoFilter ref="'+this._table.fromCell+":"+this._table.toCell+'">';for(var index=0;index<this._table.filters.length;index++){if(tableContent+='<filterColumn colId="'+this._table.filters[index].column+'">',"default"===this._table.filters[index].values[0].type){tableContent+="<filters>";for(var index2=0;index2<this._table.filters[index].values.length;index2++)tableContent+='<filter val="'+this._table.filters[index].values[index2].value+'"/>';tableContent+="</filters>"}else if("custom"===this._table.filters[index].values[0].type){tableContent+='<customFilters and="'+(this._table.filters[index].values[0].and?"1":"0")+'">';for(var index2=0;index2<this._table.filters[index].values.length;index2++)tableContent+='<customFilter operator="'+this._table.filters[index].values[index2].operator+'" val="'+this._table.filters[index].values[index2].value+'"/>';tableContent+="</customFilters>"}tableContent+="</filterColumn>"}tableContent+="</autoFilter>"}this._table.sort&&(tableContent+='<sortState caseSensitive="'+(this._table.sort.caseSensitive?"1":"0")+'" ref="'+this._table.sort.dataRange+'">',tableContent+="<sortCondition"+("ascending"===this._table.sort.direction?"":' descending="1"')+' ref="'+this._table.sort.range+'"/>',tableContent+="</sortState>"),tableContent+='<tableColumns count="'+this._table.columns.length+'">';for(var index=0;index<this._table.columns.length;index++)tableContent+='<tableColumn name="'+this._table.columns[index]+'" id="'+(index+1)+'"/>';var tableStyle="";return this._table.tableStyle&&(tableStyle='<tableStyleInfo name="'+this._table.tableStyle.name+'" showColumnStripes="'+(this._table.tableStyle.showColumnStripes?"1":"0")+'" showRowStripes="'+(this._table.tableStyle.showRowStripes?"1":"0")+'" showLastColumn="'+(this._table.tableStyle.showLastColumn?"1":"0")+'" showFirstColumn="'+(this._table.tableStyle.showFirstColumn?"1":"0")+'"/>'),tableContent+="</tableColumns>"+tableStyle,template.format(tableContent)},Table.prototype.tableOptions=function(){return tableOptions(this._table,this._sheet,this.relId)};var applyFilter=function(options,_table,_sheet){if(_table.filters||(_table.filters=[]),"object"==typeof options.filters&&options.filters.length)for(var index=0;index<options.filters.length;index++)if(options.filters[index].column){var values;if(options.filters[index].value)(values=[]).push({value:options.filters[index].value,type:options.filters[index].type||"default",operator:options.filters[index].operator||null,and:!1!==options.filters[index].and}),hideRows(_sheet,options.filters[index].column-1,[options.filters[index].value],_table.fromCell,_table.toCell,options.filters[index].operator);else if(options.filters[index].values&&"object"==typeof options.filters[index].values&&options.filters[index].values.length){values=[];for(var index2=0;index2<options.filters[index].values.length;index2++)values.push({value:options.filters[index].values[index2],type:options.filters[index].type||"default",operator:options.filters[index].operator||null,and:!1!==options.filters[index].and});hideRows(_sheet,options.filters[index].column-1,options.filters[index].values,_table.fromCell,_table.toCell,options.filters[index].operator)}_table.filters.push({column:options.filters[index].column-1,values:values})}},applySort=function(options,_table){var sort={},columnFrom=_table.fromColumn-1,columnTo=_table.toColumn-1,rowFrom=_table.fromRow,rowTo=_table.toRow;"number"==typeof options.sort?(columnFrom=String.fromCharCode(options.sort+columnFrom+64),sort.direction="ascending",sort.caseSensitive=!0):"object"==typeof options.sort&&!options.sort.length&&options.sort.column&&(columnFrom=String.fromCharCode(options.sort.column+columnFrom+64),sort.direction=options.sort.direction||"ascending",sort.caseSensitive=void 0===options.sort.caseSensitive||options.sort.caseSensitive),sort.range=columnFrom+(rowFrom+1)+":"+columnFrom+rowTo,sort.dataRange=String.fromCharCode(_table.fromColumn+64)+(rowFrom+1)+":"+String.fromCharCode(columnTo+65)+rowTo,_table.sort=sort},applyOptions=function(options,_table,_sheet){options&&(options.filters&&applyFilter(options,_table,_sheet),options.sort&&applySort(options,_table))},hideRows=function(_sheet,column,values,fromCell,toCell,operator){var rowFrom=parseInt(fromCell.match(/\d+/)[0],10),rowTo=parseInt(toCell.match(/\d+/)[0],10),columnFrom;column+=fromCell.match(/\D+/)[0].toUpperCase().charCodeAt()-65;for(var index=rowFrom;index<rowTo;index++){var isHidden=!1;if(_sheet.values[index])if(!operator||"greaterThan"!==operator&&"greaterThanOrEqual"!==operator&&"lessThan"!==operator&&"lessThanOrEqual"!==operator)isHidden="notEqual"===operator?values.indexOf(_sheet.values[index][column].value)>-1:!(values.indexOf(_sheet.values[index][column].value)>-1);else{isHidden=!0;for(var index2=0;index2<values.length;index2++){switch(operator){case"greaterThan":_sheet.values[index][column].value>values[index2]&&(isHidden=!1);break;case"greaterThanOrEqual":case"lessThan":case"lessThanOrEqual":_sheet.values[index][column].value>=values[index2]&&(isHidden=!1)}if(!isHidden)break}}isHidden&&(_sheet.values[index].hidden=!0)}},style=function(options,tableStyleName,_sheet,_table){var _styles,savedStyle=_sheet._workBook.createStyles().addTableStyle(options,tableStyleName,_table);_table.tableStyle={name:tableStyleName,showColumnStripes:!(!savedStyle.evenColumn&&!savedStyle.oddColumn),showRowStripes:!(!savedStyle.evenRow&&!savedStyle.oddRow),showLastColumn:!!savedStyle.lastColumn,showFirstColumn:!!savedStyle.firstColumn}},tableOptions=function(_table,_sheet,relId){return{name:_table.displayName,columns:_table.columns,fromCell:_table.fromCell,toCell:_table.toCell,sort:_table.sort,filters:_table.filters,set:function(options){return applyOptions(options,_table,_sheet),tableOptions(_table,_sheet,relId)},style:function(options,tableStyleName){return tableStyleName||(tableStyleName="customTableStyle"+relId),style(options,tableStyleName,_sheet,_table),tableOptions(_table,_sheet,relId)}}};return{addTable:function(displayName,fromCell,toCell,columns,relId,options,_sheet){return new Table(displayName,fromCell,toCell,columns,relId,options,_sheet)}}})),define("oxml_sheet",["oxml_table","oxml_rels","xmlContentString","contentFile"],(function(oxmlTable,OxmlRels,XMLContentString,ContentFile){"use strict";var Sheet=function(sheetName,sheetId,rId,workBook,xlsxContentTypes){this.className="Worksheet",this.fileName="sheet"+sheetId+".xml",this.folderName="workbook/sheets",this.xlsxContentTypes=xlsxContentTypes,this._sheet={sheetName:sheetName,sheetId:sheetId,rId:rId,values:[],_workBook:workBook}};Sheet.prototype=Object.create(ContentFile.prototype);var cellString=function(value,cellIndex,rowIndex,columnIndex){if(!value)return"";var styleString=value.styleIndex?'s="'+value.styleIndex+'"':"";if("numeric"===value.type)return'<c r="'+cellIndex+'" '+styleString+"><v>"+value.value+"</v></c>";if("sharedString"===value.type)return'<c r="'+cellIndex+'" t="s" '+styleString+"><v>"+value.value+"</v></c>";if("sharedFormula"===value.type){var v="";return value.value&&"function"==typeof value.value?v="<v>"+value.value(rowIndex+1,columnIndex+1)+"</v>":void 0!==value.value&&null!==value.value&&(v="<v>"+value.value+"</v>"),value.formula?'<c  r="'+cellIndex+'" '+styleString+'><f t="shared" ref="'+value.range+'" si="'+value.si+'">'+value.formula+"</f>"+v+"</c>":'<c  r="'+cellIndex+'" '+styleString+'><f t="shared" si="'+value.si+'"></f>'+v+"</c>"}if("string"===value.type)return'<c r="'+cellIndex+'" t="inlineStr" '+styleString+"><is><t>"+value.value.replace(/&/g,"&amp;")+"</t></is></c>";if("formula"===value.type){var v="";return value.value&&"function"==typeof value.value?v="<v>"+value.value(rowIndex+1,columnIndex+1)+"</v>":void 0!==value.value&&null!==value.value&&(v="<v>"+value.value+"</v>"),'<c r="'+cellIndex+'" '+styleString+"><f>"+value.formula+"</f>"+v+"</c>"}},getNextRelation=function(_sheet){var lastSheetRel={},nextSheetRelId;return _sheet._rels.relations.length&&(lastSheetRel=_sheet._rels.relations[_sheet._rels.relations.length-1]),parseInt((lastSheetRel.Id||"rId0").replace("rId",""),10)+1},getColumnString=function(columnIndex){for(var columnString="",mod;columnIndex>0;){var div;0===(mod=columnIndex%26)&&(mod=26),columnIndex=(columnIndex-mod)/26,columnString=String.fromCharCode(64+mod)+columnString}return columnString};Sheet.prototype.generateContent=function(file){var rowIndex=0,sheetValues="<sheetData>";if(this._sheet.values&&this._sheet.values.length)for(rowIndex=0;rowIndex<this._sheet.values.length;rowIndex++)if(this._sheet.values[rowIndex]&&this._sheet.values[rowIndex].length>0){var hidden;sheetValues+='<row r="'+(rowIndex+1)+'"'+(this._sheet.values[rowIndex].hidden?' hidden="1" ':"")+">";var columnIndex=0;for(columnIndex=0;columnIndex<this._sheet.values[rowIndex].length;columnIndex++){var columnChar=getColumnString(columnIndex+1),value=this._sheet.values[rowIndex][columnIndex],cellIndex,cellStr;sheetValues+=cellString(value,columnChar+(rowIndex+1),rowIndex,columnIndex)}sheetValues+="</row>"}sheetValues+="</sheetData>";var merge="";if(this._sheet._mergeCells&&this._sheet._mergeCells.length){merge+='<mergeCells count="'+this._sheet._mergeCells.length+'">';for(var i=0;i<this._sheet._mergeCells.length;i++)merge+='<mergeCell ref="'+this._sheet._mergeCells[0]+'"/>';merge+="</mergeCells>"}var tables="",sheetTemplate;if(this._sheet.tables&&this._sheet.tables.length){tables+='<tableParts count="'+this._sheet.tables.length+'">';for(var index=0;index<this._sheet.tables.length;index++)tables+='<tablePart r:id="rId'+this._sheet.tables[index].rid+'"/>',file&&this._sheet.tables[index].attach(file);tables+="</tableParts>"}return new XMLContentString({rootNode:"worksheet",nameSpaces:["http://schemas.openxmlformats.org/spreadsheetml/2006/main",{value:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",attribute:"r"}]}).format(sheetValues+merge+tables)},Sheet.prototype.attachChild=function(file){this._sheet._rels&&this._sheet._rels.attach(file)};var sanitizeValue=function(value,_sheet){if(null==value)return null;if("object"==typeof value){if(!(void 0!==value.value&&null!==value.value||value.formula&&"formula"===value.type))return null;if(value.type)return"sharedString"===value.type?"number"==typeof value.value?{type:value.type,value:value.value}:(value.value=_sheet._workBook.createSharedString(value.value,_sheet._workBook),{type:value.type,value:value.value}):"formula"===value.type?{type:value.type,formula:value.formula,value:value.value}:"numeric"===value.type||"string"===value.type?{type:value.type,value:value.value}:null;value=value.value}return"number"==typeof value?{type:"numeric",value:value}:"string"==typeof value?{type:"string",value:value}:null},updateValuesInMatrix=function(values,_sheet,rowIndex,columnIndex,options,cellIndices){var index,styleIndex,_styles;options&&(options.cellIndices=cellIndices,styleIndex=_sheet._workBook.createStyles().addStyles(options));for(index=0;index<values.length;index++)if(void 0!==values[index]||null!==values[index]){var sheetRowIndex=index+rowIndex-1,index2,value;if(_sheet.values[sheetRowIndex]||(_sheet.values[sheetRowIndex]=[]),"object"==typeof values[index]&&values[index].length>=0)for(index2=0;index2<values[index].length;index2++){var value;(value=sanitizeValue(values[index][index2],_sheet))&&(styleIndex&&(value.styleIndex=styleIndex.index),styleIndex||!_sheet.values[sheetRowIndex][index2+columnIndex-1]?_sheet.values[sheetRowIndex][index2+columnIndex-1]=value:(_sheet.values[sheetRowIndex][index2+columnIndex-1].value=value.value,_sheet.values[sheetRowIndex][index2+columnIndex-1].type=value.type))}else(value=sanitizeValue(values[index],_sheet))&&(styleIndex&&(value.styleIndex=styleIndex.index),styleIndex||!_sheet.values[sheetRowIndex][columnIndex-1]?_sheet.values[sheetRowIndex][columnIndex-1]=value:(_sheet.values[sheetRowIndex][columnIndex-1].value=value.value,_sheet.values[sheetRowIndex][columnIndex-1].type=value.type))}},updateValueInCell=function(value,_sheet,rowIndex,columnIndex,options){var cellIndex=getColumnString(columnIndex)+rowIndex,sheetRowIndex=rowIndex-1;if(null!=value){if(_sheet.values[sheetRowIndex]||(_sheet.values[sheetRowIndex]=[]),value=sanitizeValue(value,_sheet),options){options.cellIndex=cellIndex;var _styles=_sheet._workBook.createStyles();value.styleIndex=_styles.addStyles(options).index}value&&!value.styleIndex&&_sheet.values[sheetRowIndex][columnIndex-1]&&(value.styleIndex=_sheet.values[sheetRowIndex][columnIndex-1].styleIndex),_sheet.values[sheetRowIndex][columnIndex-1]=value}return getCellAttributes(_sheet,cellIndex,sheetRowIndex,columnIndex-1)},getCellAttributes=function(_sheet,cellIndex,rowIndex,columnIndex){return{style:function(options){return options.cellIndex=cellIndex,updateSingleStyle(_sheet,options,rowIndex,columnIndex),getCellAttributes(_sheet,cellIndex,rowIndex,columnIndex)},value:_sheet.values[rowIndex]&&_sheet.values[rowIndex][columnIndex]?_sheet.values[rowIndex][columnIndex].value:null,type:_sheet.values[rowIndex]&&_sheet.values[rowIndex][columnIndex]?_sheet.values[rowIndex][columnIndex].type:null,cellIndex:cellIndex,rowIndex:rowIndex+1,columnIndex:getColumnString(columnIndex+1),formula:_sheet.values[rowIndex]&&_sheet.values[rowIndex][columnIndex]?_sheet.values[rowIndex][columnIndex].formula:void 0,set:function(value,options){return cell(_sheet,rowIndex+1,columnIndex+1,value,options),this.value=_sheet.values[rowIndex]&&_sheet.values[rowIndex][columnIndex]?_sheet.values[rowIndex][columnIndex].value:null,this.formula=_sheet.values[rowIndex]&&_sheet.values[rowIndex][columnIndex]?_sheet.values[rowIndex][columnIndex].formula:void 0,this.type=_sheet.values[rowIndex]&&_sheet.values[rowIndex][columnIndex]?_sheet.values[rowIndex][columnIndex].type:null,getCellAttributes(_sheet,cellIndex,rowIndex,columnIndex)}}},getCellRangeAttributes=function(_sheet,cellIndices,_cells,cRowIndex,cColumnIndex,totalRows,totalColumns,isRow,isColumn){var cellRange=[],index;for(index=0;index<_cells.length;index++){var rowIndex=_cells[index].rowIndex,columnIndex=_cells[index].columnIndex,value=_sheet.values[rowIndex]&&_sheet.values[rowIndex][columnIndex]?_sheet.values[rowIndex][columnIndex].value:null,formula=_sheet.values[rowIndex]&&_sheet.values[rowIndex][columnIndex]?_sheet.values[rowIndex][columnIndex].formula:void 0,type=_sheet.values[rowIndex]&&_sheet.values[rowIndex][columnIndex]?_sheet.values[rowIndex][columnIndex].type:null,cellIndex=getColumnString(columnIndex+1)+(rowIndex+1),sharedFormulaIndex="sharedFormula"===type?_sheet.values[rowIndex][columnIndex].si:void 0;cellRange.push({style:function(options){return options.cellIndex=this.cellIndex,updateSingleStyle(_sheet,options,this.rowIndex-1,this.columnIndex.toUpperCase().charCodeAt()-65),getCellAttributes(_sheet,this.cellIndex,this.rowIndex-1,this.columnIndex.toUpperCase().charCodeAt()-65)},rowIndex:rowIndex+1,columnIndex:getColumnString(columnIndex+1),value:value,formula:formula,cellIndex:cellIndex,sharedFormulaIndex:sharedFormulaIndex,type:type,set:function(value,options){return cell(_sheet,rowIndex+1,columnIndex+1,value,options),this.value=_sheet.values[rowIndex]&&_sheet.values[rowIndex][columnIndex]?_sheet.values[rowIndex][columnIndex].value:null,this.formula=_sheet.values[rowIndex]&&_sheet.values[rowIndex][columnIndex]?_sheet.values[rowIndex][columnIndex].formula:void 0,this.type=_sheet.values[rowIndex]&&_sheet.values[rowIndex][columnIndex]?_sheet.values[rowIndex][columnIndex].type:null,getCellAttributes(_sheet,cellIndex,rowIndex,columnIndex)}})}return{style:function(options){return options.cellIndices=cellIndices,updateRangeStyle(_sheet,options,_cells),getCellRangeAttributes(_sheet,cellIndices,_cells,cRowIndex,cColumnIndex,totalRows,totalColumns)},cellIndices:cellIndices,cells:cellRange,set:function(values,options){var tVal=[];if(!(values&&values.length&&totalColumns&&totalRows))return getCellRangeAttributes(_sheet,cellIndices,_cells,cRowIndex,cColumnIndex,totalRows,totalColumns);if(isRow||isColumn)for(var index=0;index<this.cells.length&&index<values.length;index++)tVal.push(values[index]);if(isRow)values=[tVal];else if(isColumn)values=tVal;else{for(var tVal=[],index=0;index<values.length&&index<totalRows;index++)if(values[index]){var tVal2=[];if(values[index].length>totalColumns){for(var index2=0;index2<values[index].length&&index2<totalColumns;index2++)tVal2.push(values[index][index2]);values[index]=tVal2}tVal.push(values[index])}else tVal.push([]);values=tVal}cells(_sheet,cRowIndex,cColumnIndex,totalRows,totalColumns,values,options,!1,isRow,isColumn);var cellsAttributes=getCellRangeAttributes(_sheet,cellIndices,_cells,cRowIndex,cColumnIndex,totalRows,totalColumns);return this.cells=cellsAttributes.cells,cellsAttributes}}},updateSingleStyle=function(_sheet,options,rowIndex,columnIndex){var _styles,styleIndex=_sheet._workBook.createStyles().addStyles(options).index;_sheet.values[rowIndex]||(_sheet.values[rowIndex]=[]),_sheet.values[rowIndex][columnIndex]||(_sheet.values[rowIndex][columnIndex]={value:"",type:"string"}),_sheet.values[rowIndex][columnIndex].styleIndex=styleIndex},updateRangeStyle=function(_sheet,options,cells){for(var _styles,styleIndex=_sheet._workBook.createStyles().addStyles(options).index,cellIndex=0;cellIndex<cells.length;cellIndex++)_sheet.values[cells[cellIndex].rowIndex]||(_sheet.values[cells[cellIndex].rowIndex]=[]),_sheet.values[cells[cellIndex].rowIndex][cells[cellIndex].columnIndex]||(_sheet.values[cells[cellIndex].rowIndex][cells[cellIndex].columnIndex]={type:"string",value:""}),_sheet.values[cells[cellIndex].rowIndex][cells[cellIndex].columnIndex].styleIndex=styleIndex};Sheet.prototype.sharedFormula=function(fromCell,toCell,formula,options){var nextId,cellIndices=[],cells=[];if(fromCell&&formula&&toCell){var val;if("object"==typeof formula&&!formula.length){if(!formula.formula)return;val=formula.value,formula=formula.formula}var fromCellChar=fromCell.match(/\D+/)[0],fromCellNum=fromCell.match(/\d+/)[0],lastSharedFormula;if(this._sheet._sharedFormula)nextId=this._sheet._sharedFormula[this._sheet._sharedFormula.length-1].si+1;else this._sheet._sharedFormula=[],nextId=0;this._sheet._sharedFormula.push({si:nextId,fromCell:fromCell,toCell:toCell,formula:formula});var columIndex=fromCellChar.toUpperCase().charCodeAt()-65,rowIndex=parseInt(fromCellNum,10),toCellChar,toCellNum;if(this._sheet.values[rowIndex-1]||(this._sheet.values[rowIndex-1]=[]),this._sheet.values[rowIndex-1][columIndex]={type:"sharedFormula",si:nextId,formula:formula,range:fromCell+":"+toCell,value:val},cellIndices.push(getColumnString(columIndex+1)+rowIndex),cells.push({rowIndex:rowIndex-1,columnIndex:columIndex}),toCell&&(toCellChar=toCell.match(/\D+/)[0],toCellNum=toCell.match(/\d+/)[0]),toCellNum===fromCellNum){var toColumnIndex=toCellChar.toUpperCase().charCodeAt()-65;for(columIndex++;columIndex<=toColumnIndex;columIndex++)this._sheet.values[rowIndex-1][columIndex]={type:"sharedFormula",si:nextId,value:val},cellIndices.push(getColumnString(columIndex+1)+rowIndex),cells.push({rowIndex:rowIndex-1,columnIndex:columIndex})}else if(toCellChar===fromCellChar){var torowIndex=parseInt(toCellNum,10);for(rowIndex++;rowIndex<=torowIndex;rowIndex++)this._sheet.values[rowIndex-1]||(this._sheet.values[rowIndex-1]=[]),cellIndices.push(getColumnString(columIndex+1)+rowIndex),cells.push({rowIndex:rowIndex-1,columnIndex:columIndex}),this._sheet.values[rowIndex-1][columIndex]={type:"sharedFormula",si:nextId,value:val}}if(options){var styleIndex,_styles;options.cellIndices=cellIndices,styleIndex=this._sheet._workBook.createStyles().addStyles(options);for(var cellIndex=0;cellIndex<cells.length;cellIndex++)this._sheet.values[cells[cellIndex].rowIndex][cells[cellIndex].columnIndex].styleIndex=styleIndex.index}return getCellRangeAttributes(this._sheet,cellIndices,cells)}};var cell=function(_sheet,rowIndex,columnIndex,value,options){if(rowIndex&&columnIndex&&"number"==typeof rowIndex&&"number"==typeof columnIndex){if(options||null!=value)return options||"object"!=typeof value||value.type||void 0!==value.value&&null!==value.value?null==value?cellStyle(_sheet,rowIndex,columnIndex,options):updateValueInCell(value,_sheet,rowIndex,columnIndex,options):cellStyle(_sheet,rowIndex,columnIndex,value);var cellIndex=getColumnString(columnIndex)+rowIndex;return getCellAttributes(_sheet,cellIndex,rowIndex-1,columnIndex-1)}};Sheet.prototype.cell=function(rowIndex,columnIndex,value,options){return cell(this._sheet,rowIndex,columnIndex,value,options)},Sheet.prototype.row=function(rowIndex,columnIndex,values,options){var totalColumns=this._sheet.values[rowIndex-1]?this._sheet.values[rowIndex-1].length-columnIndex+1:0;return cells(this._sheet,rowIndex,columnIndex,1,values&&Array.isArray(values)?values.length:values?1:totalColumns,values?[values]:null,options,!0,!0,!1)},Sheet.prototype.column=function(rowIndex,columnIndex,values,options){var totalRows=0;return values&&values.length||(totalRows=this._sheet.values&&this._sheet.values.length&&this._sheet.values.length>rowIndex?this._sheet.values.length-rowIndex+1:0),cells(this._sheet,rowIndex,columnIndex,values&&Array.isArray(values)?values.length:values?1:totalRows,1,values,options,!0,!1,!0)},Sheet.prototype.grid=function(rowIndex,columnIndex,values,options){var index,totalRows=0,totalColumns=0;if(values&&values.length)for(totalRows=values.length,index=0;index<values.length;index++)values[index]&&values[index].length&&(totalColumns=totalColumns<values[index].length?values[index].length:totalColumns);else if(this._sheet.values&&this._sheet.values.length){totalRows=this._sheet.values.length-rowIndex+1;for(var index=0;index<this._sheet.values.length;index++)this._sheet.values[index]&&this._sheet.values[index].length&&(totalColumns=totalColumns<this._sheet.values[index].length-columnIndex+1?this._sheet.values[index].length-columnIndex+1:totalColumns)}return cells(this._sheet,rowIndex,columnIndex,totalRows,totalColumns,values,options,!0,!1)},Sheet.prototype.table=function(tableName,fromCell,toCell,options){var _table=addTable(this._sheet,this.xlsxContentTypes,tableName,fromCell,toCell,options);return _table?_table.tableOptions():void 0},Sheet.prototype.merge=function(cellRange){return cellRange&&"string"==typeof cellRange?(this._sheet._mergeCells||(this._sheet._mergeCells=[]),this._sheet._mergeCells.push(cellRange),this):this};var cells=function(_sheet,rowIndex,columnIndex,totalRows,totalColumns,values,options,isReturn,isRow,isColumn){if(rowIndex&&columnIndex&&"number"==typeof rowIndex&&"number"==typeof columnIndex&&"number"==typeof totalRows&&"number"==typeof totalColumns){for(var cells=[],cellIndices=[],tmpRows=totalRows,index=rowIndex-1;tmpRows>0;index++,tmpRows--){var tmpColumns=totalColumns;_sheet.values[index]||(_sheet.values[index]=[]);for(var index2=columnIndex-1;tmpColumns>0;index2++,tmpColumns--)cellIndices.push(getColumnString(index2+1)+(index+1)),cells.push({rowIndex:index,columnIndex:index2})}if(options||values){if(null==values){if(options.cellIndices=cellIndices,updateRangeStyle(_sheet,options,cells),!isReturn)return;return getCellRangeAttributes(_sheet,cellIndices,cells,rowIndex,columnIndex,totalRows,totalColumns,isRow,isColumn)}if(updateValuesInMatrix(values,_sheet,rowIndex,columnIndex,options,cellIndices,cells,totalRows,totalColumns),!isReturn)return;return getCellRangeAttributes(_sheet,cellIndices,cells,rowIndex,columnIndex,totalRows,totalColumns,isRow,isColumn)}return getCellRangeAttributes(_sheet,cellIndices,cells,rowIndex,columnIndex,totalRows,totalColumns,isRow,isColumn)}},cellStyle=function(_sheet,rowIndex,columnIndex,options){var cellIndex=getColumnString(columnIndex-1)+rowIndex;return options.cellIndex=cellIndex,updateSingleStyle(_sheet,options,rowIndex-1,columnIndex-1),getCellAttributes(_sheet,cellIndex,rowIndex-1,columnIndex-1)},addTable=function(_sheet,xlsxContentTypes,tableName,fromCell,toCell,options){var titles=[],fromColumIndex=fromCell.match(/\D+/)[0].toUpperCase().charCodeAt()-65,fromRowIndex=parseInt(fromCell.match(/\d+/)[0],10),toColumnIndex=toCell.match(/\D+/)[0].toUpperCase().charCodeAt()-65,titleRow=_sheet.values[fromRowIndex-1];if(titleRow){for(var index=fromColumIndex;index<=toColumnIndex;index++)titles.push(titleRow[index]&&titleRow[index].value?titleRow[index].value:"");var relId=addFile("table",xlsxContentTypes,_sheet);_sheet.tables||(_sheet.tables=[]);var table=oxmlTable.addTable(tableName,fromCell,toCell,titles,relId,options,_sheet);return _sheet.tables.push(table),table}},addFile=function(fileType,xlsxContentTypes,_sheet){_sheet._rels||(_sheet._rels=OxmlRels.createRelation("sheet"+_sheet.sheetId+".xml.rels","workbook/sheets/_rels"));var relId=getNextRelation(_sheet),type,target,contentType,partName;switch(fileType){case"table":type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/table",target="../tables/table"+relId+".xml",contentType="application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml",partName="/workbook/tables/table"+relId+".xml";break;case"drawing":type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",target="../drawings/drawing"+relId+".xml",contentType="application/vnd.openxmlformats-officedocument.drawing+xml",partName="/workbook/drawings/drawing"+relId+".xml"}return _sheet._rels.addRelation("rId"+relId,type,target),xlsxContentTypes.addContentType("Override",contentType,{PartName:partName}),relId};return{createSheet:function(sheetName,sheetId,rId,workBook,xlsxContentTypes){return new Sheet(sheetName,sheetId,rId,workBook,xlsxContentTypes)}}})),define("utils",[],(function(){var stringify;return sortObject=function(obj){if("object"!=typeof obj||obj.length)return obj;var temp={},keys=[];for(var key in obj)keys.push(key);for(var index in keys.sort(),keys)temp[keys[index]]=sortObject(obj[keys[index]]);return temp},{stringify:function(obj){return JSON.stringify(sortObject(obj))}}})),define("oxml_xlsx_font",["utils"],(function(utils){var generateContent=function(_styles){var stylesString="",fontKey;for(fontKey in stylesString+='<fonts count="'+_styles._fontsCount+'">',_styles._fonts){var font=JSON.parse(fontKey);stylesString+=generateSingleContent(font)}return stylesString+="</fonts>"},generateSingleContent=function(font){var stylesString="<font>";return stylesString+=font.strike?"<strike/>":"",stylesString+=font.italic?"<i/>":"",stylesString+=font.bold?"<b/>":"",stylesString+=font.underline?"<u/>":"",stylesString+=font.size?'<sz val="'+font.size+'"/>':"",stylesString+=font.color?'<color rgb="'+font.color+'"/>':"",stylesString+=font.name?'<name val="'+font.name+'"/>':"",stylesString+=font.family?'<family val="'+font.family+'"/>':"",stylesString+=font.scheme?'<scheme val="'+font.scheme+'"/>':"",stylesString+="</font>"},createFont=function(options){var font={};return font.bold=!!options.bold,font.italic=!!options.italic,font.underline=!!options.underline,font.size=options.fontSize||!1,font.color=options.fontColor||!1,font.name=options.fontName||!1,font.family=options.fontFamily||!1,font.scheme=options.scheme||!1,font.strike=!!options.strike,font},searchFont=function(font,_styles){return _styles._fonts[utils.stringify(font)]},searchSavedFontsForUpdate=function(_styles,cellIndices){for(var index=0,fontCount=0,cellStyle,index2=0;index2<cellIndices.length;index2++)for(var cellIndex=cellIndices[0];index<_styles.styles.length;index++)if((void 0!==_styles.styles[index].cellIndices[cellIndex]||null!==_styles.styles[index].cellIndices[cellIndex])&&(cellStyle=_styles.styles[index],fontCount++,Object.keys(cellStyle.cellIndices).length!==cellIndices.length||fontCount>1||0===cellStyle._font))return!1;return!!cellStyle&&cellStyle._font},addFont=function(font,_styles){var index=_styles._fontsCount++;return _styles._fonts[utils.stringify(font)]=""+index,_styles._fonts[utils.stringify(font)]},updateFont=function(font,savedFont,_styles){return mergeFont(font,savedFont,_styles,!0),_styles._fonts[utils.stringify(font)]=savedFont,savedFont},createTableFont,mergeFont=function(font,savedFont,_styles,deleteSavedFont){var savedFontDetails;for(var key in _styles._fonts)if(_styles._fonts[key]===savedFont){savedFontDetails=JSON.parse(key);break}for(var key in deleteSavedFont&&delete _styles._fonts[utils.stringify(savedFontDetails)],font)font[key]&&(savedFontDetails[key]=font[key]),font[key]=savedFontDetails[key];return font},getFontCounts=function(font,_styles){var count=0,index;for(index=0;index<_styles.styles.length;index++)if(_styles.styles[index]._font===font&&(count+=Object.keys(_styles.styles[index].cellIndices).length)>1)return count;return count},getFontForCells,getFontForCell;return{createTableFont:function(options,savedFont){var font=createFont(options);if(savedFont){for(var key in font)font[key]&&(savedFont[key]=font[key]);return savedFont}return font},getFontForCell:function(_styles,options,cellStyle){var newStyleCreated=!1,font=createFont(options),fontIndex,savedFont=_styles._fonts?searchFont(font,_styles):null,fontCount;(null!=savedFont?fontIndex=savedFont:newStyleCreated=!0,cellStyle&&cellStyle._font)&&(getFontCounts(cellStyle._font,_styles)<=1?fontIndex=updateFont(font,cellStyle._font,_styles):(font=mergeFont(font,cellStyle._font,_styles),null!=(savedFont=searchFont(font,_styles))?fontIndex=savedFont:(fontIndex=null,newStyleCreated=!0)));return null==fontIndex&&(fontIndex=addFont(font,_styles)),{font:font,fontIndex:fontIndex,newStyleCreated:newStyleCreated}},getFontForCells:function(_styles,options){var newStyleCreated=!1,font=createFont(options),fontIndex,savedFont=_styles._fonts?searchFont(font,_styles):null;return null!=savedFont?fontIndex=savedFont:newStyleCreated=!0,fontIndex||!1!==(savedFont=searchSavedFontsForUpdate(_styles,options.cellIndices))&&(fontIndex=updateFont(font,savedFont,_styles)),null==fontIndex&&(fontIndex=addFont(font,_styles)),{font:font,fontIndex:fontIndex,newStyleCreated:newStyleCreated}},generateContent:generateContent,generateSingleContent:generateSingleContent}})),define("oxml_xlsx_num_format",["utils"],(function(utils){var generateContent,createNumFormat=function(options){var numberFormat={};return numberFormat.formatString=options.numberFormat,numberFormat},searchNumFormat=function(numFormat,_styles){return _styles._numFormats[utils.stringify(numFormat)]},addNumFormat=function(numFormat,_styles){_styles._numFormats||(_styles._numFormats={},_styles._numFormatsCount=200);var index=_styles._numFormatsCount++;return _styles._numFormats[utils.stringify(numFormat)]=""+index,_styles._numFormats[utils.stringify(numFormat)]},updateNumFormat=function(numFormat,savedNumFormat,_styles){var savedNumFormatDetails;for(var key in _styles._numFormats)if(_styles._numFormats[key]===savedNumFormat){savedNumFormatDetails=JSON.parse(key);break}return numFormat.formatString?(delete _styles._numFormats[utils.stringify(savedNumFormatDetails)],_styles._numFormats[utils.stringify(numFormat)]=savedNumFormat):numFormat.formatString=savedNumFormatDetails.formatString,savedNumFormat},getNumFormatCounts=function(numFormat,_styles){var count=0,index;for(index=0;index<_styles.styles.length;index++)if(_styles.styles[index]._numFormat===numFormat&&(count+=Object.keys(_styles.styles[index].cellIndices).length)>1)return count;return count},searchSavedNumFormatForUpdate=function(_styles,cellIndices){for(var index=0,numFormatCount=0,cellStyle,index2=0;index2<cellIndices.length;index2++)for(var cellIndex=cellIndices[0];index<_styles.styles.length;index++)if((void 0!==_styles.styles[index].cellIndices[cellIndex]||null!==_styles.styles[index].cellIndices[cellIndex])&&(cellStyle=_styles.styles[index],numFormatCount++,Object.keys(cellStyle.cellIndices).length!==cellIndices.length||numFormatCount>1))return!1;return!!cellStyle&&cellStyle._numFormat},getNumFormatForCells,getNumFormatForCell;return{generateContent:function(_styles){var stylesString="";if(_styles._numFormats){var numFormatKey;for(numFormatKey in stylesString+='<numFmts count="'+Object.keys(_styles._numFormats).length+'">',_styles._numFormats){var numFormat=JSON.parse(numFormatKey);stylesString+='<numFmt numFmtId="'+_styles._numFormats[numFormatKey]+'" formatCode="'+numFormat.formatString+'"/>'}stylesString+="</numFmts>"}return stylesString},getNumFormatForCell:function(_styles,options,cellStyle){var newStyleCreated=!1,numFormat=createNumFormat(options),numFormatIndex,savedNumFormat=_styles._numFormats?searchNumFormat(numFormat,_styles):null,numFormatCount;(null!=savedNumFormat?numFormatIndex=savedNumFormat:numFormat.formatString&&(newStyleCreated=!0),cellStyle&&cellStyle._numFormat)&&(getNumFormatCounts(cellStyle._numFormat,_styles)<=1&&_styles._numFormats&&(numFormatIndex=updateNumFormat(numFormat,cellStyle._numFormat,_styles)));return null==numFormatIndex&&numFormat.formatString&&(numFormatIndex=addNumFormat(numFormat,_styles)),{numFormat:numFormat,numFormatIndex:numFormatIndex||!1,newStyleCreated:newStyleCreated}},getNumFormatForCells:function(_styles,options){var newStyleCreated=!1,numFormat=createNumFormat(options),numFormatIndex,savedNumFormat=_styles._numFormats?searchNumFormat(numFormat,_styles):null;return null!=savedNumFormat?numFormatIndex=savedNumFormat:numFormat.formatString&&(newStyleCreated=!0),numFormatIndex||!1!==(savedNumFormat=searchSavedNumFormatForUpdate(_styles,options.cellIndices))&&(numFormatIndex=updateNumFormat(numFormat,savedNumFormat,_styles)),null==numFormatIndex&&numFormat.formatString&&(numFormatIndex=addNumFormat(numFormat,_styles)),{numFormat:numFormat,numFormatIndex:numFormatIndex||!1,newStyleCreated:newStyleCreated}}}})),define("oxml_xlsx_border",["utils"],(function(utils){var getBorderString=function(border,borderType){var borderStyleString,borderColorString;return border.style||border.color?"<"+borderType+(border.style?' style="'+border.style+'"':"")+">"+(border.color?'<color rgb="'+border.color+'"/>':"")+"</"+borderType+">":"<"+borderType+"/>"},generateContent=function(_styles){var stylesString="",borderKey;for(borderKey in stylesString+='<borders count="'+_styles._bordersCount+'">',_styles._borders){var border=JSON.parse(borderKey);stylesString+=border?generateSingleContent(border):"<border />"}return stylesString+="</borders>"},generateSingleContent=function(border){var stylesString="<border>";return stylesString+=getBorderString(border.left,"left"),stylesString+=getBorderString(border.right,"right"),stylesString+=getBorderString(border.top,"top"),stylesString+=getBorderString(border.bottom,"bottom"),stylesString+=getBorderString(border.diagonal,"diagonal"),stylesString+="</border>"},createBorder=function(options){var border={};return!!options.border&&(border.left={color:!!options.border.left&&options.border.left.color||options.border.color||!1,style:!!options.border.left&&options.border.left.style||options.border.style||!1},border.top={color:!!options.border.top&&options.border.top.color||options.border.color||!1,style:!!options.border.top&&options.border.top.style||options.border.style||!1},border.bottom={color:!!options.border.bottom&&options.border.bottom.color||options.border.color||!1,style:!!options.border.bottom&&options.border.bottom.style||options.border.style||!1},border.right={color:!!options.border.right&&options.border.right.color||options.border.color||!1,style:!!options.border.right&&options.border.right.style||options.border.style||!1},border.diagonal={color:!!options.border.diagonal&&options.border.diagonal.color||options.border.color||!1,style:!!options.border.diagonal&&options.border.diagonal.style||options.border.style||!1},border.isValid=border.left.style||border.top.style||border.bottom.style||border.right.style||border.diagonal.style||border.left.color||border.top.color||border.bottom.color||border.right.color||border.diagonal.color,!!border.isValid&&border)},searchBorder=function(border,_styles){return _styles._borders[utils.stringify(border)]},addBorder=function(border,_styles){var index=_styles._bordersCount++;return _styles._borders[utils.stringify(border)]=""+index,_styles._borders[utils.stringify(border)]},searchSavedBordersForUpdate=function(_styles,cellIndices){for(var index=0,borderCount=0,cellStyle,index2=0;index2<cellIndices.length;index2++)for(var cellIndex=cellIndices[0];index<_styles.styles.length;index++)if((void 0!==_styles.styles[index].cellIndices[cellIndex]||null!==_styles.styles[index].cellIndices[cellIndex])&&(cellStyle=_styles.styles[index],borderCount++,Object.keys(cellStyle.cellIndices).length!==cellIndices.length||borderCount>1||0===cellStyle._border))return!1;return!!cellStyle&&cellStyle._border},updateBorder=function(border,savedBorder,_styles){return mergeBorder(border,savedBorder,_styles,!0),_styles._borders[utils.stringify(border)]=savedBorder,savedBorder},createTableBorder,mergeBorder=function(border,savedBorder,_styles,deleteSavedBorder){var savedBorderDetails;for(var key in _styles._borders)if(_styles._borders[key]===savedBorder){savedBorderDetails=JSON.parse(key);break}if(deleteSavedBorder&&delete _styles._borders[utils.stringify(savedBorderDetails)],border)for(var key in border)(border[key].color||border[key].style)&&(savedBorderDetails[key]=border[key]),border[key]=savedBorderDetails[key];else border=savedBorderDetails;return border},getBorderCounts=function(border,_styles){var count=0,index;for(index=0;index<_styles.styles.length;index++)if(_styles.styles[index]._border===border&&(count+=Object.keys(_styles.styles[index].cellIndices).length)>1)return count;return count},getBorderForCell,getBorderForCells;return{createTableBorder:function(options,savedBorder){var border=createBorder(options);if(savedBorder){for(var key in border)border[key]&&(border[key].color||border[key].style)&&(savedBorder[key]=border[key]);return savedBorder}return border},getBorderForCell:function(_styles,options,cellStyle){var newStyleCreated=!1,border=createBorder(options),borderIndex,savedBorder=_styles._borders?searchBorder(border,_styles):null,borderCount;(null!=savedBorder?borderIndex=savedBorder:newStyleCreated=!0,cellStyle&&cellStyle._border&&cellStyle._border!==savedBorder)&&(getBorderCounts(cellStyle._border,_styles)<=1&&(borderIndex=updateBorder(border,cellStyle._border,_styles)));return null==borderIndex&&(cellStyle&&cellStyle._border&&(border=mergeBorder(border,cellStyle._border,_styles,!1)),borderIndex=addBorder(border,_styles)),{border:border,borderIndex:borderIndex,newStyleCreated:newStyleCreated}},getBorderForCells:function(_styles,options){var newStyleCreated=!1,border=createBorder(options),borderIndex,savedBorder=_styles._borders?searchBorder(border,_styles):null;return null!=savedBorder?borderIndex=savedBorder:newStyleCreated=!0,!1!==(savedBorder=searchSavedBordersForUpdate(_styles,options.cellIndices))&&(borderIndex=updateBorder(border,savedBorder,_styles)),null==borderIndex&&(borderIndex=addBorder(border,_styles)),{border:border,borderIndex:borderIndex,newStyleCreated:newStyleCreated}},generateContent:generateContent,generateSingleContent:generateSingleContent}})),define("oxml_xlsx_fill",["utils"],(function(utils){var generateContent=function(_styles){var stylesString="",fillKey;for(fillKey in stylesString+='<fills count="'+_styles._fillsCount+'">',_styles._fills){var fill=JSON.parse(fillKey);stylesString+=fill?getFillString(fill):"<fill/>"}return stylesString+="</fills>"},getFillString=function(fill){var fillString="<fill>";if(fill.pattern){var patternType=fill.pattern||"none",colorString=fill.fgColor?'<fgColor rgb="'+fill.fgColor+'"/>':"";fillString+='<patternFill patternType="'+patternType+'">'+(colorString+=fill.bgColor?'<bgColor rgb="'+fill.bgColor+'"/>':"")+"</patternFill>"}else if(fill.gradient){var typeString,leftString,rightString,topString,bottomString,degreeString;fillString+="<gradientFill"+(fill.gradient.type?' type="'+fill.gradient.type+'"':"")+(fill.gradient.left?' left="'+fill.gradient.left+'"':"")+(fill.gradient.right?' right="'+fill.gradient.right+'"':"")+(fill.gradient.top?' top="'+fill.gradient.top+'"':"")+(fill.gradient.bottom?' bottom="'+fill.gradient.bottom+'"':"")+(fill.gradient.degree?' degree="'+fill.gradient.degree+'"':"")+">";for(var stopIndex=0;stopIndex<fill.gradient.stops.length;stopIndex++)fillString+='<stop position="'+fill.gradient.stops[stopIndex].position+'">',fillString+='<color rgb="'+fill.gradient.stops[stopIndex].color+'"/></stop>';fillString+="</gradientFill>"}return fillString+"</fill>"},createFill=function(options){var fill;if(options.fill&&options.fill.pattern)return(fill={}).pattern=options.fill.pattern,fill.fgColor=options.fill.foreColor||!1,fill.bgColor=options.fill.backColor||options.fill.color||!1,fill;if(options.fill&&options.fill.gradient&&options.fill.gradient.stops){var fill;(fill={gradient:{}}).gradient.degree=options.fill.gradient.degree||!1,fill.gradient.bottom=options.fill.gradient.bottom||!1,fill.gradient.left=options.fill.gradient.left||!1,fill.gradient.right=options.fill.gradient.right||!1,fill.gradient.top=options.fill.gradient.top||!1,fill.gradient.type=options.fill.gradient.type||!1,fill.gradient.stops=[];for(var stopIndex=0;stopIndex<options.fill.gradient.stops.length;stopIndex++){var stop={};stop.position=options.fill.gradient.stops[stopIndex].position||0,stop.color=options.fill.gradient.stops[stopIndex].color||!1,fill.gradient.stops.push(stop)}return fill}return!1},searchFill=function(fill,_styles){return _styles._fills[utils.stringify(fill)]},addFill=function(fill,_styles){var index=_styles._fillsCount++;return _styles._fills[utils.stringify(fill)]=""+index,_styles._fills[utils.stringify(fill)]},searchSavedFillsForUpdate=function(_styles,cellIndices){for(var index=0,fillCount=0,cellStyle,index2=0;index2<cellIndices.length;index2++)for(var cellIndex=cellIndices[0];index<_styles.styles.length;index++)if((void 0!==_styles.styles[index].cellIndices[cellIndex]||null!==_styles.styles[index].cellIndices[cellIndex])&&(cellStyle=_styles.styles[index],fillCount++,Object.keys(cellStyle.cellIndices).length!==cellIndices.length||fillCount>1||0===cellStyle._fill))return!1;return!!cellStyle&&cellStyle._fill},updateFill=function(fill,savedFill,_styles){return mergeFill(fill,savedFill,_styles,!0),_styles._fills[utils.stringify(fill)]=savedFill,savedFill},createTableFill,mergeFill=function(fill,savedFill,_styles,deleteExisting){var savedFillDetails;for(var key in _styles._fills)if(_styles._fills[key]===savedFill){savedFillDetails=JSON.parse(key);break}for(var key in deleteExisting&&delete _styles._fills[utils.stringify(savedFillDetails)],fill)fill[key]&&(savedFillDetails[key]=fill[key]),fill[key]=savedFillDetails[key];return fill},getFillForCells,getFillForCell=function(_styles,options,cellStyle){var newStyleCreated=!1,fill=createFill(options),fillIndex,savedFill=_styles._fills?searchFill(fill,_styles):null,fillCount;(null!=savedFill?fillIndex=savedFill:newStyleCreated=!0,cellStyle&&cellStyle._fill&&fill)&&(getFillCounts(cellStyle._fill,_styles)<=1&&(fillIndex=updateFill(fill,cellStyle._fill,_styles)));return null==fillIndex&&(cellStyle&&cellStyle._fill&&(fill=mergeFill(fill,cellStyle._fill,_styles,!1)),fillIndex=addFill(fill,_styles)),!fillIndex&&cellStyle&&cellStyle._fill&&(fillIndex=cellStyle._fill),{fill:fill,fillIndex:fillIndex,newStyleCreated:newStyleCreated}},getFillCounts=function(fill,_styles){var count=0,index;for(index=0;index<_styles.styles.length;index++)if(_styles.styles[index]._fill===fill&&(count+=Object.keys(_styles.styles[index].cellIndices).length)>1)return count;return count};return{createTableFill:function(options,savedFill){var fill;return createFill(options)||savedFill||!1},generateContent:generateContent,getFillForCell:getFillForCell,getFillForCells:function(_styles,options){var newStyleCreated=!1,fill=createFill(options),fillIndex,savedFill=_styles._fills?searchFill(fill,_styles):null;return null!=savedFill?fillIndex=savedFill:newStyleCreated=!0,fillIndex||!1!==(savedFill=searchSavedFillsForUpdate(_styles,options.cellIndices))&&(fillIndex=updateFill(fill,savedFill,_styles)),null==fillIndex&&(fillIndex=addFill(fill,_styles)),{fill:fill,fillIndex:fillIndex,newStyleCreated:newStyleCreated}},generateSingleContent:getFillString}})),define("oxml_xlsx_styles",["utils","oxml_xlsx_font","oxml_xlsx_num_format","oxml_xlsx_border","oxml_xlsx_fill","xmlContentString","contentFile"],(function(utils,oxmlXlsxFont,oxmlXlsxNumFormat,oxmlXlsxBorder,oxmlXlsxFill,XMLContentString,ContentFile){"use strict";var Styles=function(_workbook,_rel,_contentType){var sheetId=createStyleParts(_workbook,_rel,_contentType),_styles={sheetId:sheetId,fileName:"style"+sheetId+".xml",styles:[],_fonts:{},_borders:{},_fills:{},_fontsCount:1,_bordersCount:1,_fillsCount:2},font={bold:!1,italic:!1,underline:!1,size:!1,color:!1,strike:!1,family:!1,name:!1,scheme:!1};_styles._fonts[utils.stringify(font)]=0,_styles._borders[!1]=0,_styles._fills[!1]=0;var fillGray125={pattern:"gray125",fgColor:!1,bgColor:!1};_styles._fills[utils.stringify(fillGray125)]=1,this.className="Style",this.fileName=_styles.fileName,this.folderName="workbook",this._styles=_styles};(Styles.prototype=Object.create(ContentFile.prototype)).generateContent=function(){var template=new XMLContentString({rootNode:"styleSheet",nameSpaces:["http://schemas.openxmlformats.org/spreadsheetml/2006/main"]}),stylesString="",index=0;for(stylesString+=oxmlXlsxNumFormat.generateContent(this._styles),stylesString+=oxmlXlsxFont.generateContent(this._styles),stylesString+=oxmlXlsxFill.generateContent(this._styles),stylesString+=oxmlXlsxBorder.generateContent(this._styles),stylesString+='<cellStyleXfs count="1"><xf /></cellStyleXfs>',stylesString+='<cellXfs count="'+(parseInt(this._styles.styles.length,10)+1)+'"><xf />',index=0;index<this._styles.styles.length;index++){var numFormatString=this._styles.styles[index]._numFormat?' numFmtId="'+this._styles.styles[index]._numFormat+'" ':"",borderString=this._styles.styles[index]._border?' borderId="'+this._styles.styles[index]._border+'" ':"",fillString=this._styles.styles[index]._fill?' fillId="'+this._styles.styles[index]._fill+'" ':"",alignmentString=this._styles.styles[index]._hAlignment||this._styles.styles[index]._vAlignment?"><alignment"+(this._styles.styles[index]._vAlignment?' vertical="'+this._styles.styles[index]._vAlignment+'"':"")+(this._styles.styles[index]._hAlignment?' horizontal="'+this._styles.styles[index]._hAlignment+'"':"")+"/>":"";stylesString+='<xf fontId="'+this._styles.styles[index]._font+'" '+numFormatString+borderString+fillString+(alignmentString?alignmentString+"</xf>":" />")}var tableStyles="";return this._styles.tableStyles&&this._styles.tableStyles.length&&(tableStyles=generateTableContent(this._styles)),stylesString+="</cellXfs>"+tableStyles,template.format(stylesString)};var generateTableContent=function(_styles){for(var dxfsCount=0,tableStyles="",tableStylesCount=0,tableStyleCount,dxfString="",index=0;index<_styles.tableStyles.length;index++){var individualTalbeStyle;dxfsCount++,tableStylesCount++,tableStyleCount=1,dxfString+=generateDxfContent(_styles.tableStyles[index]),individualTalbeStyle='<tableStyleElement dxfId="'+(dxfsCount-1)+'" type="wholeTable"/>',_styles.tableStyles[index].evenColumn&&(tableStyleCount++,individualTalbeStyle+='<tableStyleElement dxfId="'+(++dxfsCount-1)+'" type="secondColumnStripe"/>',dxfString+=generateDxfContent(_styles.tableStyles[index].evenColumn)),_styles.tableStyles[index].oddColumn&&(tableStyleCount++,individualTalbeStyle+='<tableStyleElement dxfId="'+(++dxfsCount-1)+'" type="firstColumnStripe"/>',dxfString+=generateDxfContent(_styles.tableStyles[index].oddColumn)),_styles.tableStyles[index].evenRow&&(tableStyleCount++,individualTalbeStyle+='<tableStyleElement dxfId="'+(++dxfsCount-1)+'" type="secondRowStripe"/>',dxfString+=generateDxfContent(_styles.tableStyles[index].evenRow)),_styles.tableStyles[index].oddRow&&(tableStyleCount++,individualTalbeStyle+='<tableStyleElement dxfId="'+(++dxfsCount-1)+'" type="firstRowStripe"/>',dxfString+=generateDxfContent(_styles.tableStyles[index].oddRow)),_styles.tableStyles[index].firstColumn&&(tableStyleCount++,individualTalbeStyle+='<tableStyleElement dxfId="'+(++dxfsCount-1)+'" type="firstColumn"/>',dxfString+=generateDxfContent(_styles.tableStyles[index].firstColumn)),_styles.tableStyles[index].lastColumn&&(tableStyleCount++,individualTalbeStyle+='<tableStyleElement dxfId="'+(++dxfsCount-1)+'" type="lastColumn"/>',dxfString+=generateDxfContent(_styles.tableStyles[index].lastColumn)),_styles.tableStyles[index].firstRow&&(tableStyleCount++,individualTalbeStyle+='<tableStyleElement dxfId="'+(++dxfsCount-1)+'" type="headerRow"/>',dxfString+=generateDxfContent(_styles.tableStyles[index].firstRow)),_styles.tableStyles[index].lastRow&&(tableStyleCount++,individualTalbeStyle+='<tableStyleElement dxfId="'+(++dxfsCount-1)+'" type="totalRow"/>',dxfString+=generateDxfContent(_styles.tableStyles[index].lastRow)),_styles.tableStyles[index].firstRowFirstCell&&(tableStyleCount++,individualTalbeStyle+='<tableStyleElement dxfId="'+(++dxfsCount-1)+'" type="firstHeaderCell"/>',dxfString+=generateDxfContent(_styles.tableStyles[index].firstRowFirstCell)),_styles.tableStyles[index].firstRowLastCell&&(tableStyleCount++,individualTalbeStyle+='<tableStyleElement dxfId="'+(++dxfsCount-1)+'" type="lastHeaderCell"/>',dxfString+=generateDxfContent(_styles.tableStyles[index].firstRowLastCell)),_styles.tableStyles[index].lastRowFirstCell&&(tableStyleCount++,individualTalbeStyle+='<tableStyleElement dxfId="'+(++dxfsCount-1)+'" type="firstTotalCell"/>',dxfString+=generateDxfContent(_styles.tableStyles[index].lastRowFirstCell)),_styles.tableStyles[index].lastRowLastCell&&(tableStyleCount++,individualTalbeStyle+='<tableStyleElement dxfId="'+(++dxfsCount-1)+'" type="lastTotalCell"/>',dxfString+=generateDxfContent(_styles.tableStyles[index].lastRowLastCell)),tableStyles+='<tableStyle count="'+tableStyleCount+'" name="'+_styles.tableStyles[index].name+'">'+individualTalbeStyle+"</tableStyle>"}return dxfString='<dxfs count="'+dxfsCount+'">'+dxfString+"</dxfs>"+(tableStyles='<tableStyles count="'+tableStylesCount+'">'+tableStyles+"</tableStyles>")},generateDxfContent=function(style){var dxfString="<dxf>";return style.font&&(dxfString+=oxmlXlsxFont.generateSingleContent(style.font)),style.fill&&(dxfString+=oxmlXlsxFill.generateSingleContent(style.fill)),style.border&&(dxfString+=oxmlXlsxBorder.generateSingleContent(style.border)),dxfString+="</dxf>"},createStyleParts=function(_workBook,_rel,_contentType){var lastSheetRel=_workBook.getLastSheet(),nextSheetRelId=parseInt((lastSheetRel.Id||"rId0").replace("rId",""),10)+1;return _contentType.addContentType("Override","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",{PartName:"/workbook/style"+nextSheetRelId+".xml"}),_rel.addRelation("rId"+nextSheetRelId,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles","style"+nextSheetRelId+".xml"),nextSheetRelId},searchStyleForCell=function(_styles,cellIndex){for(var index=0;index<_styles.styles.length;index++)if(void 0!==_styles.styles[index].cellIndices[cellIndex]&&null!==_styles.styles[index].cellIndices[cellIndex])return _styles.styles[index];return null},searchSimilarStyle=function(_styles,style){for(var index=0;index<_styles.styles.length;index++)if(_styles.styles[index]._font===style._font&&_styles.styles[index]._numFormat===style._numFormat)return _styles.styles[index];return null},defineAllignment=function(options){if(options.hAlignment)switch(options.hAlignment.toLowerCase()){case"left":options.hAlignment="left";break;case"center":options.hAlignment="center";break;case"right":options.hAlignment="right";break;default:options.hAlignment=void 0}if(options.vAlignment)switch(options.vAlignment.toLowerCase()){case"top":options.vAlignment="top";break;case"center":options.vAlignment="center";break;default:options.vAlignment=void 0}return options};Styles.prototype.addStyles=function(options){if((options=defineAllignment(options)).cellIndex||options.cellIndices){var newStyleCreated=!1,cellStyle,saveFont,saveNumFormat,saveBorder,saveFill;if(options.cellIndex){if(cellStyle=searchStyleForCell(this._styles,options.cellIndex),saveFont=oxmlXlsxFont.getFontForCell(this._styles,options,cellStyle),saveNumFormat=oxmlXlsxNumFormat.getNumFormatForCell(this._styles,options,cellStyle),saveBorder=oxmlXlsxBorder.getBorderForCell(this._styles,options,cellStyle),saveFill=oxmlXlsxFill.getFillForCell(this._styles,options,cellStyle),newStyleCreated=newStyleCreated||saveFont.newStyleCreated||saveBorder.newStyleCreated||saveFill.newStyleCreated||options.hAlignment||options.vAlignment,cellStyle){if(cellStyle._font===saveFont.fontIndex&&cellStyle._numFormat===saveNumFormat.numFormatIndex&&cellStyle._border===saveBorder.borderIndex&&cellStyle._fill===saveFill.fillIndex)return cellStyle;var totalCellApplied;if(1===Object.keys(cellStyle.cellIndices).length)return cellStyle._font=saveFont.fontIndex,cellStyle._numFormat=saveNumFormat.numFormatIndex,cellStyle._border=saveBorder.borderIndex,cellStyle._fill=saveFill.fillIndex,cellStyle._hAlignment=options.hAlignment,cellStyle._vAlignment=options.vAlignment,cellStyle;delete cellStyle.cellIndices[options.cellIndex]}return!newStyleCreated&&(cellStyle=searchSimilarStyle(this._styles,{_font:saveFont.fontIndex,_numFormat:saveNumFormat.numFormatIndex,_border:saveBorder.borderIndex,_fill:saveFill.fillIndex,_hAlignment:options.hAlignment,_vAlignment:options.vAlignment}))?(cellStyle.cellIndices[options.cellIndex]=Object.keys(cellStyle.cellIndices).length,cellStyle):((cellStyle={_font:saveFont.fontIndex,_numFormat:saveNumFormat.numFormatIndex||!1,_border:saveBorder.borderIndex,_fill:saveFill.fillIndex,_hAlignment:options.hAlignment,_vAlignment:options.vAlignment,cellIndices:{}}).cellIndices[options.cellIndex]=0,cellStyle.index=""+(parseInt(this._styles.styles.length,10)+1),this._styles.styles.push(cellStyle),cellStyle)}if(options.cellIndices){var index;if(saveFont=oxmlXlsxFont.getFontForCells(this._styles,options),saveNumFormat=oxmlXlsxNumFormat.getNumFormatForCells(this._styles,options),saveBorder=oxmlXlsxBorder.getBorderForCells(this._styles,options),saveFill=oxmlXlsxFill.getFillForCells(this._styles,options),!(newStyleCreated=newStyleCreated||saveFont.newStyleCreated||saveNumFormat.newStyleCreated||saveBorder.newStyleCreated||saveFill.newStyleCreated||options.hAlignment||options.vAlignment)&&(cellStyle=searchSimilarStyle(this._styles,{_font:saveFont.fontIndex,_numFormat:saveNumFormat.numFormatIndex,_border:saveBorder.borderIndex,_fill:saveFill.fillIndex,_hAlignment:options.hAlignment,_vAlignment:options.vAlignment}))){for(index=0;index<options.cellIndices.length;index++){var cellIndex=options.cellIndices[index],savedCellStyle;(savedCellStyle=searchStyleForCell(this._styles,cellIndex))&&delete savedCellStyle.cellIndices[cellIndex],cellStyle.cellIndices[cellIndex]=Object.keys(cellStyle.cellIndices).length}return cellStyle}for(cellStyle={_font:saveFont.fontIndex,_numFormat:saveNumFormat.numFormatIndex,_border:saveBorder.borderIndex,_fill:saveFill.fillIndex,_hAlignment:options.hAlignment,_vAlignment:options.vAlignment,cellIndices:{}},index=0;index<options.cellIndices.length;index++){var cellIndex=options.cellIndices[index],savedCellStyle;if((savedCellStyle=searchStyleForCell(this._styles,cellIndex))&&delete savedCellStyle.cellIndices[cellIndex],cellStyle.cellIndices[cellIndex]=Object.keys(cellStyle.cellIndices).length,savedCellStyle&&!Object.keys(savedCellStyle.cellIndices).length){for(var key in cellStyle)savedCellStyle[key]=cellStyle[key];return savedCellStyle}}return cellStyle.index=""+(parseInt(this._styles.styles.length,10)+1),this._styles.styles.push(cellStyle),cellStyle}}},Styles.prototype.addTableStyle=function(options,tableStyleName,_table){var existingTableStyle;if(this._styles.tableStyles||(this._styles.tableStyles=[]),_table&&_table.tableStyle)for(var index=0;index<this._styles.tableStyles.length;index++)if(_table.tableStyle.name===this._styles.tableStyles[index].name){existingTableStyle=this._styles.tableStyles[index];break}var tableStyle=prepareTableStyleObj(options,existingTableStyle);if(tableStyle.name=tableStyleName,options.evenColumn?tableStyle.evenColumn=prepareTableStyleObj(options.evenColumn,existingTableStyle&&existingTableStyle.evenColumn):existingTableStyle&&existingTableStyle.evenColumn&&(tableStyle.evenColumn=existingTableStyle.evenColumn),options.oddColumn?tableStyle.oddColumn=prepareTableStyleObj(options.oddColumn,existingTableStyle&&existingTableStyle.oddColumn):existingTableStyle&&existingTableStyle.oddColumn&&(tableStyle.oddColumn=existingTableStyle.oddColumn),options.evenRow?tableStyle.evenRow=prepareTableStyleObj(options.evenRow,existingTableStyle&&existingTableStyle.evenRow):existingTableStyle&&existingTableStyle.evenRow&&(tableStyle.evenRow=existingTableStyle.evenRow),options.oddRow?tableStyle.oddRow=prepareTableStyleObj(options.oddRow,existingTableStyle&&existingTableStyle.oddRow):existingTableStyle&&existingTableStyle.oddRow&&(tableStyle.oddRow=existingTableStyle.oddRow),options.firstColumn?tableStyle.firstColumn=prepareTableStyleObj(options.firstColumn,existingTableStyle&&existingTableStyle.firstColumn):existingTableStyle&&existingTableStyle.firstColumn&&(tableStyle.firstColumn=existingTableStyle.firstColumn),options.lastColumn?tableStyle.lastColumn=prepareTableStyleObj(options.lastColumn,existingTableStyle&&existingTableStyle.lastColumn):existingTableStyle&&existingTableStyle.lastColumn&&(tableStyle.lastColumn=existingTableStyle.lastColumn),options.firstRow?tableStyle.firstRow=prepareTableStyleObj(options.firstRow,existingTableStyle&&existingTableStyle.firstRow):existingTableStyle&&existingTableStyle.firstRow&&(tableStyle.firstRow=existingTableStyle.firstRow),options.lastRow?tableStyle.lastRow=prepareTableStyleObj(options.lastRow,existingTableStyle&&existingTableStyle.lastRow):existingTableStyle&&existingTableStyle.lastRow&&(tableStyle.lastRow=existingTableStyle.lastRow),options.firstRowFirstCell?tableStyle.firstRowFirstCell=prepareTableStyleObj(options.firstRowFirstCell,existingTableStyle&&existingTableStyle.firstRowFirstCell):existingTableStyle&&existingTableStyle.firstRowFirstCell&&(tableStyle.firstRowFirstCell=existingTableStyle.firstRowFirstCell),options.firstRowLastCell?tableStyle.firstRowLastCell=prepareTableStyleObj(options.firstRowLastCell,existingTableStyle&&existingTableStyle.firstRowLastCell):existingTableStyle&&existingTableStyle.firstRowLastCell&&(tableStyle.firstRowLastCell=existingTableStyle.firstRowLastCell),options.lastRowFirstCell?tableStyle.lastRowFirstCell=prepareTableStyleObj(options.lastRowFirstCell,existingTableStyle&&existingTableStyle.lastRowFirstCell):existingTableStyle&&existingTableStyle.lastRowFirstCell&&(tableStyle.lastRowFirstCell=existingTableStyle.lastRowFirstCell),options.lastRowLastCell?tableStyle.lastRowLastCell=prepareTableStyleObj(options.lastRowLastCell,existingTableStyle&&existingTableStyle.lastRowLastCell):existingTableStyle&&existingTableStyle.lastRowLastCell&&(tableStyle.lastRowLastCell=existingTableStyle.lastRowLastCell),existingTableStyle){for(var index=0;index<this._styles.tableStyles.length;index++)if(_table.tableStyle.name===this._styles.tableStyles[index].name){this._styles.tableStyles[index]=tableStyle;break}}else this._styles.tableStyles.push(tableStyle);return tableStyle};var prepareTableStyleObj=function(options,existingTableStyle){var tableStyle={};return tableStyle.font=oxmlXlsxFont.createTableFont(options,existingTableStyle?existingTableStyle.font:null),tableStyle.fill=oxmlXlsxFill.createTableFill(options,existingTableStyle?existingTableStyle.fill:null),tableStyle.border=oxmlXlsxBorder.createTableBorder(options),tableStyle};return{createStyle:function(_workbook,_rel,_contentType){return new Styles(_workbook,_rel,_contentType)}}})),define("oxml_workbook",["oxml_rels","oxml_sheet","oxml_xlsx_styles","xmlContentString","contentString","contentFile"],(function(OxmlRels,oxmlSheet,oxmlXlsxStyles,XMLContentString,ContentString,ContentFile){"use strict";var Workbook=function(xlsxContentTypes,xlsxRels){this.className="Workbook",this.fileName="workbook.xml",this.folderName="workbook",this._workBook={sheets:[],xlsxContentTypes:xlsxContentTypes,xlsxRels:xlsxRels,_rels:OxmlRels.createRelation("workbook.xml.rels","workbook/_rels")}};Workbook.prototype=Object.create(ContentFile.prototype);var generateSharedStrings=function(_workBook){if(_workBook._sharedStrings&&Object.keys(_workBook._sharedStrings).length){var template=new XMLContentString({rootNode:"sst",nameSpaces:["http://schemas.openxmlformats.org/spreadsheetml/2006/main"]}),sharedStrings="";for(var key in _workBook._sharedStrings)sharedStrings+="<si><t>"+key.replace(/&/g,"&amp;")+"</t></si>";return template.format(sharedStrings)}return""};return Workbook.prototype.generateContent=function(file){var template=new XMLContentString({rootNode:"workbook",nameSpaces:["http://schemas.openxmlformats.org/spreadsheetml/2006/main",{value:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",attribute:"r"}]}),index,workSheets="<sheets>";for(index=0;index<this._workBook.sheets.length;index++){var worksheetTemplate;workSheets+=new ContentString('<sheet name="{0}" sheetId="{1}" r:id="{2}"/>').format(this._workBook.sheets[index]._sheet.sheetName,this._workBook.sheets[index]._sheet.sheetId,this._workBook.sheets[index]._sheet.rId),file&&this._workBook.sheets[index].attach(file)}return workSheets+="</sheets>",template.format(workSheets)},Workbook.prototype.getLastSheet=function(){return this._workBook._rels.relations.length?this._workBook._rels.relations[this._workBook._rels.relations.length-1]:{}},Workbook.prototype.addSheet=function(sheetName){var lastSheetRel=this.getLastSheet(),nextSheetRelId=parseInt((lastSheetRel.Id||"rId0").replace("rId",""),10)+1;sheetName=sheetName||"sheet"+nextSheetRelId,this._workBook._rels.addRelation("rId"+nextSheetRelId,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","sheets/sheet"+nextSheetRelId+".xml");var sheet=oxmlSheet.createSheet(sheetName,nextSheetRelId,"rId"+nextSheetRelId,this,this._workBook.xlsxContentTypes);return this._workBook.sheets.push(sheet),this._workBook.xlsxContentTypes.addContentType("Override","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",{PartName:"/workbook/sheets/sheet"+nextSheetRelId+".xml"}),sheet},Workbook.prototype.attachChild=function(file){this._workBook._rels.attach(file);var sharedStrings=generateSharedStrings(this._workBook);sharedStrings&&file.addFile(sharedStrings,"sharedstrings.xml","workbook"),this._workBook._styles&&this._workBook._styles.attach(file)},Workbook.prototype.createSharedString=function(str){if(str){if(!this._workBook._sharedStrings){this._workBook._sharedStrings={},this._workBook.xlsxContentTypes.addContentType("Override","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",{PartName:"/workbook/sharedstrings.xml"});var lastSheetRel=this.getLastSheet(),nextSheetRelId=parseInt((lastSheetRel.Id||"rId0").replace("rId",""),10)+1;this._workBook._rels.addRelation("rId"+nextSheetRelId,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings","sharedstrings.xml")}return isNaN(this._workBook._sharedStrings[str])&&(this._workBook._sharedStrings[str]=Object.keys(this._workBook._sharedStrings).length||0),this._workBook._sharedStrings[str]}},Workbook.prototype.getSharedString=function(str){return this._workBook._sharedStrings[str]},Workbook.prototype.createStyles=function(){return this._workBook._styles||(this._workBook._styles=oxmlXlsxStyles.createStyle(this,this._workBook._rels,this._workBook.xlsxContentTypes)),this._workBook._styles},{createWorkbook:function(xlsxContentTypes,xlsxRels){return new Workbook(xlsxContentTypes,xlsxRels)}}})),define("oxml_xlsx",["fileHandler","oxml_content_types","oxml_rels","oxml_workbook"],(function(FileHandler,OxmlContentTypes,OxmlRels,oxmlWorkBook){"use strict";var oxml={},downloadFile=function(fileName,callback,_xlsx){try{var jsZip,fs;if("undefined"==typeof window)jsZip=_jsZip(),fs=_fs;else if("undefined"==typeof JSZip){if(callback)callback("Err: JSZip reference not found.");else if("undefined"!=typeof Promise)return new Promise((function(resolve,reject){reject("Err: JSZip reference not found.")}))}else jsZip=new JSZip;var file=(new FileHandler).createFile(jsZip,fs);return _xlsx.contentTypes.attach(file),_xlsx._rels.attach(file),_xlsx.workBook.attach(file),file.saveFile(fileName,callback)}catch(err){if(callback)callback("Err: Not able to create Workbook.");else if("undefined"!=typeof Promise)return new Promise((function(resolve,reject){reject("Err: Not able to create Workbook.")}))}},createXLSX=function(){var _xlsx={};_xlsx.contentTypes=OxmlContentTypes.createContentType(),_xlsx.contentTypes.addContentType("Default","application/vnd.openxmlformats-package.relationships+xml",{Extension:"rels"}),_xlsx.contentTypes.addContentType("Default","application/xml",{Extension:"xml"}),_xlsx.contentTypes.addContentType("Override","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",{PartName:"/workbook/workbook.xml"}),_xlsx._rels=OxmlRels.createRelation(".rels","_rels"),_xlsx._rels.addRelation("rId1","http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument","workbook/workbook.xml"),_xlsx.workBook=oxmlWorkBook.createWorkbook(_xlsx.contentTypes,_xlsx._rels);var download=function(fileName,callback){return downloadFile(fileName,callback,_xlsx)};return{_xlsx:_xlsx,sheet:_xlsx.workBook.addSheet.bind(_xlsx.workBook),download:download}};return oxml.xlsx=createXLSX,"undefined"==typeof window||window.oxml||(window.oxml=oxml),oxml})),require("oxml_xlsx")}));